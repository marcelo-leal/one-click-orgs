<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Master</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.5.3/jquery-1.6.2.min.js' type='text/javascript'></script>
    <script src='./assets/0.5.3/jquery.dataTables.min.js' type='text/javascript'></script>   
    <script src='./assets/0.5.3/fancybox/jquery.fancybox-1.3.1.pack.js' type='text/javascript'></script>   
    <script src='./assets/0.5.3/jquery.timeago.js' type='text/javascript'></script>   
    <script src='./assets/0.5.3/jquery.url.js' type='text/javascript'></script>   
    <script src='./assets/0.5.3/highlight.pack.js' type='text/javascript'></script>  
    <script src='./assets/0.5.3/app.js' type='text/javascript'></script>    
    <link href='./assets/0.5.3/stylesheet.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link href='./assets/0.5.3/highlight.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link href='./assets/0.5.3/fancybox/jquery.fancybox-1.3.1.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link href='./assets/0.5.3/smoothness/jquery-ui-1.8.4.custom.css' media='screen, projection, print' rel='stylesheet' type='text/css'>    
    <link rel="shortcut icon" type="image/png" href="./assets/0.5.3/favicon_green.png" />
    <link rel="icon" type="image/png" href="./assets/0.5.3/favicon.png" />
  </head>
  
  <body>
    <div id="loading">
      <img src="./assets/0.5.3/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div class="timestamp">Generated <abbr class="timeago" title="2012-08-17T23:40:21+01:00">2012-08-17T23:40:21+01:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent"><span class="green">91.99%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         71.08
       </span>
    </span> hits/line)
  </h2>
  <a name="AllFiles"></a>
  <div>
    <b>186</b> files in total.
    <b>3509</b> relevant lines. 
    <span class="green"><b>3228</b> lines covered</span> and
    <span class="red"><b>281</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#8c12d37e0c4b53861f81dd5e193930d281ab69e5" class="src_link" title="app/controllers/add_member_proposals_controller.rb">app/controllers/add_member_proposals_controller.rb</a></td>
        <td class="yellow strong">84.62 %</td>
        <td>21</td>
        <td>13</td>
        <td>11</td>
        <td>2</td>
        <td>5.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#161eac20a7e04ce55abcef4780b762bf68c6a30a" class="src_link" title="app/controllers/admin/coops_controller.rb">app/controllers/admin/coops_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>23</td>
        <td>16</td>
        <td>16</td>
        <td>0</td>
        <td>1.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#66a2d8c4e958c73c135a421b0d38f9b44ef0fff5" class="src_link" title="app/controllers/admin_controller.rb">app/controllers/admin_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#bd17821c6be1449241f3d82669efb037061e7da7" class="src_link" title="app/controllers/administrator_sessions_controller.rb">app/controllers/administrator_sessions_controller.rb</a></td>
        <td class="yellow strong">88.24 %</td>
        <td>28</td>
        <td>17</td>
        <td>15</td>
        <td>2</td>
        <td>1.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6761ab384d4537a30f29b2f2bcdc56be44067ffa" class="src_link" title="app/controllers/application_controller.rb">app/controllers/application_controller.rb</a></td>
        <td class="green strong">90.48 %</td>
        <td>329</td>
        <td>147</td>
        <td>133</td>
        <td>14</td>
        <td>459.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a998656920b58a122cf37ae3e7f1f9db1057ec79" class="src_link" title="app/controllers/associations_controller.rb">app/controllers/associations_controller.rb</a></td>
        <td class="red strong">79.07 %</td>
        <td>82</td>
        <td>43</td>
        <td>34</td>
        <td>9</td>
        <td>2.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ad1694d41c8b9275548620d72eac5870b8330f8e" class="src_link" title="app/controllers/ballots_controller.rb">app/controllers/ballots_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>22</td>
        <td>15</td>
        <td>15</td>
        <td>0</td>
        <td>5.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#81caa65cf344657a93d93d00554440be636f8e7b" class="src_link" title="app/controllers/board_meetings_controller.rb">app/controllers/board_meetings_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>12</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>3.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#41ba8e9a78c7369589e32145cdc4251b65dc16bf" class="src_link" title="app/controllers/board_resolutions_controller.rb">app/controllers/board_resolutions_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>12</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>4.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2be4db27933558cd021b343d45611807111f8d98" class="src_link" title="app/controllers/change_meeting_notice_period_resolutions_controller.rb">app/controllers/change_meeting_notice_period_resolutions_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>26</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>8.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3f09196d66564b2d72da592b57371318795e0eee" class="src_link" title="app/controllers/change_member_class_proposals_controller.rb">app/controllers/change_member_class_proposals_controller.rb</a></td>
        <td class="red strong">80.0 %</td>
        <td>18</td>
        <td>10</td>
        <td>8</td>
        <td>2</td>
        <td>4.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#42382a88155c76c5e17e7bc5f99879384b4abd23" class="src_link" title="app/controllers/change_quorum_resolutions_controller.rb">app/controllers/change_quorum_resolutions_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>14</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>5.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ba4373a8d13d83e820fbe2e0cdea160d5da38561" class="src_link" title="app/controllers/comments_controller.rb">app/controllers/comments_controller.rb</a></td>
        <td class="red strong">65.0 %</td>
        <td>39</td>
        <td>20</td>
        <td>13</td>
        <td>7</td>
        <td>6.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#dbc30f5399f93d791d5fdfca4c41845a7c96d71a" class="src_link" title="app/controllers/companies_controller.rb">app/controllers/companies_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>26</td>
        <td>18</td>
        <td>18</td>
        <td>0</td>
        <td>7.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a039cd110a59e3f87eb89f710a9a24178923a81e" class="src_link" title="app/controllers/constitution_proposal_bundles_controller.rb">app/controllers/constitution_proposal_bundles_controller.rb</a></td>
        <td class="yellow strong">85.71 %</td>
        <td>27</td>
        <td>14</td>
        <td>12</td>
        <td>2</td>
        <td>8.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3c8678e3e7b66407c584ddc767820f202a96b462" class="src_link" title="app/controllers/constitutions_controller.rb">app/controllers/constitutions_controller.rb</a></td>
        <td class="yellow strong">86.21 %</td>
        <td>50</td>
        <td>29</td>
        <td>25</td>
        <td>4</td>
        <td>10.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#edbfd2a53d9a8f8d35e9cac02717f72d937963b0" class="src_link" title="app/controllers/coops_controller.rb">app/controllers/coops_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>43</td>
        <td>24</td>
        <td>24</td>
        <td>0</td>
        <td>4.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7d8eaed1c6901b06167ac0d6ed1c9593bdb15d6f" class="src_link" title="app/controllers/decisions_controller.rb">app/controllers/decisions_controller.rb</a></td>
        <td class="red strong">50.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>2</td>
        <td>2</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#60485d7da56f330f223c198f7b1298e874e46c4c" class="src_link" title="app/controllers/directors_controller.rb">app/controllers/directors_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>32</td>
        <td>21</td>
        <td>21</td>
        <td>0</td>
        <td>7.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d98d496ad5b1a992d6db711bbfe50169896038e4" class="src_link" title="app/controllers/directorships_controller.rb">app/controllers/directorships_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>22</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>3.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#89e31e2d6766572ee924a6d4f213cd2f88e89f73" class="src_link" title="app/controllers/eject_member_proposals_controller.rb">app/controllers/eject_member_proposals_controller.rb</a></td>
        <td class="red strong">80.0 %</td>
        <td>15</td>
        <td>10</td>
        <td>8</td>
        <td>2</td>
        <td>2.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#63bede61845d88e2665194aa7bc2bbf25a781d44" class="src_link" title="app/controllers/found_association_proposals_controller.rb">app/controllers/found_association_proposals_controller.rb</a></td>
        <td class="yellow strong">84.62 %</td>
        <td>22</td>
        <td>13</td>
        <td>11</td>
        <td>2</td>
        <td>1.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7c29c3a5f875bd1ce400ce54deccf36ccc5db8dd" class="src_link" title="app/controllers/founder_members_controller.rb">app/controllers/founder_members_controller.rb</a></td>
        <td class="red strong">69.23 %</td>
        <td>21</td>
        <td>13</td>
        <td>9</td>
        <td>4</td>
        <td>0.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6b15b5ddaba231c65c03976411f5047f3b71d8b1" class="src_link" title="app/controllers/founding_members_controller.rb">app/controllers/founding_members_controller.rb</a></td>
        <td class="yellow strong">85.71 %</td>
        <td>22</td>
        <td>14</td>
        <td>12</td>
        <td>2</td>
        <td>4.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#139fe03719996788b974ad3b75b4ee11ef46d91a" class="src_link" title="app/controllers/general_meetings_controller.rb">app/controllers/general_meetings_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>33</td>
        <td>20</td>
        <td>20</td>
        <td>0</td>
        <td>5.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8aab7633a7a3ee139347e3e938f6d1f397049e9b" class="src_link" title="app/controllers/invitations_controller.rb">app/controllers/invitations_controller.rb</a></td>
        <td class="yellow strong">88.24 %</td>
        <td>31</td>
        <td>17</td>
        <td>15</td>
        <td>2</td>
        <td>5.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1610b6543cd3bfeca2ce73874c81eb1a6f115a35" class="src_link" title="app/controllers/meetings_controller.rb">app/controllers/meetings_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>42</td>
        <td>23</td>
        <td>23</td>
        <td>0</td>
        <td>7.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#235d2625f220fab83f8fa26925a5db014381d49d" class="src_link" title="app/controllers/member_sessions_controller.rb">app/controllers/member_sessions_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>37</td>
        <td>23</td>
        <td>23</td>
        <td>0</td>
        <td>52.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#105821dc5ab76da01e9773ca7427d8cf375fe790" class="src_link" title="app/controllers/members_controller.rb">app/controllers/members_controller.rb</a></td>
        <td class="green strong">94.19 %</td>
        <td>164</td>
        <td>86</td>
        <td>81</td>
        <td>5</td>
        <td>6.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#bcee037100a2e96b26daba890ff946e8c9c0f541" class="src_link" title="app/controllers/membership_application_forms_controller.rb">app/controllers/membership_application_forms_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>15</td>
        <td>9</td>
        <td>9</td>
        <td>0</td>
        <td>3.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#141e757ffc396dc3b89da7f95ce1724a5bce366d" class="src_link" title="app/controllers/officerships_controller.rb">app/controllers/officerships_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>22</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>4.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4b839c55c024c50744210aed600606a8459e1339" class="src_link" title="app/controllers/one_click_controller.rb">app/controllers/one_click_controller.rb</a></td>
        <td class="green strong">92.31 %</td>
        <td>56</td>
        <td>26</td>
        <td>24</td>
        <td>2</td>
        <td>46.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#135385e3c312f06a1713a69276c14a2dafe6ee9a" class="src_link" title="app/controllers/organisations_controller.rb">app/controllers/organisations_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b4b6e199bd87480f0ec74e4677cbf05b6fbacfd7" class="src_link" title="app/controllers/password_resets_controller.rb">app/controllers/password_resets_controller.rb</a></td>
        <td class="red strong">46.15 %</td>
        <td>39</td>
        <td>26</td>
        <td>12</td>
        <td>14</td>
        <td>1.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fb158ab3822a81a9229b9074c1deb9606f80d86f" class="src_link" title="app/controllers/proposals_controller.rb">app/controllers/proposals_controller.rb</a></td>
        <td class="green strong">96.43 %</td>
        <td>52</td>
        <td>28</td>
        <td>27</td>
        <td>1</td>
        <td>7.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1bf6762d52323a4aa31c5dce27dc45130070ccf3" class="src_link" title="app/controllers/registration_forms_controller.rb">app/controllers/registration_forms_controller.rb</a></td>
        <td class="red strong">80.0 %</td>
        <td>27</td>
        <td>15</td>
        <td>12</td>
        <td>3</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1673f88fcabf4b4e8e7875eed46773b25d8a0763" class="src_link" title="app/controllers/resolution_proposals_controller.rb">app/controllers/resolution_proposals_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>45</td>
        <td>31</td>
        <td>31</td>
        <td>0</td>
        <td>3.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#45c960cdf8d5b375dd3a6d455c7ef12911c89d19" class="src_link" title="app/controllers/resolutions_controller.rb">app/controllers/resolutions_controller.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>23</td>
        <td>15</td>
        <td>10</td>
        <td>5</td>
        <td>2.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#865ef817e4e5582fb04f5d5a188d7c42c85e974a" class="src_link" title="app/controllers/setup_controller.rb">app/controllers/setup_controller.rb</a></td>
        <td class="green strong">93.55 %</td>
        <td>46</td>
        <td>31</td>
        <td>29</td>
        <td>2</td>
        <td>3.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#edfcc88f55d07e3b56ae77db46a8c4e68c0716b5" class="src_link" title="app/controllers/share_applications_controller.rb">app/controllers/share_applications_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>12</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>3.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#02031c10ca37a424f75e324aa9641085cabe1950" class="src_link" title="app/controllers/share_transactions_controller.rb">app/controllers/share_transactions_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0fa2db0357d00c20086ac9068b4e1bba65e53e86" class="src_link" title="app/controllers/shares_controller.rb">app/controllers/shares_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>50</td>
        <td>27</td>
        <td>27</td>
        <td>0</td>
        <td>2.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1118f9f872ad98e5035533533de1f0d4d0fa5c5a" class="src_link" title="app/controllers/system_controller.rb">app/controllers/system_controller.rb</a></td>
        <td class="red strong">54.55 %</td>
        <td>18</td>
        <td>11</td>
        <td>6</td>
        <td>5</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#670f9cf4a5941ba456024a4bd1c89b59b4b06820" class="src_link" title="app/controllers/votes_controller.rb">app/controllers/votes_controller.rb</a></td>
        <td class="yellow strong">85.29 %</td>
        <td>71</td>
        <td>34</td>
        <td>29</td>
        <td>5</td>
        <td>2.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e889bd3535717270aad39b8c5ba1d7533d2b8baa" class="src_link" title="app/controllers/welcome_controller.rb">app/controllers/welcome_controller.rb</a></td>
        <td class="yellow strong">86.67 %</td>
        <td>26</td>
        <td>15</td>
        <td>13</td>
        <td>2</td>
        <td>1.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a92243d070d9eba1e4e9f4c80526838e1f61e745" class="src_link" title="app/helpers/add_member_proposals_helper.rb">app/helpers/add_member_proposals_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5a7084ad4fa1ac626cfff2a20b37464d722e4d81" class="src_link" title="app/helpers/administrator_sessions_helper.rb">app/helpers/administrator_sessions_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0893819bb574f10c3ceb4984b129db7d87e34b10" class="src_link" title="app/helpers/application_helper.rb">app/helpers/application_helper.rb</a></td>
        <td class="yellow strong">80.49 %</td>
        <td>97</td>
        <td>41</td>
        <td>33</td>
        <td>8</td>
        <td>162.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#04c40c4c9998051eeedc09c74aaf2bb29ef3f8ed" class="src_link" title="app/helpers/associations_helper.rb">app/helpers/associations_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#34474df636d8eff1cb0a8702a465a73bff9f9c6a" class="src_link" title="app/helpers/ballots_helper.rb">app/helpers/ballots_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#08e92dfce9301432e302cd5b1ac6476c3d58d23f" class="src_link" title="app/helpers/board_meetings_helper.rb">app/helpers/board_meetings_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b4ae4f6b7c3ca50d53df02acc4136e9a1b63fcd4" class="src_link" title="app/helpers/board_resolutions_helper.rb">app/helpers/board_resolutions_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0ea901e894af3e18c74344651426bff10768915f" class="src_link" title="app/helpers/change_meeting_notice_period_resolutions_helper.rb">app/helpers/change_meeting_notice_period_resolutions_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#cc79ac982fd27cf8ec24d7c2b2adbdb4f502b0ef" class="src_link" title="app/helpers/change_member_class_proposals_helper.rb">app/helpers/change_member_class_proposals_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#30a8d2d2cd234cce05cfd00abd7bbbe1862d8abf" class="src_link" title="app/helpers/change_quorum_resolutions_helper.rb">app/helpers/change_quorum_resolutions_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f5b66baf6541b1e196aef12fd6015f5ed1c1fff7" class="src_link" title="app/helpers/comments_helper.rb">app/helpers/comments_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#03564eb8a2a61709ee6c942e17b28667036261c1" class="src_link" title="app/helpers/companies_helper.rb">app/helpers/companies_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2406beae7465e2d0c11af2285ac95d32c7381f70" class="src_link" title="app/helpers/constitutions_helper.rb">app/helpers/constitutions_helper.rb</a></td>
        <td class="yellow strong">85.71 %</td>
        <td>11</td>
        <td>7</td>
        <td>6</td>
        <td>1</td>
        <td>11.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#eb170d588d6e504850f33c4d41420d57648eba0f" class="src_link" title="app/helpers/coops_helper.rb">app/helpers/coops_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#927b8e28263b64792daef14898234be57b601fda" class="src_link" title="app/helpers/decisions_helper.rb">app/helpers/decisions_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#811eaa4e8e3d0cf0b50948533fbbc8d0ff822c04" class="src_link" title="app/helpers/directors_helper.rb">app/helpers/directors_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b6063b12a377ce24ab2b9ffa5fa818537670d494" class="src_link" title="app/helpers/directorships_helper.rb">app/helpers/directorships_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7b998c56a2a8aa7d78c2e023fa309927cb4ec0d8" class="src_link" title="app/helpers/eject_member_proposals_helper.rb">app/helpers/eject_member_proposals_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#00a7071fcf74926378088daa9efae14ab71e5d0c" class="src_link" title="app/helpers/founding_members_helper.rb">app/helpers/founding_members_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3ace8b913cf74cc3d17781beda572427a527814a" class="src_link" title="app/helpers/general_meetings_helper.rb">app/helpers/general_meetings_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#af2904d55372925b20066c0410b2da9932fa272a" class="src_link" title="app/helpers/invitations_helper.rb">app/helpers/invitations_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#348194b6ac591ef745a1d4860de7194224f0ff45" class="src_link" title="app/helpers/meetings_helper.rb">app/helpers/meetings_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7508674060fcc056d79e35529397c4c55d7c4b7a" class="src_link" title="app/helpers/member_sessions_helper.rb">app/helpers/member_sessions_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ba950ae1fee0b5598b37a27537a2ecee03f4a881" class="src_link" title="app/helpers/members_helper.rb">app/helpers/members_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5f4f675354cea1743bbaf419928ca4fb356bd0b9" class="src_link" title="app/helpers/membership_application_forms_helper.rb">app/helpers/membership_application_forms_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e233c22e7e1d379cba121c89d3b0379700d0e30d" class="src_link" title="app/helpers/officerships_helper.rb">app/helpers/officerships_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3f86df7bea5580be88a6cbf5830ab63e7941ac91" class="src_link" title="app/helpers/one_click_helper.rb">app/helpers/one_click_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#67235943beca09855f841b40500d1f3277f56b26" class="src_link" title="app/helpers/organisations_helper.rb">app/helpers/organisations_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d5d7ae33c283f0ffc01a0a1f29aa60bbc25f3026" class="src_link" title="app/helpers/proposals_helper.rb">app/helpers/proposals_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#acad1627445a766c6e98ff147f3c4d6cbcda0409" class="src_link" title="app/helpers/registration_forms_helper.rb">app/helpers/registration_forms_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ca128c81a688e35b2ead5d1c8a33cbf43cb27f30" class="src_link" title="app/helpers/reset_password_helper.rb">app/helpers/reset_password_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#441dc8c50ede3dc180ca435d1740e7be4412d53c" class="src_link" title="app/helpers/resolution_proposals_helper.rb">app/helpers/resolution_proposals_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4d1462f993a2c4327605ace0e1c5435235d909b2" class="src_link" title="app/helpers/resolutions_helper.rb">app/helpers/resolutions_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b33e39e1668aa02937b27135edac7974ccf917f3" class="src_link" title="app/helpers/setup_helper.rb">app/helpers/setup_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#baeede9c372f4e9f3cd141680fb7d13ba11bc60c" class="src_link" title="app/helpers/share_applications_helper.rb">app/helpers/share_applications_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c11dd0e45d895f959c6dc603a05978195491233d" class="src_link" title="app/helpers/share_transactions_helper.rb">app/helpers/share_transactions_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#79dabce9557acec76b9eb5fc152c2e2d09e765cd" class="src_link" title="app/helpers/shares_helper.rb">app/helpers/shares_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ba4452cca0024f143d4d8c10c282bb53c7fc37ec" class="src_link" title="app/helpers/votes_helper.rb">app/helpers/votes_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fdeb0258d486a2f64be2e3ea43f58253220965f2" class="src_link" title="app/mailers/decision_mailer.rb">app/mailers/decision_mailer.rb</a></td>
        <td class="green strong">96.0 %</td>
        <td>40</td>
        <td>25</td>
        <td>24</td>
        <td>1</td>
        <td>30.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5c3b838f0910aec634d9700571ed09a10684284e" class="src_link" title="app/mailers/directorship_mailer.rb">app/mailers/directorship_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>103.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#741bf6222693bc545b45b53bd62c32f16ed156b4" class="src_link" title="app/mailers/meeting_mailer.rb">app/mailers/meeting_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>40</td>
        <td>16</td>
        <td>16</td>
        <td>0</td>
        <td>9.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7ae153d10085ffec5b9ea149c199269a514acc2a" class="src_link" title="app/mailers/members_mailer.rb">app/mailers/members_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>126</td>
        <td>78</td>
        <td>78</td>
        <td>0</td>
        <td>4.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0c52af5951a16cfab0fb00048d65d8d04f38f7fa" class="src_link" title="app/mailers/oco_mailer.rb">app/mailers/oco_mailer.rb</a></td>
        <td class="red strong">58.62 %</td>
        <td>53</td>
        <td>29</td>
        <td>17</td>
        <td>12</td>
        <td>89.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6fe86854ee125a82de9f6bc68865728647321bd6" class="src_link" title="app/mailers/officership_mailer.rb">app/mailers/officership_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>12</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>8.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#54214331c7bfb3dad1b29733291e35e8497910d6" class="src_link" title="app/mailers/proposal_mailer.rb">app/mailers/proposal_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>40</td>
        <td>25</td>
        <td>25</td>
        <td>0</td>
        <td>85.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5eeeaf25157693d384e2535f342e66b2e571fd82" class="src_link" title="app/mailers/share_transaction_mailer.rb">app/mailers/share_transaction_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>17</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>3.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7109991646102c6dff6ed6700205dc4c5d4493fa" class="src_link" title="app/mailers/test_mailer.rb">app/mailers/test_mailer.rb</a></td>
        <td class="red strong">50.0 %</td>
        <td>7</td>
        <td>4</td>
        <td>2</td>
        <td>2</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1ff3afefca659f070fe5e7bd1dbe18ada63bdfa0" class="src_link" title="app/models/ability.rb">app/models/ability.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>97</td>
        <td>51</td>
        <td>51</td>
        <td>0</td>
        <td>132.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#dba0f2ac2c34b50588d14d7f54627d1edebe3451" class="src_link" title="app/models/add_member_proposal.rb">app/models/add_member_proposal.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>69</td>
        <td>39</td>
        <td>39</td>
        <td>0</td>
        <td>10.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9dcc13f30dbdee4533f24692ead618d2b7b9b6b0" class="src_link" title="app/models/administrator.rb">app/models/administrator.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>5</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6d564e64a6e054472a084a19da3f521e5930b59a" class="src_link" title="app/models/annual_general_meeting.rb">app/models/annual_general_meeting.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>25</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>5.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1e1deb38ffd012469cbd2c52e8be32d4ca2c4723" class="src_link" title="app/models/association.rb">app/models/association.rb</a></td>
        <td class="green strong">96.59 %</td>
        <td>174</td>
        <td>88</td>
        <td>85</td>
        <td>3</td>
        <td>88.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2653c7b61f9baad893feb0dd69c7183ff665e943" class="src_link" title="app/models/ballot.rb">app/models/ballot.rb</a></td>
        <td class="green strong">96.3 %</td>
        <td>57</td>
        <td>27</td>
        <td>26</td>
        <td>1</td>
        <td>39.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#bfb4658584deca3bc01ce23fe760705c0b097356" class="src_link" title="app/models/board_meeting.rb">app/models/board_meeting.rb</a></td>
        <td class="yellow strong">87.5 %</td>
        <td>15</td>
        <td>8</td>
        <td>7</td>
        <td>1</td>
        <td>2.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8ba260168da40660dbc0ccbfc32557208a064c2e" class="src_link" title="app/models/board_resolution.rb">app/models/board_resolution.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b9a94b8d2015510824d131b4a2f6f2c0f920945c" class="src_link" title="app/models/change_boolean_proposal.rb">app/models/change_boolean_proposal.rb</a></td>
        <td class="red strong">58.33 %</td>
        <td>25</td>
        <td>12</td>
        <td>7</td>
        <td>5</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#203373be251d19a6bb5c42695582c2b6ef404f1c" class="src_link" title="app/models/change_boolean_resolution.rb">app/models/change_boolean_resolution.rb</a></td>
        <td class="red strong">75.0 %</td>
        <td>23</td>
        <td>12</td>
        <td>9</td>
        <td>3</td>
        <td>9.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3e7c6d5c459a9070168da011e41b952da45e79ce" class="src_link" title="app/models/change_integer_resolution.rb">app/models/change_integer_resolution.rb</a></td>
        <td class="red strong">77.78 %</td>
        <td>34</td>
        <td>18</td>
        <td>14</td>
        <td>4</td>
        <td>15.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#43140d21695ba5605f2c99e87e17bb98f54e744e" class="src_link" title="app/models/change_meeting_notice_period_resolution.rb">app/models/change_meeting_notice_period_resolution.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>12</td>
        <td>12</td>
        <td>0</td>
        <td>4.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7475991df5a4f50562fba163c744abc3ca79a053" class="src_link" title="app/models/change_member_class_proposal.rb">app/models/change_member_class_proposal.rb</a></td>
        <td class="yellow strong">82.14 %</td>
        <td>50</td>
        <td>28</td>
        <td>23</td>
        <td>5</td>
        <td>2.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#817885978429f8334680c7a00911f086c114fda2" class="src_link" title="app/models/change_quorum_resolution.rb">app/models/change_quorum_resolution.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>28</td>
        <td>15</td>
        <td>15</td>
        <td>0</td>
        <td>3.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#85976b46305e321d6cdfa185d1cc76938b101b73" class="src_link" title="app/models/change_text_proposal.rb">app/models/change_text_proposal.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>37</td>
        <td>18</td>
        <td>18</td>
        <td>0</td>
        <td>2.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b59be7f7b996c37290f96d3b17ebbaf1a2752dca" class="src_link" title="app/models/change_text_resolution.rb">app/models/change_text_resolution.rb</a></td>
        <td class="green strong">94.44 %</td>
        <td>34</td>
        <td>18</td>
        <td>17</td>
        <td>1</td>
        <td>15.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#aac5f15215973379cd0ac0d0c1cccb88ab0c409d" class="src_link" title="app/models/change_voting_period_proposal.rb">app/models/change_voting_period_proposal.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>21</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>1.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#87d2e9aac60a7952a3618ae3df75d4762fad1d5a" class="src_link" title="app/models/change_voting_system_proposal.rb">app/models/change_voting_system_proposal.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>29</td>
        <td>15</td>
        <td>15</td>
        <td>0</td>
        <td>2.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#de666b7a4b1a2be96e7d217f573b9437aa28305c" class="src_link" title="app/models/clause.rb">app/models/clause.rb</a></td>
        <td class="green strong">93.18 %</td>
        <td>92</td>
        <td>44</td>
        <td>41</td>
        <td>3</td>
        <td>1385.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3de55437c663abd4625d2c2edee6d4c07faf19de" class="src_link" title="app/models/comment.rb">app/models/comment.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b59d362145d47440f82b0537dc6a669de968bb5c" class="src_link" title="app/models/company.rb">app/models/company.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>42</td>
        <td>25</td>
        <td>25</td>
        <td>0</td>
        <td>15.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4e778582d730ea196e015f33762acc45835d12da" class="src_link" title="app/models/constitution.rb">app/models/constitution.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>64</td>
        <td>26</td>
        <td>26</td>
        <td>0</td>
        <td>277.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e1089605b7c5daa4b647637e358250cec6ed024d" class="src_link" title="app/models/constitution_proposal.rb">app/models/constitution_proposal.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>5.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#aa8a2bd3a5ee350db9650ef5c9905c5acba3bc60" class="src_link" title="app/models/constitution_proposal_bundle.rb">app/models/constitution_proposal_bundle.rb</a></td>
        <td class="red strong">78.84 %</td>
        <td>650</td>
        <td>241</td>
        <td>190</td>
        <td>51</td>
        <td>15.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#07257a60d20d4b8f387e139bae0e6b573479a862" class="src_link" title="app/models/constitution_wrapper.rb">app/models/constitution_wrapper.rb</a></td>
        <td class="yellow strong">86.59 %</td>
        <td>165</td>
        <td>82</td>
        <td>71</td>
        <td>11</td>
        <td>3.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6bf004b0ee1e040ebe5a5e2d2d2dc87b4dd2f346" class="src_link" title="app/models/coop.rb">app/models/coop.rb</a></td>
        <td class="green strong">92.31 %</td>
        <td>433</td>
        <td>247</td>
        <td>228</td>
        <td>19</td>
        <td>47.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#19ca86f6cab3d632f581887ada28c3e80fc9023d" class="src_link" title="app/models/decision.rb">app/models/decision.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>13</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>6.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1657823b01412dd49c6ad6b44143e883d4859ccf" class="src_link" title="app/models/director.rb">app/models/director.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>25</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>2.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#39950dd4b27d40525cf45fa330f2eb23edc0906d" class="src_link" title="app/models/directorship.rb">app/models/directorship.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>39</td>
        <td>23</td>
        <td>23</td>
        <td>0</td>
        <td>75.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#736ec96780367d27cf1c64b29d2c21b9eb2912d9" class="src_link" title="app/models/eject_member_proposal.rb">app/models/eject_member_proposal.rb</a></td>
        <td class="green strong">93.33 %</td>
        <td>31</td>
        <td>15</td>
        <td>14</td>
        <td>1</td>
        <td>2.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5da37002fc08bc6c36d8de3eccdc6cf3c45a6603" class="src_link" title="app/models/election.rb">app/models/election.rb</a></td>
        <td class="green strong">93.33 %</td>
        <td>81</td>
        <td>45</td>
        <td>42</td>
        <td>3</td>
        <td>6.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f6c3081d06f3201cb4e3980267d82377f26fbc04" class="src_link" title="app/models/extraordinary_resolution.rb">app/models/extraordinary_resolution.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ae21770099ec572ab3be1c92b313a841beee80db" class="src_link" title="app/models/found_association_proposal.rb">app/models/found_association_proposal.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>69</td>
        <td>36</td>
        <td>36</td>
        <td>0</td>
        <td>14.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f828802acb4f19baf30cbf9484aa253305240413" class="src_link" title="app/models/founder_member.rb">app/models/founder_member.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#53605500ea3993210b8306a63444f11d2f9d15b4" class="src_link" title="app/models/founding_member.rb">app/models/founding_member.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#de7300a69307856a1f5e4e411f41163dedc726a3" class="src_link" title="app/models/general_meeting.rb">app/models/general_meeting.rb</a></td>
        <td class="green strong">95.83 %</td>
        <td>60</td>
        <td>24</td>
        <td>23</td>
        <td>1</td>
        <td>51.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#22d9891380a79222ec8eeae919fd839b3b309528" class="src_link" title="app/models/invitation.rb">app/models/invitation.rb</a></td>
        <td class="green strong">96.88 %</td>
        <td>79</td>
        <td>32</td>
        <td>31</td>
        <td>1</td>
        <td>10.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f6b58bef81caf67b905dfa8fa8b46acf88cb80bb" class="src_link" title="app/models/meeting.rb">app/models/meeting.rb</a></td>
        <td class="green strong">95.83 %</td>
        <td>49</td>
        <td>24</td>
        <td>23</td>
        <td>1</td>
        <td>8.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#52028891955eb6fdba2586159e6c991d5bda6b84" class="src_link" title="app/models/meeting_participation.rb">app/models/meeting_participation.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f729890a43f038a0bbf7968e73e9b89f46bb81d3" class="src_link" title="app/models/member.rb">app/models/member.rb</a></td>
        <td class="green strong">96.19 %</td>
        <td>201</td>
        <td>105</td>
        <td>101</td>
        <td>4</td>
        <td>161.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3da331b8d972c4fbd560f29ce1aaa87cb0646806" class="src_link" title="app/models/member_class.rb">app/models/member_class.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>31</td>
        <td>17</td>
        <td>17</td>
        <td>0</td>
        <td>1186.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#13c91d565c7291cae00dbcf9f5ebd447ebe7750a" class="src_link" title="app/models/member_state_transition.rb">app/models/member_state_transition.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>4</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#79cdc499ee99f6851d36a599d8978a36729c38c8" class="src_link" title="app/models/membership_proposal.rb">app/models/membership_proposal.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>6.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6fe90238a079347ab9f084b7f93c2fecd82f7118" class="src_link" title="app/models/nomination.rb">app/models/nomination.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>20</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ba8b1d3e36673b534917e40e99f3a27f81285bcf" class="src_link" title="app/models/office.rb">app/models/office.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>17</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>27.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5805faacdc8e224192305f03141beecf0d35bcde" class="src_link" title="app/models/officership.rb">app/models/officership.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>64</td>
        <td>24</td>
        <td>24</td>
        <td>0</td>
        <td>19.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#54a33049d7a70da3fcac115abab06b2c157d9624" class="src_link" title="app/models/organisation.rb">app/models/organisation.rb</a></td>
        <td class="green strong">90.38 %</td>
        <td>106</td>
        <td>52</td>
        <td>47</td>
        <td>5</td>
        <td>223.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ea8364bd407b410945ccbe07b1d9c25e81c4cc4e" class="src_link" title="app/models/proposal.rb">app/models/proposal.rb</a></td>
        <td class="green strong">96.1 %</td>
        <td>177</td>
        <td>77</td>
        <td>74</td>
        <td>3</td>
        <td>20.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#202af0b578da433d84b91405320ea2bfdde6c1d3" class="src_link" title="app/models/resignation.rb">app/models/resignation.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>2.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3e2c7fb289ca290125c5b6e11e2415168898d114" class="src_link" title="app/models/resolution.rb">app/models/resolution.rb</a></td>
        <td class="green strong">97.44 %</td>
        <td>85</td>
        <td>39</td>
        <td>38</td>
        <td>1</td>
        <td>35.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c99af871f7be0856d7250f75b1d322e8431976da" class="src_link" title="app/models/resolution_proposal.rb">app/models/resolution_proposal.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>88</td>
        <td>43</td>
        <td>43</td>
        <td>0</td>
        <td>24.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1542485f9799d0325ae0bef7b9cc49192c31d037" class="src_link" title="app/models/seen_notification.rb">app/models/seen_notification.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>7</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#27d5fa35ff5f92baeca1064f8fcb72ee54a732ba" class="src_link" title="app/models/setting.rb">app/models/setting.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>1614.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2c419031d801af2e81478852b9fd34a04b02330c" class="src_link" title="app/models/share_account.rb">app/models/share_account.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>4.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b166447a42f920bcd5048516eacfff74ed4bca79" class="src_link" title="app/models/share_application.rb">app/models/share_application.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>36</td>
        <td>20</td>
        <td>20</td>
        <td>0</td>
        <td>2.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#71895e87cc5a8bdfdcb05a56dfa1ae7c9ba1fb77" class="src_link" title="app/models/share_transaction.rb">app/models/share_transaction.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>29</td>
        <td>16</td>
        <td>16</td>
        <td>0</td>
        <td>1.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fe7ef68a6095c76a82ed95c9a2033cee4069ac67" class="src_link" title="app/models/share_transaction_state_transition.rb">app/models/share_transaction_state_transition.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>4</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#44975eb994d9e3ae9e16f7060038a418b257720c" class="src_link" title="app/models/task.rb">app/models/task.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>15</td>
        <td>15</td>
        <td>0</td>
        <td>8.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b57a2900cc046f27aa6eec375477bb802cce4d5c" class="src_link" title="app/models/vote.rb">app/models/vote.rb</a></td>
        <td class="yellow strong">90.0 %</td>
        <td>18</td>
        <td>10</td>
        <td>9</td>
        <td>1</td>
        <td>5.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#79688c9a248e85248f34e010b0d1223991d600de" class="src_link" title="app/models/voting_periods.rb">app/models/voting_periods.rb</a></td>
        <td class="red strong">76.19 %</td>
        <td>36</td>
        <td>21</td>
        <td>16</td>
        <td>5</td>
        <td>68.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#605cbc14105a55d352643216f5378db5f7764afc" class="src_link" title="app/models/voting_systems.rb">app/models/voting_systems.rb</a></td>
        <td class="yellow strong">87.96 %</td>
        <td>223</td>
        <td>108</td>
        <td>95</td>
        <td>13</td>
        <td>48.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#328334ea1a791a705cbcd14298e8833dcef444c3" class="src_link" title="app/observers/decision_mailer_observer.rb">app/observers/decision_mailer_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>12</td>
        <td>12</td>
        <td>0</td>
        <td>15.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a8b598d561d5d61d4f28ebe1aa8131d175970301" class="src_link" title="app/observers/directorship_mailer_observer.rb">app/observers/directorship_mailer_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>15</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>55.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a261310663efeb14d0d92533a239f03434bf3934" class="src_link" title="app/observers/election_task_observer.rb">app/observers/election_task_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>20</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>5.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9fbf96e2ae8758ff0b87b38c9b28ba1849b0a55f" class="src_link" title="app/observers/general_meeting_task_observer.rb">app/observers/general_meeting_task_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>36</td>
        <td>17</td>
        <td>17</td>
        <td>0</td>
        <td>7.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2afd8c7903abdee2c11e8cce5c822881bae1811b" class="src_link" title="app/observers/meeting_mailer_observer.rb">app/observers/meeting_mailer_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>18</td>
        <td>9</td>
        <td>9</td>
        <td>0</td>
        <td>18.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4064f75d4f7abe1a6139f7071cc2293e91a40094" class="src_link" title="app/observers/member_mailer_observer.rb">app/observers/member_mailer_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>47</td>
        <td>24</td>
        <td>24</td>
        <td>0</td>
        <td>99.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#11cdc05308926606c1fad4cdb3ac5b3f45a6021d" class="src_link" title="app/observers/member_observer.rb">app/observers/member_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>9.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#90e98617508904462d45f275df26e28170dbaad1" class="src_link" title="app/observers/member_task_observer.rb">app/observers/member_task_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>21</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>95.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5b120c01670226375c468183160bf718af9a35c9" class="src_link" title="app/observers/member_timestamp_observer.rb">app/observers/member_timestamp_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>17</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>155.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#76fb71a7f709c978926d7e9ac0cfc1cfc29daafc" class="src_link" title="app/observers/officership_mailer_observer.rb">app/observers/officership_mailer_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>15</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>18.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#bfab5ae5e26ee67b8e8000378570955c71f46002" class="src_link" title="app/observers/proposal_mailer_observer.rb">app/observers/proposal_mailer_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>49</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>224.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a8e23e28f63d6f53d7067a65a80efad73599f12d" class="src_link" title="app/observers/proposal_timestamp_observer.rb">app/observers/proposal_timestamp_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>55</td>
        <td>21</td>
        <td>21</td>
        <td>0</td>
        <td>109.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1db64a0f1e9e9ab8938e92fc873b811504162be5" class="src_link" title="app/observers/resolution_proposal_task_observer.rb">app/observers/resolution_proposal_task_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>9</td>
        <td>9</td>
        <td>0</td>
        <td>48.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6f70b4c1cff2ce4caa61f8368f6d30d1ea1332ae" class="src_link" title="app/observers/share_transaction_mailer_observer.rb">app/observers/share_transaction_mailer_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>18</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>4.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2c43fa12e970ea2ab29b5624d4c286361d86370b" class="src_link" title="app/observers/share_transaction_task_observer.rb">app/observers/share_transaction_task_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>28</td>
        <td>16</td>
        <td>16</td>
        <td>0</td>
        <td>4.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3d8dde1e98522ddb5add2d33ea9c7ed74031449f" class="src_link" title="app/presenters/member_presenter.rb">app/presenters/member_presenter.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>15</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>3.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b452f5735b32a8274e87e172b9c174d75baae8d3" class="src_link" title="lib/not_found.rb">lib/not_found.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3a7c0d05c445a2e0babccfe6132042fe001f6c29" class="src_link" title="lib/one_click_orgs.rb">lib/one_click_orgs.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>3</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b97905543397a548143b22b8e678914e668cd3ea" class="src_link" title="lib/one_click_orgs/cast_to_boolean.rb">lib/one_click_orgs/cast_to_boolean.rb</a></td>
        <td class="yellow strong">85.71 %</td>
        <td>25</td>
        <td>14</td>
        <td>12</td>
        <td>2</td>
        <td>83.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a77afa1d0de53f7f5e51c1433004d440c14a005f" class="src_link" title="lib/one_click_orgs/google_analytics.rb">lib/one_click_orgs/google_analytics.rb</a></td>
        <td class="yellow strong">83.33 %</td>
        <td>10</td>
        <td>6</td>
        <td>5</td>
        <td>1</td>
        <td>1.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#686c2574405a69b86f1582327d81bc498ae2f5f2" class="src_link" title="lib/one_click_orgs/invitation_code.rb">lib/one_click_orgs/invitation_code.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>39</td>
        <td>20</td>
        <td>20</td>
        <td>0</td>
        <td>77.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#afaac4829e98fc9be925ff74913fb1af5e77da7e" class="src_link" title="lib/one_click_orgs/mail_helper.rb">lib/one_click_orgs/mail_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>9</td>
        <td>9</td>
        <td>0</td>
        <td>294.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b16d109f2838158263bd479841613d391460c540" class="src_link" title="lib/one_click_orgs/model_wrapper.rb">lib/one_click_orgs/model_wrapper.rb</a></td>
        <td class="yellow strong">88.24 %</td>
        <td>63</td>
        <td>34</td>
        <td>30</td>
        <td>4</td>
        <td>29.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3ff41dc6f4ee4aee74c8adf1bb90c0c5f4af2534" class="src_link" title="lib/one_click_orgs/notification_consumer.rb">lib/one_click_orgs/notification_consumer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>31</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>9.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c4073c6e3880697914dae5b9e8a97babd2cd6a1b" class="src_link" title="lib/one_click_orgs/organisation_resolver.rb">lib/one_click_orgs/organisation_resolver.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>44</td>
        <td>13</td>
        <td>13</td>
        <td>0</td>
        <td>2770.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#926e1bc4e464c1e7dca3d57ba7ee9ec4b8121a51" class="src_link" title="lib/one_click_orgs/parameters_hash.rb">lib/one_click_orgs/parameters_hash.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>17</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>572.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#43e52f43982f20223d18afddd5ae7084df164428" class="src_link" title="lib/one_click_orgs/parameters_serialisation.rb">lib/one_click_orgs/parameters_serialisation.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>745.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#af1a08a941e2571b6064905aeea5a1e9f5863c50" class="src_link" title="lib/one_click_orgs/setup.rb">lib/one_click_orgs/setup.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>7</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>254.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#561888fb907b820a806e03a171074bdb19a11c96" class="src_link" title="lib/one_click_orgs/user_authentication.rb">lib/one_click_orgs/user_authentication.rb</a></td>
        <td class="green strong">93.55 %</td>
        <td>66</td>
        <td>31</td>
        <td>29</td>
        <td>2</td>
        <td>180.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2d92779846064d5ad2c40a44de49f863a360830f" class="src_link" title="lib/one_click_orgs/version.rb">lib/one_click_orgs/version.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>256.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#69313dfe05a67036876829536dd5e8c245c46d04" class="src_link" title="lib/periodic_proposal_closer.rb">lib/periodic_proposal_closer.rb</a></td>
        <td class="red strong">50.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>2</td>
        <td>2</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f2d7dc0c00c19275defd621499f80fc6d28a4577" class="src_link" title="lib/unauthenticated.rb">lib/unauthenticated.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>5</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#00781b5f9f4b2683cd023fdadc14d92f35311ec3" class="src_link" title="lib/vote_error.rb">lib/vote_error.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
    </tbody>
  </table>
</div>


        
          <div class="file_list_container" id="Controllers">
  <h2>
    <span class="group_name">Controllers</span>
    (<span class="covered_percent"><span class="yellow">89.66%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         16.24
       </span>
    </span> hits/line)
  </h2>
  <a name="Controllers"></a>
  <div>
    <b>45</b> files in total.
    <b>967</b> relevant lines. 
    <span class="green"><b>867</b> lines covered</span> and
    <span class="red"><b>100</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#8c12d37e0c4b53861f81dd5e193930d281ab69e5" class="src_link" title="app/controllers/add_member_proposals_controller.rb">app/controllers/add_member_proposals_controller.rb</a></td>
        <td class="yellow strong">84.62 %</td>
        <td>21</td>
        <td>13</td>
        <td>11</td>
        <td>2</td>
        <td>5.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#161eac20a7e04ce55abcef4780b762bf68c6a30a" class="src_link" title="app/controllers/admin/coops_controller.rb">app/controllers/admin/coops_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>23</td>
        <td>16</td>
        <td>16</td>
        <td>0</td>
        <td>1.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#66a2d8c4e958c73c135a421b0d38f9b44ef0fff5" class="src_link" title="app/controllers/admin_controller.rb">app/controllers/admin_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#bd17821c6be1449241f3d82669efb037061e7da7" class="src_link" title="app/controllers/administrator_sessions_controller.rb">app/controllers/administrator_sessions_controller.rb</a></td>
        <td class="yellow strong">88.24 %</td>
        <td>28</td>
        <td>17</td>
        <td>15</td>
        <td>2</td>
        <td>1.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6761ab384d4537a30f29b2f2bcdc56be44067ffa" class="src_link" title="app/controllers/application_controller.rb">app/controllers/application_controller.rb</a></td>
        <td class="green strong">90.48 %</td>
        <td>329</td>
        <td>147</td>
        <td>133</td>
        <td>14</td>
        <td>459.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a998656920b58a122cf37ae3e7f1f9db1057ec79" class="src_link" title="app/controllers/associations_controller.rb">app/controllers/associations_controller.rb</a></td>
        <td class="red strong">79.07 %</td>
        <td>82</td>
        <td>43</td>
        <td>34</td>
        <td>9</td>
        <td>2.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ad1694d41c8b9275548620d72eac5870b8330f8e" class="src_link" title="app/controllers/ballots_controller.rb">app/controllers/ballots_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>22</td>
        <td>15</td>
        <td>15</td>
        <td>0</td>
        <td>5.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#81caa65cf344657a93d93d00554440be636f8e7b" class="src_link" title="app/controllers/board_meetings_controller.rb">app/controllers/board_meetings_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>12</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>3.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#41ba8e9a78c7369589e32145cdc4251b65dc16bf" class="src_link" title="app/controllers/board_resolutions_controller.rb">app/controllers/board_resolutions_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>12</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>4.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2be4db27933558cd021b343d45611807111f8d98" class="src_link" title="app/controllers/change_meeting_notice_period_resolutions_controller.rb">app/controllers/change_meeting_notice_period_resolutions_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>26</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>8.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3f09196d66564b2d72da592b57371318795e0eee" class="src_link" title="app/controllers/change_member_class_proposals_controller.rb">app/controllers/change_member_class_proposals_controller.rb</a></td>
        <td class="red strong">80.0 %</td>
        <td>18</td>
        <td>10</td>
        <td>8</td>
        <td>2</td>
        <td>4.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#42382a88155c76c5e17e7bc5f99879384b4abd23" class="src_link" title="app/controllers/change_quorum_resolutions_controller.rb">app/controllers/change_quorum_resolutions_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>14</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>5.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ba4373a8d13d83e820fbe2e0cdea160d5da38561" class="src_link" title="app/controllers/comments_controller.rb">app/controllers/comments_controller.rb</a></td>
        <td class="red strong">65.0 %</td>
        <td>39</td>
        <td>20</td>
        <td>13</td>
        <td>7</td>
        <td>6.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#dbc30f5399f93d791d5fdfca4c41845a7c96d71a" class="src_link" title="app/controllers/companies_controller.rb">app/controllers/companies_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>26</td>
        <td>18</td>
        <td>18</td>
        <td>0</td>
        <td>7.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a039cd110a59e3f87eb89f710a9a24178923a81e" class="src_link" title="app/controllers/constitution_proposal_bundles_controller.rb">app/controllers/constitution_proposal_bundles_controller.rb</a></td>
        <td class="yellow strong">85.71 %</td>
        <td>27</td>
        <td>14</td>
        <td>12</td>
        <td>2</td>
        <td>8.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3c8678e3e7b66407c584ddc767820f202a96b462" class="src_link" title="app/controllers/constitutions_controller.rb">app/controllers/constitutions_controller.rb</a></td>
        <td class="yellow strong">86.21 %</td>
        <td>50</td>
        <td>29</td>
        <td>25</td>
        <td>4</td>
        <td>10.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#edbfd2a53d9a8f8d35e9cac02717f72d937963b0" class="src_link" title="app/controllers/coops_controller.rb">app/controllers/coops_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>43</td>
        <td>24</td>
        <td>24</td>
        <td>0</td>
        <td>4.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7d8eaed1c6901b06167ac0d6ed1c9593bdb15d6f" class="src_link" title="app/controllers/decisions_controller.rb">app/controllers/decisions_controller.rb</a></td>
        <td class="red strong">50.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>2</td>
        <td>2</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#60485d7da56f330f223c198f7b1298e874e46c4c" class="src_link" title="app/controllers/directors_controller.rb">app/controllers/directors_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>32</td>
        <td>21</td>
        <td>21</td>
        <td>0</td>
        <td>7.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d98d496ad5b1a992d6db711bbfe50169896038e4" class="src_link" title="app/controllers/directorships_controller.rb">app/controllers/directorships_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>22</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>3.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#89e31e2d6766572ee924a6d4f213cd2f88e89f73" class="src_link" title="app/controllers/eject_member_proposals_controller.rb">app/controllers/eject_member_proposals_controller.rb</a></td>
        <td class="red strong">80.0 %</td>
        <td>15</td>
        <td>10</td>
        <td>8</td>
        <td>2</td>
        <td>2.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#63bede61845d88e2665194aa7bc2bbf25a781d44" class="src_link" title="app/controllers/found_association_proposals_controller.rb">app/controllers/found_association_proposals_controller.rb</a></td>
        <td class="yellow strong">84.62 %</td>
        <td>22</td>
        <td>13</td>
        <td>11</td>
        <td>2</td>
        <td>1.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7c29c3a5f875bd1ce400ce54deccf36ccc5db8dd" class="src_link" title="app/controllers/founder_members_controller.rb">app/controllers/founder_members_controller.rb</a></td>
        <td class="red strong">69.23 %</td>
        <td>21</td>
        <td>13</td>
        <td>9</td>
        <td>4</td>
        <td>0.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6b15b5ddaba231c65c03976411f5047f3b71d8b1" class="src_link" title="app/controllers/founding_members_controller.rb">app/controllers/founding_members_controller.rb</a></td>
        <td class="yellow strong">85.71 %</td>
        <td>22</td>
        <td>14</td>
        <td>12</td>
        <td>2</td>
        <td>4.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#139fe03719996788b974ad3b75b4ee11ef46d91a" class="src_link" title="app/controllers/general_meetings_controller.rb">app/controllers/general_meetings_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>33</td>
        <td>20</td>
        <td>20</td>
        <td>0</td>
        <td>5.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8aab7633a7a3ee139347e3e938f6d1f397049e9b" class="src_link" title="app/controllers/invitations_controller.rb">app/controllers/invitations_controller.rb</a></td>
        <td class="yellow strong">88.24 %</td>
        <td>31</td>
        <td>17</td>
        <td>15</td>
        <td>2</td>
        <td>5.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1610b6543cd3bfeca2ce73874c81eb1a6f115a35" class="src_link" title="app/controllers/meetings_controller.rb">app/controllers/meetings_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>42</td>
        <td>23</td>
        <td>23</td>
        <td>0</td>
        <td>7.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#235d2625f220fab83f8fa26925a5db014381d49d" class="src_link" title="app/controllers/member_sessions_controller.rb">app/controllers/member_sessions_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>37</td>
        <td>23</td>
        <td>23</td>
        <td>0</td>
        <td>52.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#105821dc5ab76da01e9773ca7427d8cf375fe790" class="src_link" title="app/controllers/members_controller.rb">app/controllers/members_controller.rb</a></td>
        <td class="green strong">94.19 %</td>
        <td>164</td>
        <td>86</td>
        <td>81</td>
        <td>5</td>
        <td>6.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#bcee037100a2e96b26daba890ff946e8c9c0f541" class="src_link" title="app/controllers/membership_application_forms_controller.rb">app/controllers/membership_application_forms_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>15</td>
        <td>9</td>
        <td>9</td>
        <td>0</td>
        <td>3.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#141e757ffc396dc3b89da7f95ce1724a5bce366d" class="src_link" title="app/controllers/officerships_controller.rb">app/controllers/officerships_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>22</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>4.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4b839c55c024c50744210aed600606a8459e1339" class="src_link" title="app/controllers/one_click_controller.rb">app/controllers/one_click_controller.rb</a></td>
        <td class="green strong">92.31 %</td>
        <td>56</td>
        <td>26</td>
        <td>24</td>
        <td>2</td>
        <td>46.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#135385e3c312f06a1713a69276c14a2dafe6ee9a" class="src_link" title="app/controllers/organisations_controller.rb">app/controllers/organisations_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b4b6e199bd87480f0ec74e4677cbf05b6fbacfd7" class="src_link" title="app/controllers/password_resets_controller.rb">app/controllers/password_resets_controller.rb</a></td>
        <td class="red strong">46.15 %</td>
        <td>39</td>
        <td>26</td>
        <td>12</td>
        <td>14</td>
        <td>1.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fb158ab3822a81a9229b9074c1deb9606f80d86f" class="src_link" title="app/controllers/proposals_controller.rb">app/controllers/proposals_controller.rb</a></td>
        <td class="green strong">96.43 %</td>
        <td>52</td>
        <td>28</td>
        <td>27</td>
        <td>1</td>
        <td>7.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1bf6762d52323a4aa31c5dce27dc45130070ccf3" class="src_link" title="app/controllers/registration_forms_controller.rb">app/controllers/registration_forms_controller.rb</a></td>
        <td class="red strong">80.0 %</td>
        <td>27</td>
        <td>15</td>
        <td>12</td>
        <td>3</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1673f88fcabf4b4e8e7875eed46773b25d8a0763" class="src_link" title="app/controllers/resolution_proposals_controller.rb">app/controllers/resolution_proposals_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>45</td>
        <td>31</td>
        <td>31</td>
        <td>0</td>
        <td>3.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#45c960cdf8d5b375dd3a6d455c7ef12911c89d19" class="src_link" title="app/controllers/resolutions_controller.rb">app/controllers/resolutions_controller.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>23</td>
        <td>15</td>
        <td>10</td>
        <td>5</td>
        <td>2.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#865ef817e4e5582fb04f5d5a188d7c42c85e974a" class="src_link" title="app/controllers/setup_controller.rb">app/controllers/setup_controller.rb</a></td>
        <td class="green strong">93.55 %</td>
        <td>46</td>
        <td>31</td>
        <td>29</td>
        <td>2</td>
        <td>3.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#edfcc88f55d07e3b56ae77db46a8c4e68c0716b5" class="src_link" title="app/controllers/share_applications_controller.rb">app/controllers/share_applications_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>12</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>3.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#02031c10ca37a424f75e324aa9641085cabe1950" class="src_link" title="app/controllers/share_transactions_controller.rb">app/controllers/share_transactions_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0fa2db0357d00c20086ac9068b4e1bba65e53e86" class="src_link" title="app/controllers/shares_controller.rb">app/controllers/shares_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>50</td>
        <td>27</td>
        <td>27</td>
        <td>0</td>
        <td>2.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1118f9f872ad98e5035533533de1f0d4d0fa5c5a" class="src_link" title="app/controllers/system_controller.rb">app/controllers/system_controller.rb</a></td>
        <td class="red strong">54.55 %</td>
        <td>18</td>
        <td>11</td>
        <td>6</td>
        <td>5</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#670f9cf4a5941ba456024a4bd1c89b59b4b06820" class="src_link" title="app/controllers/votes_controller.rb">app/controllers/votes_controller.rb</a></td>
        <td class="yellow strong">85.29 %</td>
        <td>71</td>
        <td>34</td>
        <td>29</td>
        <td>5</td>
        <td>2.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e889bd3535717270aad39b8c5ba1d7533d2b8baa" class="src_link" title="app/controllers/welcome_controller.rb">app/controllers/welcome_controller.rb</a></td>
        <td class="yellow strong">86.67 %</td>
        <td>26</td>
        <td>15</td>
        <td>13</td>
        <td>2</td>
        <td>1.7</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Models">
  <h2>
    <span class="group_name">Models</span>
    (<span class="covered_percent"><span class="green">92.28%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         94.21
       </span>
    </span> hits/line)
  </h2>
  <a name="Models"></a>
  <div>
    <b>61</b> files in total.
    <b>1891</b> relevant lines. 
    <span class="green"><b>1745</b> lines covered</span> and
    <span class="red"><b>146</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#1ff3afefca659f070fe5e7bd1dbe18ada63bdfa0" class="src_link" title="app/models/ability.rb">app/models/ability.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>97</td>
        <td>51</td>
        <td>51</td>
        <td>0</td>
        <td>132.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#dba0f2ac2c34b50588d14d7f54627d1edebe3451" class="src_link" title="app/models/add_member_proposal.rb">app/models/add_member_proposal.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>69</td>
        <td>39</td>
        <td>39</td>
        <td>0</td>
        <td>10.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9dcc13f30dbdee4533f24692ead618d2b7b9b6b0" class="src_link" title="app/models/administrator.rb">app/models/administrator.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>5</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6d564e64a6e054472a084a19da3f521e5930b59a" class="src_link" title="app/models/annual_general_meeting.rb">app/models/annual_general_meeting.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>25</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>5.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1e1deb38ffd012469cbd2c52e8be32d4ca2c4723" class="src_link" title="app/models/association.rb">app/models/association.rb</a></td>
        <td class="green strong">96.59 %</td>
        <td>174</td>
        <td>88</td>
        <td>85</td>
        <td>3</td>
        <td>88.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2653c7b61f9baad893feb0dd69c7183ff665e943" class="src_link" title="app/models/ballot.rb">app/models/ballot.rb</a></td>
        <td class="green strong">96.3 %</td>
        <td>57</td>
        <td>27</td>
        <td>26</td>
        <td>1</td>
        <td>39.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#bfb4658584deca3bc01ce23fe760705c0b097356" class="src_link" title="app/models/board_meeting.rb">app/models/board_meeting.rb</a></td>
        <td class="yellow strong">87.5 %</td>
        <td>15</td>
        <td>8</td>
        <td>7</td>
        <td>1</td>
        <td>2.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8ba260168da40660dbc0ccbfc32557208a064c2e" class="src_link" title="app/models/board_resolution.rb">app/models/board_resolution.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b9a94b8d2015510824d131b4a2f6f2c0f920945c" class="src_link" title="app/models/change_boolean_proposal.rb">app/models/change_boolean_proposal.rb</a></td>
        <td class="red strong">58.33 %</td>
        <td>25</td>
        <td>12</td>
        <td>7</td>
        <td>5</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#203373be251d19a6bb5c42695582c2b6ef404f1c" class="src_link" title="app/models/change_boolean_resolution.rb">app/models/change_boolean_resolution.rb</a></td>
        <td class="red strong">75.0 %</td>
        <td>23</td>
        <td>12</td>
        <td>9</td>
        <td>3</td>
        <td>9.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3e7c6d5c459a9070168da011e41b952da45e79ce" class="src_link" title="app/models/change_integer_resolution.rb">app/models/change_integer_resolution.rb</a></td>
        <td class="red strong">77.78 %</td>
        <td>34</td>
        <td>18</td>
        <td>14</td>
        <td>4</td>
        <td>15.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#43140d21695ba5605f2c99e87e17bb98f54e744e" class="src_link" title="app/models/change_meeting_notice_period_resolution.rb">app/models/change_meeting_notice_period_resolution.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>12</td>
        <td>12</td>
        <td>0</td>
        <td>4.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7475991df5a4f50562fba163c744abc3ca79a053" class="src_link" title="app/models/change_member_class_proposal.rb">app/models/change_member_class_proposal.rb</a></td>
        <td class="yellow strong">82.14 %</td>
        <td>50</td>
        <td>28</td>
        <td>23</td>
        <td>5</td>
        <td>2.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#817885978429f8334680c7a00911f086c114fda2" class="src_link" title="app/models/change_quorum_resolution.rb">app/models/change_quorum_resolution.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>28</td>
        <td>15</td>
        <td>15</td>
        <td>0</td>
        <td>3.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#85976b46305e321d6cdfa185d1cc76938b101b73" class="src_link" title="app/models/change_text_proposal.rb">app/models/change_text_proposal.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>37</td>
        <td>18</td>
        <td>18</td>
        <td>0</td>
        <td>2.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b59be7f7b996c37290f96d3b17ebbaf1a2752dca" class="src_link" title="app/models/change_text_resolution.rb">app/models/change_text_resolution.rb</a></td>
        <td class="green strong">94.44 %</td>
        <td>34</td>
        <td>18</td>
        <td>17</td>
        <td>1</td>
        <td>15.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#aac5f15215973379cd0ac0d0c1cccb88ab0c409d" class="src_link" title="app/models/change_voting_period_proposal.rb">app/models/change_voting_period_proposal.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>21</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>1.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#87d2e9aac60a7952a3618ae3df75d4762fad1d5a" class="src_link" title="app/models/change_voting_system_proposal.rb">app/models/change_voting_system_proposal.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>29</td>
        <td>15</td>
        <td>15</td>
        <td>0</td>
        <td>2.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#de666b7a4b1a2be96e7d217f573b9437aa28305c" class="src_link" title="app/models/clause.rb">app/models/clause.rb</a></td>
        <td class="green strong">93.18 %</td>
        <td>92</td>
        <td>44</td>
        <td>41</td>
        <td>3</td>
        <td>1385.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3de55437c663abd4625d2c2edee6d4c07faf19de" class="src_link" title="app/models/comment.rb">app/models/comment.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b59d362145d47440f82b0537dc6a669de968bb5c" class="src_link" title="app/models/company.rb">app/models/company.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>42</td>
        <td>25</td>
        <td>25</td>
        <td>0</td>
        <td>15.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4e778582d730ea196e015f33762acc45835d12da" class="src_link" title="app/models/constitution.rb">app/models/constitution.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>64</td>
        <td>26</td>
        <td>26</td>
        <td>0</td>
        <td>277.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e1089605b7c5daa4b647637e358250cec6ed024d" class="src_link" title="app/models/constitution_proposal.rb">app/models/constitution_proposal.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>5.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#aa8a2bd3a5ee350db9650ef5c9905c5acba3bc60" class="src_link" title="app/models/constitution_proposal_bundle.rb">app/models/constitution_proposal_bundle.rb</a></td>
        <td class="red strong">78.84 %</td>
        <td>650</td>
        <td>241</td>
        <td>190</td>
        <td>51</td>
        <td>15.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#07257a60d20d4b8f387e139bae0e6b573479a862" class="src_link" title="app/models/constitution_wrapper.rb">app/models/constitution_wrapper.rb</a></td>
        <td class="yellow strong">86.59 %</td>
        <td>165</td>
        <td>82</td>
        <td>71</td>
        <td>11</td>
        <td>3.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6bf004b0ee1e040ebe5a5e2d2d2dc87b4dd2f346" class="src_link" title="app/models/coop.rb">app/models/coop.rb</a></td>
        <td class="green strong">92.31 %</td>
        <td>433</td>
        <td>247</td>
        <td>228</td>
        <td>19</td>
        <td>47.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#19ca86f6cab3d632f581887ada28c3e80fc9023d" class="src_link" title="app/models/decision.rb">app/models/decision.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>13</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>6.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1657823b01412dd49c6ad6b44143e883d4859ccf" class="src_link" title="app/models/director.rb">app/models/director.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>25</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>2.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#39950dd4b27d40525cf45fa330f2eb23edc0906d" class="src_link" title="app/models/directorship.rb">app/models/directorship.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>39</td>
        <td>23</td>
        <td>23</td>
        <td>0</td>
        <td>75.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#736ec96780367d27cf1c64b29d2c21b9eb2912d9" class="src_link" title="app/models/eject_member_proposal.rb">app/models/eject_member_proposal.rb</a></td>
        <td class="green strong">93.33 %</td>
        <td>31</td>
        <td>15</td>
        <td>14</td>
        <td>1</td>
        <td>2.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5da37002fc08bc6c36d8de3eccdc6cf3c45a6603" class="src_link" title="app/models/election.rb">app/models/election.rb</a></td>
        <td class="green strong">93.33 %</td>
        <td>81</td>
        <td>45</td>
        <td>42</td>
        <td>3</td>
        <td>6.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f6c3081d06f3201cb4e3980267d82377f26fbc04" class="src_link" title="app/models/extraordinary_resolution.rb">app/models/extraordinary_resolution.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ae21770099ec572ab3be1c92b313a841beee80db" class="src_link" title="app/models/found_association_proposal.rb">app/models/found_association_proposal.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>69</td>
        <td>36</td>
        <td>36</td>
        <td>0</td>
        <td>14.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f828802acb4f19baf30cbf9484aa253305240413" class="src_link" title="app/models/founder_member.rb">app/models/founder_member.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#53605500ea3993210b8306a63444f11d2f9d15b4" class="src_link" title="app/models/founding_member.rb">app/models/founding_member.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#de7300a69307856a1f5e4e411f41163dedc726a3" class="src_link" title="app/models/general_meeting.rb">app/models/general_meeting.rb</a></td>
        <td class="green strong">95.83 %</td>
        <td>60</td>
        <td>24</td>
        <td>23</td>
        <td>1</td>
        <td>51.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#22d9891380a79222ec8eeae919fd839b3b309528" class="src_link" title="app/models/invitation.rb">app/models/invitation.rb</a></td>
        <td class="green strong">96.88 %</td>
        <td>79</td>
        <td>32</td>
        <td>31</td>
        <td>1</td>
        <td>10.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f6b58bef81caf67b905dfa8fa8b46acf88cb80bb" class="src_link" title="app/models/meeting.rb">app/models/meeting.rb</a></td>
        <td class="green strong">95.83 %</td>
        <td>49</td>
        <td>24</td>
        <td>23</td>
        <td>1</td>
        <td>8.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#52028891955eb6fdba2586159e6c991d5bda6b84" class="src_link" title="app/models/meeting_participation.rb">app/models/meeting_participation.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f729890a43f038a0bbf7968e73e9b89f46bb81d3" class="src_link" title="app/models/member.rb">app/models/member.rb</a></td>
        <td class="green strong">96.19 %</td>
        <td>201</td>
        <td>105</td>
        <td>101</td>
        <td>4</td>
        <td>161.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3da331b8d972c4fbd560f29ce1aaa87cb0646806" class="src_link" title="app/models/member_class.rb">app/models/member_class.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>31</td>
        <td>17</td>
        <td>17</td>
        <td>0</td>
        <td>1186.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#13c91d565c7291cae00dbcf9f5ebd447ebe7750a" class="src_link" title="app/models/member_state_transition.rb">app/models/member_state_transition.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>4</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#79cdc499ee99f6851d36a599d8978a36729c38c8" class="src_link" title="app/models/membership_proposal.rb">app/models/membership_proposal.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>6.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6fe90238a079347ab9f084b7f93c2fecd82f7118" class="src_link" title="app/models/nomination.rb">app/models/nomination.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>20</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ba8b1d3e36673b534917e40e99f3a27f81285bcf" class="src_link" title="app/models/office.rb">app/models/office.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>17</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>27.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5805faacdc8e224192305f03141beecf0d35bcde" class="src_link" title="app/models/officership.rb">app/models/officership.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>64</td>
        <td>24</td>
        <td>24</td>
        <td>0</td>
        <td>19.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#54a33049d7a70da3fcac115abab06b2c157d9624" class="src_link" title="app/models/organisation.rb">app/models/organisation.rb</a></td>
        <td class="green strong">90.38 %</td>
        <td>106</td>
        <td>52</td>
        <td>47</td>
        <td>5</td>
        <td>223.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ea8364bd407b410945ccbe07b1d9c25e81c4cc4e" class="src_link" title="app/models/proposal.rb">app/models/proposal.rb</a></td>
        <td class="green strong">96.1 %</td>
        <td>177</td>
        <td>77</td>
        <td>74</td>
        <td>3</td>
        <td>20.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#202af0b578da433d84b91405320ea2bfdde6c1d3" class="src_link" title="app/models/resignation.rb">app/models/resignation.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>2.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3e2c7fb289ca290125c5b6e11e2415168898d114" class="src_link" title="app/models/resolution.rb">app/models/resolution.rb</a></td>
        <td class="green strong">97.44 %</td>
        <td>85</td>
        <td>39</td>
        <td>38</td>
        <td>1</td>
        <td>35.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c99af871f7be0856d7250f75b1d322e8431976da" class="src_link" title="app/models/resolution_proposal.rb">app/models/resolution_proposal.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>88</td>
        <td>43</td>
        <td>43</td>
        <td>0</td>
        <td>24.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1542485f9799d0325ae0bef7b9cc49192c31d037" class="src_link" title="app/models/seen_notification.rb">app/models/seen_notification.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>7</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#27d5fa35ff5f92baeca1064f8fcb72ee54a732ba" class="src_link" title="app/models/setting.rb">app/models/setting.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>1614.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2c419031d801af2e81478852b9fd34a04b02330c" class="src_link" title="app/models/share_account.rb">app/models/share_account.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>4.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b166447a42f920bcd5048516eacfff74ed4bca79" class="src_link" title="app/models/share_application.rb">app/models/share_application.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>36</td>
        <td>20</td>
        <td>20</td>
        <td>0</td>
        <td>2.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#71895e87cc5a8bdfdcb05a56dfa1ae7c9ba1fb77" class="src_link" title="app/models/share_transaction.rb">app/models/share_transaction.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>29</td>
        <td>16</td>
        <td>16</td>
        <td>0</td>
        <td>1.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fe7ef68a6095c76a82ed95c9a2033cee4069ac67" class="src_link" title="app/models/share_transaction_state_transition.rb">app/models/share_transaction_state_transition.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>4</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#44975eb994d9e3ae9e16f7060038a418b257720c" class="src_link" title="app/models/task.rb">app/models/task.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>15</td>
        <td>15</td>
        <td>0</td>
        <td>8.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b57a2900cc046f27aa6eec375477bb802cce4d5c" class="src_link" title="app/models/vote.rb">app/models/vote.rb</a></td>
        <td class="yellow strong">90.0 %</td>
        <td>18</td>
        <td>10</td>
        <td>9</td>
        <td>1</td>
        <td>5.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#79688c9a248e85248f34e010b0d1223991d600de" class="src_link" title="app/models/voting_periods.rb">app/models/voting_periods.rb</a></td>
        <td class="red strong">76.19 %</td>
        <td>36</td>
        <td>21</td>
        <td>16</td>
        <td>5</td>
        <td>68.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#605cbc14105a55d352643216f5378db5f7764afc" class="src_link" title="app/models/voting_systems.rb">app/models/voting_systems.rb</a></td>
        <td class="yellow strong">87.96 %</td>
        <td>223</td>
        <td>108</td>
        <td>95</td>
        <td>13</td>
        <td>48.6</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Mailers">
  <h2>
    <span class="group_name">Mailers</span>
    (<span class="covered_percent"><span class="green">92.57%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         37.4
       </span>
    </span> hits/line)
  </h2>
  <a name="Mailers"></a>
  <div>
    <b>9</b> files in total.
    <b>202</b> relevant lines. 
    <span class="green"><b>187</b> lines covered</span> and
    <span class="red"><b>15</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#fdeb0258d486a2f64be2e3ea43f58253220965f2" class="src_link" title="app/mailers/decision_mailer.rb">app/mailers/decision_mailer.rb</a></td>
        <td class="green strong">96.0 %</td>
        <td>40</td>
        <td>25</td>
        <td>24</td>
        <td>1</td>
        <td>30.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5c3b838f0910aec634d9700571ed09a10684284e" class="src_link" title="app/mailers/directorship_mailer.rb">app/mailers/directorship_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>103.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#741bf6222693bc545b45b53bd62c32f16ed156b4" class="src_link" title="app/mailers/meeting_mailer.rb">app/mailers/meeting_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>40</td>
        <td>16</td>
        <td>16</td>
        <td>0</td>
        <td>9.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7ae153d10085ffec5b9ea149c199269a514acc2a" class="src_link" title="app/mailers/members_mailer.rb">app/mailers/members_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>126</td>
        <td>78</td>
        <td>78</td>
        <td>0</td>
        <td>4.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0c52af5951a16cfab0fb00048d65d8d04f38f7fa" class="src_link" title="app/mailers/oco_mailer.rb">app/mailers/oco_mailer.rb</a></td>
        <td class="red strong">58.62 %</td>
        <td>53</td>
        <td>29</td>
        <td>17</td>
        <td>12</td>
        <td>89.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6fe86854ee125a82de9f6bc68865728647321bd6" class="src_link" title="app/mailers/officership_mailer.rb">app/mailers/officership_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>12</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>8.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#54214331c7bfb3dad1b29733291e35e8497910d6" class="src_link" title="app/mailers/proposal_mailer.rb">app/mailers/proposal_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>40</td>
        <td>25</td>
        <td>25</td>
        <td>0</td>
        <td>85.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5eeeaf25157693d384e2535f342e66b2e571fd82" class="src_link" title="app/mailers/share_transaction_mailer.rb">app/mailers/share_transaction_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>17</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>3.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7109991646102c6dff6ed6700205dc4c5d4493fa" class="src_link" title="app/mailers/test_mailer.rb">app/mailers/test_mailer.rb</a></td>
        <td class="red strong">50.0 %</td>
        <td>7</td>
        <td>4</td>
        <td>2</td>
        <td>2</td>
        <td>1.0</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Helpers">
  <h2>
    <span class="group_name">Helpers</span>
    (<span class="covered_percent"><span class="yellow">89.29%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         6.48
       </span>
    </span> hits/line)
  </h2>
  <a name="Helpers"></a>
  <div>
    <b>38</b> files in total.
    <b>84</b> relevant lines. 
    <span class="green"><b>75</b> lines covered</span> and
    <span class="red"><b>9</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#a92243d070d9eba1e4e9f4c80526838e1f61e745" class="src_link" title="app/helpers/add_member_proposals_helper.rb">app/helpers/add_member_proposals_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5a7084ad4fa1ac626cfff2a20b37464d722e4d81" class="src_link" title="app/helpers/administrator_sessions_helper.rb">app/helpers/administrator_sessions_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0893819bb574f10c3ceb4984b129db7d87e34b10" class="src_link" title="app/helpers/application_helper.rb">app/helpers/application_helper.rb</a></td>
        <td class="yellow strong">80.49 %</td>
        <td>97</td>
        <td>41</td>
        <td>33</td>
        <td>8</td>
        <td>162.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#04c40c4c9998051eeedc09c74aaf2bb29ef3f8ed" class="src_link" title="app/helpers/associations_helper.rb">app/helpers/associations_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#34474df636d8eff1cb0a8702a465a73bff9f9c6a" class="src_link" title="app/helpers/ballots_helper.rb">app/helpers/ballots_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#08e92dfce9301432e302cd5b1ac6476c3d58d23f" class="src_link" title="app/helpers/board_meetings_helper.rb">app/helpers/board_meetings_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b4ae4f6b7c3ca50d53df02acc4136e9a1b63fcd4" class="src_link" title="app/helpers/board_resolutions_helper.rb">app/helpers/board_resolutions_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0ea901e894af3e18c74344651426bff10768915f" class="src_link" title="app/helpers/change_meeting_notice_period_resolutions_helper.rb">app/helpers/change_meeting_notice_period_resolutions_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#cc79ac982fd27cf8ec24d7c2b2adbdb4f502b0ef" class="src_link" title="app/helpers/change_member_class_proposals_helper.rb">app/helpers/change_member_class_proposals_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#30a8d2d2cd234cce05cfd00abd7bbbe1862d8abf" class="src_link" title="app/helpers/change_quorum_resolutions_helper.rb">app/helpers/change_quorum_resolutions_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f5b66baf6541b1e196aef12fd6015f5ed1c1fff7" class="src_link" title="app/helpers/comments_helper.rb">app/helpers/comments_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#03564eb8a2a61709ee6c942e17b28667036261c1" class="src_link" title="app/helpers/companies_helper.rb">app/helpers/companies_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2406beae7465e2d0c11af2285ac95d32c7381f70" class="src_link" title="app/helpers/constitutions_helper.rb">app/helpers/constitutions_helper.rb</a></td>
        <td class="yellow strong">85.71 %</td>
        <td>11</td>
        <td>7</td>
        <td>6</td>
        <td>1</td>
        <td>11.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#eb170d588d6e504850f33c4d41420d57648eba0f" class="src_link" title="app/helpers/coops_helper.rb">app/helpers/coops_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#927b8e28263b64792daef14898234be57b601fda" class="src_link" title="app/helpers/decisions_helper.rb">app/helpers/decisions_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#811eaa4e8e3d0cf0b50948533fbbc8d0ff822c04" class="src_link" title="app/helpers/directors_helper.rb">app/helpers/directors_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b6063b12a377ce24ab2b9ffa5fa818537670d494" class="src_link" title="app/helpers/directorships_helper.rb">app/helpers/directorships_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7b998c56a2a8aa7d78c2e023fa309927cb4ec0d8" class="src_link" title="app/helpers/eject_member_proposals_helper.rb">app/helpers/eject_member_proposals_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#00a7071fcf74926378088daa9efae14ab71e5d0c" class="src_link" title="app/helpers/founding_members_helper.rb">app/helpers/founding_members_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3ace8b913cf74cc3d17781beda572427a527814a" class="src_link" title="app/helpers/general_meetings_helper.rb">app/helpers/general_meetings_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#af2904d55372925b20066c0410b2da9932fa272a" class="src_link" title="app/helpers/invitations_helper.rb">app/helpers/invitations_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#348194b6ac591ef745a1d4860de7194224f0ff45" class="src_link" title="app/helpers/meetings_helper.rb">app/helpers/meetings_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7508674060fcc056d79e35529397c4c55d7c4b7a" class="src_link" title="app/helpers/member_sessions_helper.rb">app/helpers/member_sessions_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ba950ae1fee0b5598b37a27537a2ecee03f4a881" class="src_link" title="app/helpers/members_helper.rb">app/helpers/members_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5f4f675354cea1743bbaf419928ca4fb356bd0b9" class="src_link" title="app/helpers/membership_application_forms_helper.rb">app/helpers/membership_application_forms_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e233c22e7e1d379cba121c89d3b0379700d0e30d" class="src_link" title="app/helpers/officerships_helper.rb">app/helpers/officerships_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3f86df7bea5580be88a6cbf5830ab63e7941ac91" class="src_link" title="app/helpers/one_click_helper.rb">app/helpers/one_click_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#67235943beca09855f841b40500d1f3277f56b26" class="src_link" title="app/helpers/organisations_helper.rb">app/helpers/organisations_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d5d7ae33c283f0ffc01a0a1f29aa60bbc25f3026" class="src_link" title="app/helpers/proposals_helper.rb">app/helpers/proposals_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#acad1627445a766c6e98ff147f3c4d6cbcda0409" class="src_link" title="app/helpers/registration_forms_helper.rb">app/helpers/registration_forms_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ca128c81a688e35b2ead5d1c8a33cbf43cb27f30" class="src_link" title="app/helpers/reset_password_helper.rb">app/helpers/reset_password_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#441dc8c50ede3dc180ca435d1740e7be4412d53c" class="src_link" title="app/helpers/resolution_proposals_helper.rb">app/helpers/resolution_proposals_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4d1462f993a2c4327605ace0e1c5435235d909b2" class="src_link" title="app/helpers/resolutions_helper.rb">app/helpers/resolutions_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b33e39e1668aa02937b27135edac7974ccf917f3" class="src_link" title="app/helpers/setup_helper.rb">app/helpers/setup_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#baeede9c372f4e9f3cd141680fb7d13ba11bc60c" class="src_link" title="app/helpers/share_applications_helper.rb">app/helpers/share_applications_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c11dd0e45d895f959c6dc603a05978195491233d" class="src_link" title="app/helpers/share_transactions_helper.rb">app/helpers/share_transactions_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#79dabce9557acec76b9eb5fc152c2e2d09e765cd" class="src_link" title="app/helpers/shares_helper.rb">app/helpers/shares_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ba4452cca0024f143d4d8c10c282bb53c7fc37ec" class="src_link" title="app/helpers/votes_helper.rb">app/helpers/votes_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Libraries">
  <h2>
    <span class="group_name">Libraries</span>
    (<span class="covered_percent"><span class="green">93.79%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         310.87
       </span>
    </span> hits/line)
  </h2>
  <a name="Libraries"></a>
  <div>
    <b>17</b> files in total.
    <b>177</b> relevant lines. 
    <span class="green"><b>166</b> lines covered</span> and
    <span class="red"><b>11</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#b452f5735b32a8274e87e172b9c174d75baae8d3" class="src_link" title="lib/not_found.rb">lib/not_found.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3a7c0d05c445a2e0babccfe6132042fe001f6c29" class="src_link" title="lib/one_click_orgs.rb">lib/one_click_orgs.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>3</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b97905543397a548143b22b8e678914e668cd3ea" class="src_link" title="lib/one_click_orgs/cast_to_boolean.rb">lib/one_click_orgs/cast_to_boolean.rb</a></td>
        <td class="yellow strong">85.71 %</td>
        <td>25</td>
        <td>14</td>
        <td>12</td>
        <td>2</td>
        <td>83.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a77afa1d0de53f7f5e51c1433004d440c14a005f" class="src_link" title="lib/one_click_orgs/google_analytics.rb">lib/one_click_orgs/google_analytics.rb</a></td>
        <td class="yellow strong">83.33 %</td>
        <td>10</td>
        <td>6</td>
        <td>5</td>
        <td>1</td>
        <td>1.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#686c2574405a69b86f1582327d81bc498ae2f5f2" class="src_link" title="lib/one_click_orgs/invitation_code.rb">lib/one_click_orgs/invitation_code.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>39</td>
        <td>20</td>
        <td>20</td>
        <td>0</td>
        <td>77.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#afaac4829e98fc9be925ff74913fb1af5e77da7e" class="src_link" title="lib/one_click_orgs/mail_helper.rb">lib/one_click_orgs/mail_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>9</td>
        <td>9</td>
        <td>0</td>
        <td>294.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b16d109f2838158263bd479841613d391460c540" class="src_link" title="lib/one_click_orgs/model_wrapper.rb">lib/one_click_orgs/model_wrapper.rb</a></td>
        <td class="yellow strong">88.24 %</td>
        <td>63</td>
        <td>34</td>
        <td>30</td>
        <td>4</td>
        <td>29.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3ff41dc6f4ee4aee74c8adf1bb90c0c5f4af2534" class="src_link" title="lib/one_click_orgs/notification_consumer.rb">lib/one_click_orgs/notification_consumer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>31</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>9.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c4073c6e3880697914dae5b9e8a97babd2cd6a1b" class="src_link" title="lib/one_click_orgs/organisation_resolver.rb">lib/one_click_orgs/organisation_resolver.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>44</td>
        <td>13</td>
        <td>13</td>
        <td>0</td>
        <td>2770.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#926e1bc4e464c1e7dca3d57ba7ee9ec4b8121a51" class="src_link" title="lib/one_click_orgs/parameters_hash.rb">lib/one_click_orgs/parameters_hash.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>17</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>572.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#43e52f43982f20223d18afddd5ae7084df164428" class="src_link" title="lib/one_click_orgs/parameters_serialisation.rb">lib/one_click_orgs/parameters_serialisation.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>745.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#af1a08a941e2571b6064905aeea5a1e9f5863c50" class="src_link" title="lib/one_click_orgs/setup.rb">lib/one_click_orgs/setup.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>7</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>254.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#561888fb907b820a806e03a171074bdb19a11c96" class="src_link" title="lib/one_click_orgs/user_authentication.rb">lib/one_click_orgs/user_authentication.rb</a></td>
        <td class="green strong">93.55 %</td>
        <td>66</td>
        <td>31</td>
        <td>29</td>
        <td>2</td>
        <td>180.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2d92779846064d5ad2c40a44de49f863a360830f" class="src_link" title="lib/one_click_orgs/version.rb">lib/one_click_orgs/version.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>256.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#69313dfe05a67036876829536dd5e8c245c46d04" class="src_link" title="lib/periodic_proposal_closer.rb">lib/periodic_proposal_closer.rb</a></td>
        <td class="red strong">50.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>2</td>
        <td>2</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f2d7dc0c00c19275defd621499f80fc6d28a4577" class="src_link" title="lib/unauthenticated.rb">lib/unauthenticated.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>5</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#00781b5f9f4b2683cd023fdadc14d92f35311ec3" class="src_link" title="lib/vote_error.rb">lib/vote_error.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>2</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Plugins">
  <h2>
    <span class="group_name">Plugins</span>
    (<span class="covered_percent"><span class="green">100.0%</span></span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.0
       </span>
    </span> hits/line)
  </h2>
  <a name="Plugins"></a>
  <div>
    <b>0</b> files in total.
    <b>0.0</b> relevant lines. 
    <span class="green"><b>0.0</b> lines covered</span> and
    <span class="red"><b>0.0</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Ungrouped">
  <h2>
    <span class="group_name">Ungrouped</span>
    (<span class="covered_percent"><span class="green">100.0%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         54.67
       </span>
    </span> hits/line)
  </h2>
  <a name="Ungrouped"></a>
  <div>
    <b>16</b> files in total.
    <b>188</b> relevant lines. 
    <span class="green"><b>188</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#328334ea1a791a705cbcd14298e8833dcef444c3" class="src_link" title="app/observers/decision_mailer_observer.rb">app/observers/decision_mailer_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>12</td>
        <td>12</td>
        <td>0</td>
        <td>15.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a8b598d561d5d61d4f28ebe1aa8131d175970301" class="src_link" title="app/observers/directorship_mailer_observer.rb">app/observers/directorship_mailer_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>15</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>55.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a261310663efeb14d0d92533a239f03434bf3934" class="src_link" title="app/observers/election_task_observer.rb">app/observers/election_task_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>20</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>5.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9fbf96e2ae8758ff0b87b38c9b28ba1849b0a55f" class="src_link" title="app/observers/general_meeting_task_observer.rb">app/observers/general_meeting_task_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>36</td>
        <td>17</td>
        <td>17</td>
        <td>0</td>
        <td>7.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2afd8c7903abdee2c11e8cce5c822881bae1811b" class="src_link" title="app/observers/meeting_mailer_observer.rb">app/observers/meeting_mailer_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>18</td>
        <td>9</td>
        <td>9</td>
        <td>0</td>
        <td>18.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4064f75d4f7abe1a6139f7071cc2293e91a40094" class="src_link" title="app/observers/member_mailer_observer.rb">app/observers/member_mailer_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>47</td>
        <td>24</td>
        <td>24</td>
        <td>0</td>
        <td>99.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#11cdc05308926606c1fad4cdb3ac5b3f45a6021d" class="src_link" title="app/observers/member_observer.rb">app/observers/member_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>9.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#90e98617508904462d45f275df26e28170dbaad1" class="src_link" title="app/observers/member_task_observer.rb">app/observers/member_task_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>21</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>95.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5b120c01670226375c468183160bf718af9a35c9" class="src_link" title="app/observers/member_timestamp_observer.rb">app/observers/member_timestamp_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>17</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>155.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#76fb71a7f709c978926d7e9ac0cfc1cfc29daafc" class="src_link" title="app/observers/officership_mailer_observer.rb">app/observers/officership_mailer_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>15</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>18.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#bfab5ae5e26ee67b8e8000378570955c71f46002" class="src_link" title="app/observers/proposal_mailer_observer.rb">app/observers/proposal_mailer_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>49</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>224.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a8e23e28f63d6f53d7067a65a80efad73599f12d" class="src_link" title="app/observers/proposal_timestamp_observer.rb">app/observers/proposal_timestamp_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>55</td>
        <td>21</td>
        <td>21</td>
        <td>0</td>
        <td>109.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1db64a0f1e9e9ab8938e92fc873b811504162be5" class="src_link" title="app/observers/resolution_proposal_task_observer.rb">app/observers/resolution_proposal_task_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>9</td>
        <td>9</td>
        <td>0</td>
        <td>48.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6f70b4c1cff2ce4caa61f8368f6d30d1ea1332ae" class="src_link" title="app/observers/share_transaction_mailer_observer.rb">app/observers/share_transaction_mailer_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>18</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>4.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2c43fa12e970ea2ab29b5624d4c286361d86370b" class="src_link" title="app/observers/share_transaction_task_observer.rb">app/observers/share_transaction_task_observer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>28</td>
        <td>16</td>
        <td>16</td>
        <td>0</td>
        <td>4.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3d8dde1e98522ddb5add2d33ea9c7ed74031449f" class="src_link" title="app/presenters/member_presenter.rb">app/presenters/member_presenter.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>15</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>3.3</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
      </div>
    
      <div id="footer">
        Generated by <a href="http://github.com/colszowka/simplecov">simplecov</a> v0.6.4 
        and simplecov-html v0.5.3<br/>
        using Cucumber Features, RSpec
      </div>
    
      <div class="source_files">
      
        <div class="source_table" id="8c12d37e0c4b53861f81dd5e193930d281ab69e5">
  <div class="header">
    <h3>app/controllers/add_member_proposals_controller.rb</h3>
    <h4><span class="yellow">84.62 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class AddMemberProposalsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3">
          
          
          <code class="ruby">    authorize! :create, AddMemberProposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    @add_member_proposal = co.add_member_proposals.build</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="9">
          <span class="hits">11</span>
          
          <code class="ruby">    authorize! :create, AddMemberProposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="11">
          <span class="hits">11</span>
          
          <code class="ruby">    @add_member_proposal = co.add_member_proposals.build(params[:add_member_proposal])</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="12">
          <span class="hits">11</span>
          
          <code class="ruby">    @add_member_proposal.proposer = current_user</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="13">
          <span class="hits">11</span>
          
          <code class="ruby">    if @add_member_proposal.save</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="14">
          <span class="hits">7</span>
          
          <code class="ruby">      flash[:notice] = &quot;Add Member Proposal successfully created&quot;</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="15">
          <span class="hits">7</span>
          
          <code class="ruby">      redirect_to root_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="17">
          <span class="hits">4</span>
          
          <code class="ruby">      flash.now[:error] = &quot;Error creating proposal&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="18">
          <span class="hits">4</span>
          
          <code class="ruby">      render :action =&gt; :new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="161eac20a7e04ce55abcef4780b762bf68c6a30a">
  <div class="header">
    <h3>app/controllers/admin/coops_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>16</b> relevant lines. 
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class Admin::CoopsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_organisation_exists</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_authenticated</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :prepare_notifications</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  before_filter :ensure_administrator_authenticated</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  before_filter :ensure_administration_subdomain</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  layout 'admin'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">  def index</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="12">
          <span class="hits">3</span>
          
          <code class="ruby">    @pending_coops = Coop.pending.order(&quot;created_at DESC&quot;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="13">
          <span class="hits">3</span>
          
          <code class="ruby">    @proposed_coops = Coop.proposed.order(&quot;created_at DESC&quot;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="14">
          <span class="hits">3</span>
          
          <code class="ruby">    @active_coops = Coop.active.order(&quot;created_at DESC&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  def found</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    @coop = Coop.find(params[:id])</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    @coop.found!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    flash[:notice] = &quot;#{@coop.name} is now active.&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    redirect_to admin_coops_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="66a2d8c4e958c73c135a421b0d38f9b44ef0fff5">
  <div class="header">
    <h3>app/controllers/admin_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>7</b> relevant lines. 
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class AdminController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_organisation_exists</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_authenticated</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :prepare_notifications</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  before_filter :ensure_administrator_authenticated</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  before_filter :ensure_administration_subdomain</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  def index</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="bd17821c6be1449241f3d82669efb037061e7da7">
  <div class="header">
    <h3>app/controllers/administrator_sessions_controller.rb</h3>
    <h4><span class="yellow">88.24 %</span> covered</h4>
    <div>
      <b>17</b> relevant lines. 
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class AdministratorSessionsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_organisation_exists</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_authenticated</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :prepare_notifications</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_administrator_authenticated</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  before_filter :ensure_administration_subdomain</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  layout 'admin'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">    @page_title = &quot;Administrator Login&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">    administrator = Administrator.authenticate(params[:email], params[:password])</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">    if administrator</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">      log_in_administrator administrator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">      flash[:notice] = &quot;You have logged in.&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">      redirect_back_or_default</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">      flash.now[:error] = &quot;The email address or password entered were incorrect&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">      render(:action =&gt; :new)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="6761ab384d4537a30f29b2f2bcdc56be44067ffa">
  <div class="header">
    <h3>app/controllers/application_controller.rb</h3>
    <h4><span class="green">90.48 %</span> covered</h4>
    <div>
      <b>147</b> relevant lines. 
      <span class="green"><b>133</b> lines covered</span> and
      <span class="red"><b>14</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'lib/one_click_orgs/setup'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">require 'lib/unauthenticated'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">require 'lib/not_found'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">require 'lib/one_click_orgs/organisation_resolver'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">class ApplicationController &lt; ActionController::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  protect_from_forgery</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  before_filter :ensure_set_up</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  before_filter :ensure_organisation_exists</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">  before_filter :ensure_authenticated</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  before_filter :ensure_member_active_or_pending</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">  before_filter :ensure_member_inducted</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">  before_filter :prepare_notifications</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">  before_filter :load_analytics_events_from_session</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  # CURRENT ORGANISATION</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  # Returns the organisation corresponding to the subdomain that the current</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  # request has been made on (or just returns the organisation if the app</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  # is running in single organisation mode).</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">  def current_organisation</code>
        </li>
      
        <li class="covered" data-hits="9311" data-linenumber="23">
          <span class="hits">9311</span>
          
          <code class="ruby">    unless @current_organisation</code>
        </li>
      
        <li class="covered" data-hits="1214" data-linenumber="24">
          <span class="hits">1214</span>
          
          <code class="ruby">      if Setting[:single_organisation_mode]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">        @current_organisation = Organisation.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="1212" data-linenumber="27">
          <span class="hits">1212</span>
          
          <code class="ruby">        @current_organisation = Organisation.find_by_host(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">          request.host_with_port</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1214" data-linenumber="31">
          <span class="hits">1214</span>
          
          <code class="ruby">      install_organisation_resolver(@current_organisation)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="9311" data-linenumber="33">
          <span class="hits">9311</span>
          
          <code class="ruby">    @current_organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">  alias :co :current_organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="37">
          <span class="hits">2</span>
          
          <code class="ruby">  helper_method :current_organisation, :co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  # USER LOGIN</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">  helper_method :current_user</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>
          
          <code class="ruby">  def current_user</code>
        </li>
      
        <li class="covered" data-hits="5915" data-linenumber="43">
          <span class="hits">5915</span>
          
          <code class="ruby">    @current_user if user_logged_in?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="46">
          <span class="hits">2</span>
          
          <code class="ruby">  def log_in(user)</code>
        </li>
      
        <li class="covered" data-hits="212" data-linenumber="47">
          <span class="hits">212</span>
          
          <code class="ruby">    self.current_user = user</code>
        </li>
      
        <li class="covered" data-hits="212" data-linenumber="48">
          <span class="hits">212</span>
          
          <code class="ruby">    current_user.update_attribute(:last_logged_in_at, Time.now.utc)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  # Returns true if a user is logged in; false otherwise.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="52">
          <span class="hits">2</span>
          
          <code class="ruby">  def user_logged_in?</code>
        </li>
      
        <li class="covered" data-hits="6539" data-linenumber="53">
          <span class="hits">6539</span>
          
          <code class="ruby">    current_user = @current_user</code>
        </li>
      
        <li class="covered" data-hits="6539" data-linenumber="54">
          <span class="hits">6539</span>
          
          <code class="ruby">    current_user ||= session[:user] &amp;&amp; co ? co.members.find_by_id(session[:user]) : false</code>
        </li>
      
        <li class="covered" data-hits="6539" data-linenumber="55">
          <span class="hits">6539</span>
          
          <code class="ruby">    @current_user = current_user</code>
        </li>
      
        <li class="covered" data-hits="6539" data-linenumber="56">
          <span class="hits">6539</span>
          
          <code class="ruby">    current_user.is_a?(Member)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  # Stores the given user as the 'current user', thus marking them as logged in.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="60">
          <span class="hits">2</span>
          
          <code class="ruby">  def current_user=(user)</code>
        </li>
      
        <li class="covered" data-hits="212" data-linenumber="61">
          <span class="hits">212</span>
          
          <code class="ruby">    session[:user] = (user.nil? || user.is_a?(Symbol)) ? nil : user.id</code>
        </li>
      
        <li class="covered" data-hits="212" data-linenumber="62">
          <span class="hits">212</span>
          
          <code class="ruby">    @current_user = user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  # ADMINISTRATOR LOGIN</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="67">
          <span class="hits">2</span>
          
          <code class="ruby">  helper_method :current_administrator</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="68">
          <span class="hits">2</span>
          
          <code class="ruby">  def current_administrator</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="69">
          <span class="hits">14</span>
          
          <code class="ruby">    @current_administrator if administrator_logged_in?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="72">
          <span class="hits">2</span>
          
          <code class="ruby">  def log_in_administrator(administrator)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="73">
          <span class="hits">2</span>
          
          <code class="ruby">    self.current_administrator = administrator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  # Returns true if an administrator is logged in; false otherwise.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="77">
          <span class="hits">2</span>
          
          <code class="ruby">  def administrator_logged_in?</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="78">
          <span class="hits">22</span>
          
          <code class="ruby">    current_administrator = @current_administrator</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="79">
          <span class="hits">22</span>
          
          <code class="ruby">    current_administrator ||= session[:administrator] &amp;&amp; Administrator.find_by_id(session[:administrator])</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="80">
          <span class="hits">22</span>
          
          <code class="ruby">    @current_administrator = current_administrator</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="81">
          <span class="hits">22</span>
          
          <code class="ruby">    current_administrator.is_a?(Administrator)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">  # Stores the given administrator as the 'current administrator', thus marking them as logged in.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="85">
          <span class="hits">2</span>
          
          <code class="ruby">  def current_administrator=(administrator)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="86">
          <span class="hits">2</span>
          
          <code class="ruby">    session[:administrator] = (administrator.nil? || administrator.is_a?(Symbol)) ? nil : administrator.id</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="87">
          <span class="hits">2</span>
          
          <code class="ruby">    @current_administrator = administrator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="90">
          <span class="hits">2</span>
          
          <code class="ruby">  def store_location</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="91">
          <span class="hits">110</span>
          
          <code class="ruby">    session[:return_to] = request.fullpath</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="94">
          <span class="hits">2</span>
          
          <code class="ruby">  def redirect_back_or_default(default = root_path)</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="95">
          <span class="hits">192</span>
          
          <code class="ruby">    session[:return_to] ? redirect_to(session[:return_to]) : redirect_to(default)</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="96">
          <span class="hits">192</span>
          
          <code class="ruby">    session[:return_to] = nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">  # MAKING PDFS</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="101">
          <span class="hits">2</span>
          
          <code class="ruby">  def generate_pdf(filename = 'Download')</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">    @organisation_name = co.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">    # If wkhtmltopdf is working...</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="105">
          <span class="hits">1</span>
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">      html = render_to_string(:layout =&gt; false)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">      # Call PDFKit with any wkhtmltopdf --extended-help options</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>
          
          <code class="ruby">      kit = PDFKit.new(html, :page_size =&gt; 'A4', :header_right =&gt; 'Printed on [date]')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">      # Add our CSS file</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="112">
          <span class="hits">1</span>
          
          <code class="ruby">      kit.stylesheets &lt;&lt; &quot;#{Rails.root}/app/assets/stylesheets/pdf.css&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="114">
          <span class="hits">1</span>
          
          <code class="ruby">      send_data(kit.to_pdf, :filename =&gt; &quot;#{@organisation_name} #{filename}.pdf&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">        :type =&gt; 'application/pdf', :disposition =&gt; 'attachment')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">        # disposition: choose between attachment/inline to force download</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">    # Fail if it's not installed</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="121">
          
          
          <code class="ruby">    rescue PDFKit::NoExecutableError</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="122">
          
          
          <code class="ruby">      flash[:error] = &quot;The software for generating PDFs (wkhtmltopdf) isn't installed. \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">        Contact the maintainer of your One Click Orgs installation for help.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">      redirect_to :back</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">  # NOTIFICATIONS</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="131">
          <span class="hits">2</span>
          
          <code class="ruby">  def prepare_notifications</code>
        </li>
      
        <li class="covered" data-hits="772" data-linenumber="132">
          <span class="hits">772</span>
          
          <code class="ruby">    return unless current_user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">    # If you have a notification you want to show the user, put the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby">    # logic in here, and the template in shared/notifications.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">    # Call show_notification_once if you only want the user to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">    # see your notification once ever (e.g. a 'welcome to the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">    # system' notification).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">    # Call show_notification if it doesn't matter whether the user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">    # has seen this notification before (e.g. a 'you have a new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby">    # message' notification).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="713" data-linenumber="145">
          <span class="hits">713</span>
          
          <code class="ruby">    if co.is_a?(Association)</code>
        </li>
      
        <li class="covered" data-hits="216" data-linenumber="146">
          <span class="hits">216</span>
          
          <code class="ruby">      if co.pending? &amp;&amp; current_user.member_class.name == &quot;Founder&quot;</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="147">
          <span class="hits">26</span>
          
          <code class="ruby">        show_notification_once(:convener_welcome)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="216" data-linenumber="150">
          <span class="hits">216</span>
          
          <code class="ruby">      fap = co.found_association_proposals.last</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">      # if the organisation is pending</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">      # and the voting is finished (fap.closed)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">      # and a founding proposal exists</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">      # and is the proposal</code>
        </li>
      
        <li class="covered" data-hits="216" data-linenumber="155">
          <span class="hits">216</span>
          
          <code class="ruby">      if co.pending? &amp;&amp; fap &amp;&amp; fap.closed? &amp;&amp; !fap.accepted?</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="156">
          <span class="hits">9</span>
          
          <code class="ruby">        show_notification_once(:founding_proposal_failed, fap.close_date)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">      # Only display founding_proposal_passed notification to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">      # members who were founding members</code>
        </li>
      
        <li class="covered" data-hits="216" data-linenumber="161">
          <span class="hits">216</span>
          
          <code class="ruby">      if co.active? &amp;&amp; fap &amp;&amp; current_user.created_at &lt;= fap.creation_date</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="162">
          <span class="hits">2</span>
          
          <code class="ruby">        show_notification_once(:founding_proposal_passed)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">  # Show a one-off notification to a user, to notify of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">  # a specific event happening.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">  # With #show_notification_once, a notification of a given type (e.g. a 'convener_welcome' notification) will only be shown once</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby">  # to a given user. If you want to show the notification regardless of whether the user has already seen it before,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">  # use #show_notification instead.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">  # As an exception to this, you can pass the ignore_earlier_than parameter. If this user has seen this type of notification</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">  # earlier than the timestamp you pass, the notification will be shown again.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">  # @param [Symbol] notification the notification type, `:founding_proposal_passed` or `:founding_proposal_failed`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">  # @param [optional, Timestamp] ignore seen-notifications earlier than this time</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby">  # @return [String] notification the string relating to the kind of notification `founding_proposal_passed`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">  # @example Show a notification a user once that their proposal failed, allowing us to render the partial 'founding_proposal_failed' in the view</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">  #   show_notification_once(:founding_proposal_failed)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="184">
          <span class="hits">2</span>
          
          <code class="ruby">  def show_notification_once(notification, ignore_earlier_than = nil)</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="185">
          <span class="hits">36</span>
          
          <code class="ruby">    return unless current_user</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="186">
          <span class="hits">36</span>
          
          <code class="ruby">    return if current_user.has_seen_notification?(notification, ignore_earlier_than)</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="187">
          <span class="hits">25</span>
          
          <code class="ruby">    show_notification(notification)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="190">
          <span class="hits">2</span>
          
          <code class="ruby">  def show_notification(notification)</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="191">
          <span class="hits">25</span>
          
          <code class="ruby">    @notification = notification</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby">  # ANALYTICS</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="196">
          <span class="hits">2</span>
          
          <code class="ruby">  def track_analytics_event(event_name, options={})</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="197">
          <span class="hits">9</span>
          
          <code class="ruby">    return unless Rails.env.production? &amp;&amp; OneClickOrgs::GoogleAnalytics.active?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="198">
          
          
          <code class="ruby">    if options[:now]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="199">
          
          
          <code class="ruby">      @analytics_events ||= []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="200">
          
          
          <code class="ruby">      @analytics_events.push(event_name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="202">
          
          
          <code class="ruby">      session[:analytics_events] ||= []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="203">
          
          
          <code class="ruby">      session[:analytics_events].push(event_name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="207">
          <span class="hits">2</span>
          
          <code class="ruby">  def load_analytics_events_from_session</code>
        </li>
      
        <li class="covered" data-hits="1133" data-linenumber="208">
          <span class="hits">1133</span>
          
          <code class="ruby">    return unless Rails.env.production? &amp;&amp; OneClickOrgs::GoogleAnalytics.active?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="209">
          
          
          <code class="ruby">    unless session[:analytics_events].blank?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="210">
          
          
          <code class="ruby">      @analytics_events ||= []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="211">
          
          
          <code class="ruby">      session[:analytics_events].dup.each do |event|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="212">
          
          
          <code class="ruby">        @analytics_events.push(event)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="213">
          
          
          <code class="ruby">        session[:analytics_events].delete(event)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="218">
          <span class="hits">2</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">  # BEFORE FILTER DEFINITIONS</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="222">
          <span class="hits">2</span>
          
          <code class="ruby">  def ensure_set_up</code>
        </li>
      
        <li class="covered" data-hits="996" data-linenumber="223">
          <span class="hits">996</span>
          
          <code class="ruby">    unless OneClickOrgs::Setup.complete?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="224">
          <span class="hits">2</span>
          
          <code class="ruby">      redirect_to(:controller =&gt; 'setup')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="228">
          <span class="hits">2</span>
          
          <code class="ruby">  def ensure_organisation_exists</code>
        </li>
      
        <li class="covered" data-hits="1158" data-linenumber="229">
          <span class="hits">1158</span>
          
          <code class="ruby">    unless current_organisation</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="230">
          <span class="hits">7</span>
          
          <code class="ruby">      redirect_to(new_organisation_url(host_and_port(Setting[:signup_domain])))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="234">
          <span class="hits">2</span>
          
          <code class="ruby">  def ensure_authenticated</code>
        </li>
      
        <li class="covered" data-hits="821" data-linenumber="235">
          <span class="hits">821</span>
          
          <code class="ruby">    if user_logged_in?</code>
        </li>
      
        <li class="covered" data-hits="714" data-linenumber="236">
          <span class="hits">714</span>
          
          <code class="ruby">      true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="107" data-linenumber="238">
          <span class="hits">107</span>
          
          <code class="ruby">      raise Unauthenticated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="242">
          <span class="hits">2</span>
          
          <code class="ruby">  def ensure_member_active_or_pending</code>
        </li>
      
        <li class="covered" data-hits="795" data-linenumber="243">
          <span class="hits">795</span>
          
          <code class="ruby">    if current_user &amp;&amp; current_user.inactive?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="244">
          <span class="hits">1</span>
          
          <code class="ruby">      session[:user] = nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="245">
          <span class="hits">1</span>
          
          <code class="ruby">      raise Unauthenticated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="249">
          <span class="hits">2</span>
          
          <code class="ruby">  def ensure_member_inducted</code>
        </li>
      
        <li class="covered" data-hits="792" data-linenumber="250">
          <span class="hits">792</span>
          
          <code class="ruby">    case co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby">    when Association</code>
        </li>
      
        <li class="covered" data-hits="233" data-linenumber="252">
          <span class="hits">233</span>
          
          <code class="ruby">      redirect_to_welcome_member if co.active? &amp;&amp; current_user &amp;&amp; !current_user.inducted?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="256">
          <span class="hits">2</span>
          
          <code class="ruby">  def ensure_administrator_authenticated</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="257">
          <span class="hits">8</span>
          
          <code class="ruby">    if administrator_logged_in?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="258">
          <span class="hits">6</span>
          
          <code class="ruby">      true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="260">
          <span class="hits">2</span>
          
          <code class="ruby">      raise UnauthenticatedAdministrator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="264">
          <span class="hits">2</span>
          
          <code class="ruby">  def ensure_administration_subdomain</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="265">
          <span class="hits">10</span>
          
          <code class="ruby">    if request.host_with_port == Setting[:signup_domain]</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="266">
          <span class="hits">10</span>
          
          <code class="ruby">      true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="268">
          
          
          <code class="ruby">      redirect_to(new_organisation_url(host_and_port(Setting[:signup_domain])))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="272">
          <span class="hits">2</span>
          
          <code class="ruby">  def redirect_to_welcome_member</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="273">
          <span class="hits">2</span>
          
          <code class="ruby">    redirect_to(:controller =&gt; 'welcome', :action =&gt; 'index')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="275">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="276">
          <span class="hits">2</span>
          
          <code class="ruby">  def find_constitution</code>
        </li>
      
        <li class="covered" data-hits="67" data-linenumber="277">
          <span class="hits">67</span>
          
          <code class="ruby">    @constitution = co.constitution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="278">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="279">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="280">
          <span class="hits">2</span>
          
          <code class="ruby">  def host_and_port(domain)</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="281">
          <span class="hits">28</span>
          
          <code class="ruby">    host, port = domain.split(':')</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="282">
          <span class="hits">28</span>
          
          <code class="ruby">    if port</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="283">
          <span class="hits">1</span>
          
          <code class="ruby">      {:host =&gt; host, :port =&gt; port}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="285">
          <span class="hits">27</span>
          
          <code class="ruby">      {:host =&gt; host}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="289">
          
          
          <code class="ruby">  # EXCEPTION HANDLING</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="291">
          <span class="hits">2</span>
          
          <code class="ruby">  rescue_from NotFound, :with =&gt; :render_404</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="292">
          <span class="hits">2</span>
          
          <code class="ruby">  rescue_from ActiveRecord::RecordNotFound, :with =&gt; :render_404</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="293">
          <span class="hits">2</span>
          
          <code class="ruby">  def render_404</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="294">
          <span class="hits">3</span>
          
          <code class="ruby">    render :file =&gt; &quot;#{Rails.root}/public/404&quot;, :status =&gt; 404, :layout =&gt; false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="297">
          <span class="hits">2</span>
          
          <code class="ruby">  rescue_from Unauthenticated, :with =&gt; :handle_unauthenticated</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="298">
          <span class="hits">2</span>
          
          <code class="ruby">  def handle_unauthenticated</code>
        </li>
      
        <li class="covered" data-hits="108" data-linenumber="299">
          <span class="hits">108</span>
          
          <code class="ruby">    store_location</code>
        </li>
      
        <li class="covered" data-hits="108" data-linenumber="300">
          <span class="hits">108</span>
          
          <code class="ruby">    redirect_to login_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="303">
          <span class="hits">2</span>
          
          <code class="ruby">  rescue_from UnauthenticatedAdministrator, :with =&gt; :handle_unauthenticated_administrator</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="304">
          <span class="hits">2</span>
          
          <code class="ruby">  def handle_unauthenticated_administrator</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="305">
          <span class="hits">2</span>
          
          <code class="ruby">    store_location</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="306">
          <span class="hits">2</span>
          
          <code class="ruby">    redirect_to admin_login_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="307">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="309">
          <span class="hits">2</span>
          
          <code class="ruby">  rescue_from CanCan::AccessDenied do |exception|</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="310">
          <span class="hits">5</span>
          
          <code class="ruby">    flash[:error] = exception.message</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="311">
          <span class="hits">5</span>
          
          <code class="ruby">    redirect_to root_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="312">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="313">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby">  # ORGANISATION RESOLVER</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="316">
          
          
          <code class="ruby">  # Configures the controller's view context to use an</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby">  # OrganisationResolver based on the given organisation's class when</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="318">
          
          
          <code class="ruby">  # resolving (looking up) template paths.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="319">
          <span class="hits">2</span>
          
          <code class="ruby">  def install_organisation_resolver(organisation)</code>
        </li>
      
        <li class="covered" data-hits="986" data-linenumber="320">
          <span class="hits">986</span>
          
          <code class="ruby">    view_paths.dup.each do |view_path|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="321">
          
          
          <code class="ruby">      prepend_view_path(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby">        OneClickOrgs::OrganisationResolver.new(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="323">
          
          
          <code class="ruby">          view_path.to_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="324">
          
          
          <code class="ruby">          organisation.class</code>
        </li>
      
        <li class="covered" data-hits="986" data-linenumber="325">
          <span class="hits">986</span>
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="326">
          
          
          <code class="ruby">      )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="328">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a998656920b58a122cf37ae3e7f1f9db1057ec79">
  <div class="header">
    <h3>app/controllers/associations_controller.rb</h3>
    <h4><span class="red">79.07 %</span> covered</h4>
    <div>
      <b>43</b> relevant lines. 
      <span class="green"><b>34</b> lines covered</span> and
      <span class="red"><b>9</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class AssociationsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_organisation_exists</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_authenticated</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_member_active_or_pending</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_member_inducted</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  before_filter :ensure_no_overwrite_in_single_organisation_mode</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  layout &quot;setup&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="12">
          <span class="hits">4</span>
          
          <code class="ruby">    @association = Association.new</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="13">
          <span class="hits">4</span>
          
          <code class="ruby">    @founder = @association.members.first || @association.members.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    # Require acceptance of the terms and conditions</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="16">
          <span class="hits">4</span>
          
          <code class="ruby">    @founder.terms_and_conditions = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    #@single_organisation_mode = Setting[:single_organisation_mode]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="22">
          <span class="hits">3</span>
          
          <code class="ruby">    @association = Association.new(params[:association])</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="23">
          <span class="hits">3</span>
          
          <code class="ruby">    @founder = Member.new(params[:founder])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="25">
          <span class="hits">3</span>
          
          <code class="ruby">    errors = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    # validate</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="28">
          <span class="hits">3</span>
          
          <code class="ruby">    if !@founder.valid?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">      errors &lt;&lt; &quot;Please complete your account details: #{@founder.errors.full_messages.to_sentence}.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="31">
          <span class="hits">3</span>
          
          <code class="ruby">    if @founder.password != params[:founder][:password_confirmation]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">      errors &lt;&lt; &quot;Your password and password confirmation do not match.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="34">
          <span class="hits">3</span>
          
          <code class="ruby">    if !@association.valid?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">      errors &lt;&lt; &quot;Please complete the details of your organisation: #{@association.errors.full_messages.to_sentence}.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    end   </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">    # validation succeeded -&gt; store</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="39">
          <span class="hits">3</span>
          
          <code class="ruby">    if errors.size == 0</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="40">
          <span class="hits">3</span>
          
          <code class="ruby">      @association.members &lt;&lt; @founder</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="41">
          <span class="hits">3</span>
          
          <code class="ruby">      if !@association.save</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">        errors &lt;&lt; &quot;Cannot create your organisation: #{@association.errors.full_messages.to_sentence}.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="45">
          <span class="hits">3</span>
          
          <code class="ruby">      @founder.member_class = @association.member_classes.find_by_name('Founder')</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="46">
          <span class="hits">3</span>
          
          <code class="ruby">      if !@founder.save</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">        errors &lt;&lt; &quot;Cannot create your account: #{@founder.errors.full_messages.to_sentence}.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">    # display errors</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="52">
          <span class="hits">3</span>
          
          <code class="ruby">    if errors.size &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">      flash[:error] = errors.join(&quot;\n&quot;) # don't want to insert &lt;br&gt;s here</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">      render :action =&gt; 'new'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">    # continue</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="59">
          <span class="hits">3</span>
          
          <code class="ruby">    log_in(@founder)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="61">
          <span class="hits">3</span>
          
          <code class="ruby">    MembersMailer.welcome_founder(@founder).deliver # send welcome email    </code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="62">
          <span class="hits">3</span>
          
          <code class="ruby">    current_user.update_attribute(:last_logged_in_at, Time.now.utc) # update login datetime</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="64">
          <span class="hits">3</span>
          
          <code class="ruby">    track_analytics_event('EntersPendingStage')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="66">
          <span class="hits">3</span>
          
          <code class="ruby">    if Setting[:single_organisation_mode]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">      redirect_to(constitution_path)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="69">
          <span class="hits">3</span>
          
          <code class="ruby">      redirect_to(constitution_url(host_and_port(@association.host)))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="73">
          <span class="hits">2</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  # In single organisation mode, you need a guard to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  # stop being able to overwrite information about an</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  # organisation once it's first been created.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="77">
          <span class="hits">2</span>
          
          <code class="ruby">  def ensure_no_overwrite_in_single_organisation_mode</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="78">
          <span class="hits">8</span>
          
          <code class="ruby">    if Setting[:single_organisation_mode] == &quot;true&quot; &amp;&amp; Organisation.count &gt; 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">      redirect_to root_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ad1694d41c8b9275548620d72eac5870b8330f8e">
  <div class="header">
    <h3>app/controllers/ballots_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>15</b> relevant lines. 
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class BallotsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="3">
          <span class="hits">7</span>
          
          <code class="ruby">    find_election</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="4">
          <span class="hits">7</span>
          
          <code class="ruby">    @ballot = @election.ballots.build</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="5">
          <span class="hits">7</span>
          
          <code class="ruby">    @nominations = @election.nominations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="9">
          <span class="hits">6</span>
          
          <code class="ruby">    find_election</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="10">
          <span class="hits">6</span>
          
          <code class="ruby">    @ballot = @election.ballots.build(params[:ballot])</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="11">
          <span class="hits">6</span>
          
          <code class="ruby">    @ballot.member = current_user</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="12">
          <span class="hits">6</span>
          
          <code class="ruby">    @ballot.save!</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="13">
          <span class="hits">6</span>
          
          <code class="ruby">    flash[:notice] = &quot;Your vote has been cast.&quot;</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="14">
          <span class="hits">6</span>
          
          <code class="ruby">    redirect_to root_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">  def find_election</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="20">
          <span class="hits">13</span>
          
          <code class="ruby">    @election = co.elections.find(params[:election_id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="81caa65cf344657a93d93d00554440be636f8e7b">
  <div class="header">
    <h3>app/controllers/board_meetings_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines. 
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class BoardMeetingsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="3">
          <span class="hits">4</span>
          
          <code class="ruby">    @board_meeting = co.board_meetings.build</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="7">
          <span class="hits">5</span>
          
          <code class="ruby">    @board_meeting = co.board_meetings.build(params[:board_meeting])</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="8">
          <span class="hits">5</span>
          
          <code class="ruby">    @board_meeting.creator = current_user</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="9">
          <span class="hits">5</span>
          
          <code class="ruby">    @board_meeting.save!</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="10">
          <span class="hits">5</span>
          
          <code class="ruby">    redirect_to meetings_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="41ba8e9a78c7369589e32145cdc4251b65dc16bf">
  <div class="header">
    <h3>app/controllers/board_resolutions_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines. 
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class BoardResolutionsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="3">
          <span class="hits">4</span>
          
          <code class="ruby">    @board_resolution = co.board_resolutions.build</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="7">
          <span class="hits">6</span>
          
          <code class="ruby">    @board_resolution = co.board_resolutions.build(params[:board_resolution])</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="8">
          <span class="hits">6</span>
          
          <code class="ruby">    @board_resolution.proposer = current_user</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="9">
          <span class="hits">6</span>
          
          <code class="ruby">    @board_resolution.save!</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="10">
          <span class="hits">6</span>
          
          <code class="ruby">    redirect_to proposals_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="2be4db27933558cd021b343d45611807111f8d98">
  <div class="header">
    <h3>app/controllers/change_meeting_notice_period_resolutions_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ChangeMeetingNoticePeriodResolutionsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="3">
          <span class="hits">6</span>
          
          <code class="ruby">    @change_meeting_notice_period_resolution = co.change_meeting_notice_period_resolutions.build</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="7">
          <span class="hits">13</span>
          
          <code class="ruby">    @change_meeting_notice_period_resolution = co.change_meeting_notice_period_resolutions.build(params[:change_meeting_notice_period_resolution])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="9">
          <span class="hits">13</span>
          
          <code class="ruby">    @change_meeting_notice_period_resolution.proposer = current_user</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="10">
          <span class="hits">13</span>
          
          <code class="ruby">    @change_meeting_notice_period_resolution.draft = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="12">
          <span class="hits">13</span>
          
          <code class="ruby">    @change_meeting_notice_period_resolution.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="14">
          <span class="hits">13</span>
          
          <code class="ruby">    if @change_meeting_notice_period_resolution.accepted?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="15">
          <span class="hits">3</span>
          
          <code class="ruby">      flash[:notice] = &quot;The notice period for General Meetings has been changed.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="17">
          <span class="hits">10</span>
          
          <code class="ruby">      if @change_meeting_notice_period_resolution.notice_period_increased?</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="18">
          <span class="hits">8</span>
          
          <code class="ruby">        flash[:notice] = &quot;A draft resolution to increase the General Meeting notice period has been created.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">        flash[:notice] = &quot;A draft resolution to decrease the General Meeting notice period has been created.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="24">
          <span class="hits">13</span>
          
          <code class="ruby">    redirect_to meetings_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3f09196d66564b2d72da592b57371318795e0eee">
  <div class="header">
    <h3>app/controllers/change_member_class_proposals_controller.rb</h3>
    <h4><span class="red">80.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines. 
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ChangeMemberClassProposalsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="3">
          <span class="hits">6</span>
          
          <code class="ruby">    authorize! :create, ChangeMemberClassProposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    # TODO Make this work</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="6">
          <span class="hits">6</span>
          
          <code class="ruby">    @change_member_class_proposal = co.change_member_class_proposals.build(params[:change_member_class_proposal])</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="7">
          <span class="hits">6</span>
          
          <code class="ruby">    @change_member_class_proposal.proposer = current_user</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="8">
          <span class="hits">6</span>
          
          <code class="ruby">    if @change_member_class_proposal.save</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="9">
          <span class="hits">6</span>
          
          <code class="ruby">      flash[:notice] = &quot;Membership class proposal successfully created&quot;</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="10">
          <span class="hits">6</span>
          
          <code class="ruby">      redirect_to(member_path(@change_member_class_proposal.member))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">      # TODO Use a render instead of redirect, so we can preserve the entered</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">      # form details, and use error_messages_for to present errors better.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">      flash[:error] = &quot;Error creating proposal: #{@change_member_class_proposal.errors.inspect}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">      redirect_back_or_default(member_path(@change_member_class_proposal.member))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="42382a88155c76c5e17e7bc5f99879384b4abd23">
  <div class="header">
    <h3>app/controllers/change_quorum_resolutions_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines. 
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ChangeQuorumResolutionsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="3">
          <span class="hits">5</span>
          
          <code class="ruby">    @change_quorum_resolution = co.change_quorum_resolutions.build</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="7">
          <span class="hits">8</span>
          
          <code class="ruby">    @change_quorum_resolution = co.change_quorum_resolutions.build(params[:change_quorum_resolution])</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="8">
          <span class="hits">8</span>
          
          <code class="ruby">    @change_quorum_resolution.proposer = current_user</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="9">
          <span class="hits">8</span>
          
          <code class="ruby">    @change_quorum_resolution.draft = true</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="10">
          <span class="hits">8</span>
          
          <code class="ruby">    @change_quorum_resolution.save!</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="11">
          <span class="hits">8</span>
          
          <code class="ruby">    flash[:notice] = &quot;A draft resolution to change the General Meeting quorum has been created.&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="12">
          <span class="hits">8</span>
          
          <code class="ruby">    redirect_to meetings_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ba4373a8d13d83e820fbe2e0cdea160d5da38561">
  <div class="header">
    <h3>app/controllers/comments_controller.rb</h3>
    <h4><span class="red">65.0 %</span> covered</h4>
    <div>
      <b>20</b> relevant lines. 
      <span class="green"><b>13</b> lines covered</span> and
      <span class="red"><b>7</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class CommentsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3">
          <span class="hits">14</span>
          
          <code class="ruby">    @commentable = if params[:proposal_id]</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="4">
          <span class="hits">8</span>
          
          <code class="ruby">      co.proposals.find(params[:proposal_id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    elsif params[:meeting_id]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="6">
          <span class="hits">6</span>
          
          <code class="ruby">      co.meetings.find(params[:meeting_id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    elsif params[:resolution_id]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">      co.resolutions.find(params[:resolution_id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    elsif params[:resolution_proposal_id]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">      co.resolution_proposals.find(params[:resolution_proposal_id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="13">
          <span class="hits">14</span>
          
          <code class="ruby">    unless @commentable</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">      redirect_to :back</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="18">
          <span class="hits">14</span>
          
          <code class="ruby">    @comment = @commentable.comments.build(params[:comment])</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="19">
          <span class="hits">14</span>
          
          <code class="ruby">    @comment.author = current_user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="21">
          <span class="hits">14</span>
          
          <code class="ruby">    commentable_path = case @commentable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    when Resolution</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">      resolution_path(@commentable)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    when ResolutionProposal</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">      resolution_proposal_path(@commentable)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    when Proposal</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="27">
          <span class="hits">8</span>
          
          <code class="ruby">      proposal_path(@commentable)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="29">
          <span class="hits">6</span>
          
          <code class="ruby">      url_for(@commentable)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="32">
          <span class="hits">14</span>
          
          <code class="ruby">    if @comment.save</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="33">
          <span class="hits">14</span>
          
          <code class="ruby">      redirect_to(commentable_path, :notice =&gt; &quot;Comment added.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">      # TODO Use render instead of redirect; use error_messages_for.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">      redirect_to(commentable_path, :error =&gt; &quot;There was a problem saving your comment.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="dbc30f5399f93d791d5fdfca4c41845a7c96d71a">
  <div class="header">
    <h3>app/controllers/companies_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>18</b> relevant lines. 
      <span class="green"><b>18</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class CompaniesController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_organisation_exists</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_authenticated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  layout 'setup'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="8">
          <span class="hits">8</span>
          
          <code class="ruby">    @member = Member.new</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="9">
          <span class="hits">8</span>
          
          <code class="ruby">    @company = Company.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="13">
          <span class="hits">14</span>
          
          <code class="ruby">    @company = Company.new(params[:company])</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="14">
          <span class="hits">14</span>
          
          <code class="ruby">    @member = @company.members.build(params[:member])</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="15">
          <span class="hits">14</span>
          
          <code class="ruby">    @member.state = 'active'</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="16">
          <span class="hits">14</span>
          
          <code class="ruby">    if @company.valid? &amp;&amp; @member.valid?</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="17">
          <span class="hits">10</span>
          
          <code class="ruby">      @company.save!</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="18">
          <span class="hits">10</span>
          
          <code class="ruby">      @member.member_class = @company.member_classes.find_by_name('Director')</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="19">
          <span class="hits">10</span>
          
          <code class="ruby">      @member.save!</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="20">
          <span class="hits">10</span>
          
          <code class="ruby">      log_in(@member)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="21">
          <span class="hits">10</span>
          
          <code class="ruby">      redirect_to root_url(host_and_port(@company.host))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="23">
          <span class="hits">4</span>
          
          <code class="ruby">      render :action =&gt; 'new'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a039cd110a59e3f87eb89f710a9a24178923a81e">
  <div class="header">
    <h3>app/controllers/constitution_proposal_bundles_controller.rb</h3>
    <h4><span class="yellow">85.71 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ConstitutionProposalBundlesController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="3">
          <span class="hits">21</span>
          
          <code class="ruby">    authorize! :create, ConstitutionProposalBundle</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="5">
          <span class="hits">18</span>
          
          <code class="ruby">    @constitution_proposal_bundle = co.build_constitution_proposal_bundle(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">      params[:constitution_proposal_bundle]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    )</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="8">
          <span class="hits">18</span>
          
          <code class="ruby">    @constitution_proposal_bundle.proposer = current_user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="10">
          <span class="hits">18</span>
          
          <code class="ruby">    if @constitution_proposal_bundle.save</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="11">
          <span class="hits">18</span>
          
          <code class="ruby">      case co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">      when Coop</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="13">
          <span class="hits">3</span>
          
          <code class="ruby">        notice = if can?(:create, Resolution)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">          &quot;Draft resolutions successfully created&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">        elsif can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">          &quot;Your suggestions have been sent&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="18">
          <span class="hits">3</span>
          
          <code class="ruby">        redirect_to(proposals_path, :notice =&gt; notice)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="20">
          <span class="hits">15</span>
          
          <code class="ruby">        redirect_to(root_path, :notice =&gt; &quot;Constitutional amendment proposals successfully created&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">      flash.now[:error] = &quot;There was a problem with your amendments: #{@constitution_proposal_bundle.errors.full_messages.to_sentence}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">      edit_constitution_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3c8678e3e7b66407c584ddc767820f202a96b462">
  <div class="header">
    <h3>app/controllers/constitutions_controller.rb</h3>
    <h4><span class="yellow">86.21 %</span> covered</h4>
    <div>
      <b>29</b> relevant lines. 
      <span class="green"><b>25</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ConstitutionsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  before_filter :find_constitution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def show</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="5">
          <span class="hits">30</span>
          
          <code class="ruby">    @page_title = &quot;Constitution&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="7">
          <span class="hits">30</span>
          
          <code class="ruby">    respond_to do |format|</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="8">
          <span class="hits">30</span>
          
          <code class="ruby">      format.html</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="9">
          <span class="hits">30</span>
          
          <code class="ruby">      format.pdf {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">        generate_pdf(@page_title)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">  def edit</code>
        </li>
      
        <li class="covered" data-hits="33" data-linenumber="16">
          <span class="hits">33</span>
          
          <code class="ruby">    @page_title = &quot;Amendments&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="33" data-linenumber="18">
          <span class="hits">33</span>
          
          <code class="ruby">    case co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    when Association</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="20">
          <span class="hits">26</span>
          
          <code class="ruby">      @allow_editing = can?(:update, Constitution) || can?(:create, ConstitutionProposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="22">
          <span class="hits">26</span>
          
          <code class="ruby">      if can?(:update, Constitution)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="23">
          <span class="hits">9</span>
          
          <code class="ruby">        @constitution_wrapper = ConstitutionWrapper.new(:constitution =&gt; @constitution)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="25">
          <span class="hits">17</span>
          
          <code class="ruby">        @constitution_proposal_bundle = co.build_constitution_proposal_bundle</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    when Coop</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="28">
          <span class="hits">7</span>
          
          <code class="ruby">      if can?(:update, Constitution)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">        @allow_editing = true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">        @constitution_wrapper = ConstitutionWrapper.new(:constitution =&gt; @constitution)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="31">
          <span class="hits">6</span>
          
          <code class="ruby">      elsif can?(:create, Resolution) || can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="32">
          <span class="hits">6</span>
          
          <code class="ruby">        @allow_editing = true</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="33">
          <span class="hits">6</span>
          
          <code class="ruby">        @constitution_proposal_bundle = co.build_constitution_proposal_bundle</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">  def update</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="39">
          <span class="hits">2</span>
          
          <code class="ruby">    authorize! :update, Constitution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">    @constitution_wrapper = ConstitutionWrapper.new(:constitution =&gt; @constitution)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>
          
          <code class="ruby">    if @constitution_wrapper.update_attributes(params[:constitution])</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="43">
          <span class="hits">2</span>
          
          <code class="ruby">      redirect_to(constitution_path, :notice =&gt; &quot;Constitutional changes were made&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">      @page_title = &quot;Amendments&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">      @allow_editing = true # We have already authorized that the user can update a Constitution</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">      render(:action =&gt; :edit)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="edbfd2a53d9a8f8d35e9cac02717f72d937963b0">
  <div class="header">
    <h3>app/controllers/coops_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines. 
      <span class="green"><b>24</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class CoopsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_organisation_exists</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_authenticated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  layout &quot;setup&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="8">
          <span class="hits">6</span>
          
          <code class="ruby">    @member = Member.new</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="9">
          <span class="hits">6</span>
          
          <code class="ruby">    @coop = Coop.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="13">
          <span class="hits">8</span>
          
          <code class="ruby">    @coop = Coop.new(params[:coop])</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="14">
          <span class="hits">8</span>
          
          <code class="ruby">    @member = @coop.members.build(params[:member])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="16">
          <span class="hits">8</span>
          
          <code class="ruby">    @coop.save!</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="17">
          <span class="hits">8</span>
          
          <code class="ruby">    @member.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="19">
          <span class="hits">8</span>
          
          <code class="ruby">    @member.member_class = @coop.member_classes.find_by_name(&quot;Founder Member&quot;)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="20">
          <span class="hits">8</span>
          
          <code class="ruby">    @member.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="22">
          <span class="hits">8</span>
          
          <code class="ruby">    @member.induct!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="24">
          <span class="hits">8</span>
          
          <code class="ruby">    st = ShareTransaction.create(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">      :to_account =&gt; @member.find_or_create_share_account,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      :from_account =&gt; @coop.share_account,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">      :amount =&gt; 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    )</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="29">
          <span class="hits">8</span>
          
          <code class="ruby">    st.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="31">
          <span class="hits">8</span>
          
          <code class="ruby">    log_in(@member)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="33">
          <span class="hits">8</span>
          
          <code class="ruby">    redirect_to root_url(host_and_port(@coop.host))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="36">
          <span class="hits">2</span>
          
          <code class="ruby">  def propose</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">    @coop = Coop.find(params[:id])</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">    authorize! :edit, @coop</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">    @coop.propose!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">    redirect_to :back</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="7d8eaed1c6901b06167ac0d6ed1c9593bdb15d6f">
  <div class="header">
    <h3>app/controllers/decisions_controller.rb</h3>
    <h4><span class="red">50.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class DecisionsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def show</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3">
          
          
          <code class="ruby">    decision = co.decisions.find(params[:id])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4">
          
          
          <code class="ruby">    redirect_to proposal_path(decision.proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="60485d7da56f330f223c198f7b1298e874e46c4c">
  <div class="header">
    <h3>app/controllers/directors_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>21</b> relevant lines. 
      <span class="green"><b>21</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class DirectorsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def index</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="3">
          <span class="hits">21</span>
          
          <code class="ruby">    @directors = co.directors</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="4">
          <span class="hits">21</span>
          
          <code class="ruby">    @offices = co.offices</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="6">
          <span class="hits">21</span>
          
          <code class="ruby">    @tasks = current_user.tasks.current.directors_related</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="10">
          <span class="hits">9</span>
          
          <code class="ruby">    if can?(:create, Director)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="11">
          <span class="hits">8</span>
          
          <code class="ruby">      @director = co.build_director(params[:director])</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="12">
          <span class="hits">8</span>
          
          <code class="ruby">      @director.send_welcome = true</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="13">
          <span class="hits">8</span>
          
          <code class="ruby">      if @director.save</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="14">
          <span class="hits">6</span>
          
          <code class="ruby">        @director.send_new_director_notifications</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">        flash[:error] = &quot;There was a problem saving the new director.&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">        render :action =&gt; 'new'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">        return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="22">
          <span class="hits">7</span>
          
          <code class="ruby">    redirect_to members_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">  def stand_down</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="26">
          <span class="hits">6</span>
          
          <code class="ruby">    @director = co.directors.find(params[:id])</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="27">
          <span class="hits">6</span>
          
          <code class="ruby">    @director.update_attributes(params[:director])</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="28">
          <span class="hits">6</span>
          
          <code class="ruby">    @director.eject!</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="29">
          <span class="hits">6</span>
          
          <code class="ruby">    @director.send_stand_down_notification_emails</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="30">
          <span class="hits">6</span>
          
          <code class="ruby">    redirect_to members_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="d98d496ad5b1a992d6db711bbfe50169896038e4">
  <div class="header">
    <h3>app/controllers/directorships_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class DirectorshipsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="3">
          <span class="hits">4</span>
          
          <code class="ruby">    @directorship = co.directorships.build(:elected_on =&gt; Date.today)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="7">
          <span class="hits">5</span>
          
          <code class="ruby">    @directorship = co.directorships.build(params[:directorship])</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="8">
          <span class="hits">5</span>
          
          <code class="ruby">    @directorship.save!</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="9">
          <span class="hits">5</span>
          
          <code class="ruby">    redirect_to directors_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def edit</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="13">
          <span class="hits">4</span>
          
          <code class="ruby">    @directorship = co.directorships.find(params[:id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">  def update</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="17">
          <span class="hits">5</span>
          
          <code class="ruby">    @directorship = co.directorships.find(params[:id])</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="18">
          <span class="hits">5</span>
          
          <code class="ruby">    @directorship.update_attributes(params[:directorship])</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="19">
          <span class="hits">5</span>
          
          <code class="ruby">    @directorship.save!</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="20">
          <span class="hits">5</span>
          
          <code class="ruby">    redirect_to directors_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="89e31e2d6766572ee924a6d4f213cd2f88e89f73">
  <div class="header">
    <h3>app/controllers/eject_member_proposals_controller.rb</h3>
    <h4><span class="red">80.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines. 
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class EjectMemberProposalsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="3">
          <span class="hits">3</span>
          
          <code class="ruby">    authorize! :create, EjectMemberProposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="5">
          <span class="hits">3</span>
          
          <code class="ruby">    @eject_member_proposal = co.eject_member_proposals.build(params[:eject_member_proposal])</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="6">
          <span class="hits">3</span>
          
          <code class="ruby">    @eject_member_proposal.proposer = current_user</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="7">
          <span class="hits">3</span>
          
          <code class="ruby">    if @eject_member_proposal.save</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="8">
          <span class="hits">3</span>
          
          <code class="ruby">      flash[:notice] = &quot;Ejection proposal successfully created&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="9">
          <span class="hits">3</span>
          
          <code class="ruby">      redirect_to root_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">      flash.now[:error] = &quot;Error creating proposal&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">      render :action =&gt; :new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="63bede61845d88e2665194aa7bc2bbf25a781d44">
  <div class="header">
    <h3>app/controllers/found_association_proposals_controller.rb</h3>
    <h4><span class="yellow">84.62 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class FoundAssociationProposalsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3">
          
          
          <code class="ruby">    authorize! :create, FoundAssociationProposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">    authorize! :create, FoundAssociationProposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">    found_association_proposal_parameters = params[:found_association_proposal] || {}</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">    found_association_proposal = co.found_association_proposals.build(found_association_proposal_parameters)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">    found_association_proposal.proposer = current_user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">    if found_association_proposal.save</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">      co.propose!</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">      track_analytics_event('StartsFoundingVote')</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">      redirect_to(root_path, :notice =&gt; &quot;The founding vote has now begun.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">      # TODO Render instead of redirect; use error_messages_for.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">      redirect_to(constitution_path, :flash =&gt; {:error =&gt; &quot;Error creating proposal: #{proposal.errors.inspect}&quot;})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="7c29c3a5f875bd1ce400ce54deccf36ccc5db8dd">
  <div class="header">
    <h3>app/controllers/founder_members_controller.rb</h3>
    <h4><span class="red">69.23 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class FounderMembersController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3">
          
          
          <code class="ruby">    authorize! :create, FounderMember</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    @founder_member = co.build_founder_member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    authorize! :create, FounderMember</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">    @founder_member = co.build_founder_member(params[:founder_member])</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">    @founder_member.send_welcome = true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">    if @founder_member.save</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">      flash[:notice] = &quot;Added a new founder member&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">      redirect_to members_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">      flash[:error] = &quot;There was a problem with the new member's details&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">      render :action =&gt; :new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="6b15b5ddaba231c65c03976411f5047f3b71d8b1">
  <div class="header">
    <h3>app/controllers/founding_members_controller.rb</h3>
    <h4><span class="yellow">85.71 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class FoundingMembersController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3">
          
          
          <code class="ruby">    authorize! :create, FoundingMember</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    @founding_member = co.build_founding_member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="9">
          <span class="hits">8</span>
          
          <code class="ruby">    authorize! :create, FoundingMember</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="11">
          <span class="hits">8</span>
          
          <code class="ruby">    @founding_member = co.build_founding_member(params[:founding_member])</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="12">
          <span class="hits">8</span>
          
          <code class="ruby">    @founding_member.send_welcome = true</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="13">
          <span class="hits">8</span>
          
          <code class="ruby">    if @founding_member.save</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="14">
          <span class="hits">4</span>
          
          <code class="ruby">      track_analytics_event('InvitesFoundingMember')</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="15">
          <span class="hits">4</span>
          
          <code class="ruby">      flash[:notice] = &quot;Added a new founding member&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="16">
          <span class="hits">4</span>
          
          <code class="ruby">      redirect_to members_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="18">
          <span class="hits">4</span>
          
          <code class="ruby">      flash[:error] = &quot;There was a problem with the new member's details&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="19">
          <span class="hits">4</span>
          
          <code class="ruby">      render :action =&gt; :new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="139fe03719996788b974ad3b75b4ee11ef46d91a">
  <div class="header">
    <h3>app/controllers/general_meetings_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>20</b> relevant lines. 
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class GeneralMeetingsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="3">
          <span class="hits">12</span>
          
          <code class="ruby">    @general_meeting = co.general_meetings.build</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="5">
          <span class="hits">12</span>
          
          <code class="ruby">    @draft_resolutions = co.resolutions.draft</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="6">
          <span class="hits">12</span>
          
          <code class="ruby">    if params[:resolution_id].present?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">      @draft_resolutions.find_by_id(params[:resolution_id]).try(:attached=, '1')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="10">
          <span class="hits">12</span>
          
          <code class="ruby">    @directors_retiring = co.directors_retiring</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="14">
          <span class="hits">9</span>
          
          <code class="ruby">    @general_meeting = co.build_general_meeting_or_annual_general_meeting(params[:general_meeting])</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="15">
          <span class="hits">9</span>
          
          <code class="ruby">    @general_meeting.save!</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="16">
          <span class="hits">9</span>
          
          <code class="ruby">    redirect_to meetings_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">  def show</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="20">
          <span class="hits">4</span>
          
          <code class="ruby">    @general_meeting = co.general_meetings.find(params[:id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">  def edit</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="24">
          <span class="hits">5</span>
          
          <code class="ruby">    @general_meeting = co.general_meetings.find(params[:id])</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="25">
          <span class="hits">5</span>
          
          <code class="ruby">    @members = co.members</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">  def update</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="29">
          <span class="hits">4</span>
          
          <code class="ruby">    @general_meeting = co.general_meetings.find(params[:id])</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="30">
          <span class="hits">4</span>
          
          <code class="ruby">    @general_meeting.update_attributes(params[:general_meeting])</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="31">
          <span class="hits">4</span>
          
          <code class="ruby">    redirect_to meetings_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="8aab7633a7a3ee139347e3e938f6d1f397049e9b">
  <div class="header">
    <h3>app/controllers/invitations_controller.rb</h3>
    <h4><span class="yellow">88.24 %</span> covered</h4>
    <div>
      <b>17</b> relevant lines. 
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class InvitationsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_authenticated</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :prepare_notifications</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  def edit</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    # TODO should be searching scoped by organisation.</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="7">
          <span class="hits">10</span>
          
          <code class="ruby">    @invitation = Invitation.find_by_id(params[:id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="9">
          <span class="hits">10</span>
          
          <code class="ruby">    unless @invitation</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">      redirect_to(root_path)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="14">
          <span class="hits">9</span>
          
          <code class="ruby">    @show_founding_warnings = @invitation.show_founding_warnings?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  def update</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    # TODO should be searching scoped by organisation</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="19">
          <span class="hits">10</span>
          
          <code class="ruby">    @invitation = Invitation.find(params[:id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="21">
          <span class="hits">9</span>
          
          <code class="ruby">    if @invitation.update_attributes(params[:invitation])</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="22">
          <span class="hits">9</span>
          
          <code class="ruby">      log_in @invitation.member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="24">
          <span class="hits">9</span>
          
          <code class="ruby">      flash[:notice] = &quot;Your new password has been saved.&quot;</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="25">
          <span class="hits">9</span>
          
          <code class="ruby">      redirect_to root_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">      flash.now[:error] = &quot;There was a problem with your new details.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">      render :action =&gt; :edit</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="1610b6543cd3bfeca2ce73874c81eb1a6f115a35">
  <div class="header">
    <h3>app/controllers/meetings_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>23</b> relevant lines. 
      <span class="green"><b>23</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class MeetingsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def index</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="3">
          <span class="hits">27</span>
          
          <code class="ruby">    @upcoming_meetings = co.meetings.upcoming</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="4">
          <span class="hits">27</span>
          
          <code class="ruby">    @past_meetings = co.meetings.past</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  def show</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="8">
          <span class="hits">11</span>
          
          <code class="ruby">    @meeting = co.meetings.find(params[:id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="10">
          <span class="hits">11</span>
          
          <code class="ruby">    unless can?(:read, @meeting)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">      redirect_to root_path</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="15">
          <span class="hits">10</span>
          
          <code class="ruby">    @comments = @meeting.comments</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="16">
          <span class="hits">10</span>
          
          <code class="ruby">    @comment = Comment.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="20">
          <span class="hits">11</span>
          
          <code class="ruby">    unless can?(:create, Meeting)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">      redirect_to root_path</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    # A Meeting must know its organisation before we</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    # try to set its participants.</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="27">
          <span class="hits">10</span>
          
          <code class="ruby">    @meeting = co.meetings.build</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="28">
          <span class="hits">10</span>
          
          <code class="ruby">    @meeting.attributes = params[:meeting]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="30">
          <span class="hits">10</span>
          
          <code class="ruby">    @meeting.creator = current_user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="32">
          <span class="hits">10</span>
          
          <code class="ruby">    if @meeting.save</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="33">
          <span class="hits">6</span>
          
          <code class="ruby">      redirect_to root_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="35">
          <span class="hits">4</span>
          
          <code class="ruby">      flash[:error] = &quot;There was a problem saving the minutes.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="37">
          <span class="hits">4</span>
          
          <code class="ruby">      @directors = co.members.where(:member_class_id =&gt; co.member_classes.find_by_name('Director').id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="39">
          <span class="hits">4</span>
          
          <code class="ruby">      render :action =&gt; 'new'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="235d2625f220fab83f8fa26925a5db014381d49d">
  <div class="header">
    <h3>app/controllers/member_sessions_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>23</b> relevant lines. 
      <span class="green"><b>23</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class MemberSessionsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_authenticated</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_member_active_or_pending</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_member_inducted</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :prepare_notifications</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  before_filter :redirect_to_root_if_logged_in, :only =&gt; :new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="107" data-linenumber="10">
          <span class="hits">107</span>
          
          <code class="ruby">    @page_title = &quot;Login&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="194" data-linenumber="14">
          <span class="hits">194</span>
          
          <code class="ruby">    user = co.members.authenticate(params[:email], params[:password])</code>
        </li>
      
        <li class="covered" data-hits="194" data-linenumber="15">
          <span class="hits">194</span>
          
          <code class="ruby">    if user</code>
        </li>
      
        <li class="covered" data-hits="190" data-linenumber="16">
          <span class="hits">190</span>
          
          <code class="ruby">      log_in user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="190" data-linenumber="18">
          <span class="hits">190</span>
          
          <code class="ruby">      flash[:notice] = &quot;Welcome back, #{current_user.name}!&quot;</code>
        </li>
      
        <li class="covered" data-hits="190" data-linenumber="19">
          <span class="hits">190</span>
          
          <code class="ruby">      redirect_back_or_default</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="21">
          <span class="hits">4</span>
          
          <code class="ruby">      flash.now[:error] = &quot;The email address or password entered were incorrect&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="22">
          <span class="hits">4</span>
          
          <code class="ruby">      render(:action =&gt; :new)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">  def destroy</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">    reset_session</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">    flash[:notice] = &quot;Logged Out&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">    redirect_to(root_path)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">  def redirect_to_root_if_logged_in</code>
        </li>
      
        <li class="covered" data-hits="107" data-linenumber="35">
          <span class="hits">107</span>
          
          <code class="ruby">    redirect_to root_path if current_user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="105821dc5ab76da01e9773ca7427d8cf375fe790">
  <div class="header">
    <h3>app/controllers/members_controller.rb</h3>
    <h4><span class="green">94.19 %</span> covered</h4>
    <div>
      <b>86</b> relevant lines. 
      <span class="green"><b>81</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'csv'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">class MembersController &lt; ApplicationController</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_authenticated, :ensure_member_active_or_pending, :only =&gt; [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    :new, :create, :created, :resigned</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  def index</code>
        </li>
      
        <li class="covered" data-hits="38" data-linenumber="11">
          <span class="hits">38</span>
          
          <code class="ruby">    case co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    when Association</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="13">
          <span class="hits">16</span>
          
          <code class="ruby">      @page_title = &quot;Members&quot;</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="14">
          <span class="hits">16</span>
          
          <code class="ruby">      @members = co.members.active</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="15">
          <span class="hits">16</span>
          
          <code class="ruby">      @pending_members = co.members.pending</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="16">
          <span class="hits">16</span>
          
          <code class="ruby">      if can?(:create, FoundingMember)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="17">
          <span class="hits">3</span>
          
          <code class="ruby">        @founding_member = co.build_founding_member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    when Company</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="20">
          <span class="hits">13</span>
          
          <code class="ruby">      @members = co.directors.active</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="22">
          <span class="hits">13</span>
          
          <code class="ruby">      @page_title = &quot;Directors&quot;</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="23">
          <span class="hits">13</span>
          
          <code class="ruby">      @director = Director.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    when Coop</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="25">
          <span class="hits">9</span>
          
          <code class="ruby">      @page_title = &quot;Members&quot;</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="26">
          <span class="hits">9</span>
          
          <code class="ruby">      @members = co.members.active</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="27">
          <span class="hits">9</span>
          
          <code class="ruby">      if can?(:create, FounderMember)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="28">
          <span class="hits">3</span>
          
          <code class="ruby">        @founder_member = co.build_founder_member</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="29">
          <span class="hits">3</span>
          
          <code class="ruby">        @pending_members = co.members.pending</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="38" data-linenumber="33">
          <span class="hits">38</span>
          
          <code class="ruby">    respond_to do |format|</code>
        </li>
      
        <li class="covered" data-hits="38" data-linenumber="34">
          <span class="hits">38</span>
          
          <code class="ruby">      format.html</code>
        </li>
      
        <li class="covered" data-hits="38" data-linenumber="35">
          <span class="hits">38</span>
          
          <code class="ruby">      format.pdf {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">        generate_pdf(@page_title)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="covered" data-hits="38" data-linenumber="38">
          <span class="hits">38</span>
          
          <code class="ruby">      format.csv {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">        generate_csv</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="44">
          <span class="hits">2</span>
          
          <code class="ruby">  def show</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="45">
          <span class="hits">7</span>
          
          <code class="ruby">    @member = co.members.find(params[:id])</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="46">
          <span class="hits">7</span>
          
          <code class="ruby">    @member_presenter = MemberPresenter.new(@member)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="47">
          <span class="hits">7</span>
          
          <code class="ruby">    case co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">    when Association</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="49">
          <span class="hits">5</span>
          
          <code class="ruby">      @eject_member_proposal = co.eject_member_proposals.build(:member_id =&gt; @member.id)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="50">
          <span class="hits">5</span>
          
          <code class="ruby">      @page_title = &quot;Member profile&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="54">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">    @member = co.members.build</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="58">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">    unless co.is_a?(Coop)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">      redirect_to root_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">    @member = co.members.build(params[:member])</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">    @member.member_class = co.member_classes.find_by_name('Member')</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">    @member.save!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">    redirect_to created_members_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="70">
          <span class="hits">2</span>
          
          <code class="ruby">  def created</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="73">
          <span class="hits">2</span>
          
          <code class="ruby">  def edit</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="74">
          <span class="hits">6</span>
          
          <code class="ruby">    @member = co.members.find(params[:id])</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="75">
          <span class="hits">6</span>
          
          <code class="ruby">    authorize! :update, @member</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="76">
          <span class="hits">5</span>
          
          <code class="ruby">    @page_title = &quot;Edit your account&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="79">
          <span class="hits">2</span>
          
          <code class="ruby">  def update</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="80">
          <span class="hits">5</span>
          
          <code class="ruby">    id, member = params[:id], params[:member]</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="81">
          <span class="hits">5</span>
          
          <code class="ruby">    @member = co.members.find(id)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="82">
          <span class="hits">5</span>
          
          <code class="ruby">    authorize! :update, Member</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="83">
          <span class="hits">5</span>
          
          <code class="ruby">    if @member.update_attributes(member)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="84">
          <span class="hits">4</span>
          
          <code class="ruby">      flash[:notice] = &quot;Account updated.&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="85">
          <span class="hits">4</span>
          
          <code class="ruby">      case co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">      when Association</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="87">
          <span class="hits">3</span>
          
          <code class="ruby">        redirect_to member_path(@member)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">      when Company</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="89">
          <span class="hits">1</span>
          
          <code class="ruby">        redirect_to members_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">      when Coop</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="91">
          
          
          <code class="ruby">        redirect_to member_path(@member)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="94">
          
          
          <code class="ruby">      flash.now[:error] = &quot;There was a problem with your new details.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">      render(:action =&gt; :edit)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="99">
          <span class="hits">2</span>
          
          <code class="ruby">  def confirm_resign</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>
          
          <code class="ruby">    @page_title = &quot;Are you sure you want to resign from this organisation?&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">    @member = current_user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="104">
          <span class="hits">2</span>
          
          <code class="ruby">  def resign</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="105">
          <span class="hits">1</span>
          
          <code class="ruby">    @member = current_user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">    @member.resign!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">    redirect_to(resigned_members_path)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="110">
          <span class="hits">2</span>
          
          <code class="ruby">  def resigned</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="111">
          <span class="hits">1</span>
          
          <code class="ruby">    reset_session</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="114">
          <span class="hits">2</span>
          
          <code class="ruby">  def induct</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="115">
          <span class="hits">4</span>
          
          <code class="ruby">    @member = co.members.find(params[:id])</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="116">
          <span class="hits">4</span>
          
          <code class="ruby">    @member.send_welcome = true</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="117">
          <span class="hits">4</span>
          
          <code class="ruby">    @member.induct!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="119">
          <span class="hits">4</span>
          
          <code class="ruby">    st = ShareTransaction.create(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">      :to_account =&gt; @member.find_or_create_share_account,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">      :from_account =&gt; co.share_account,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">      :amount =&gt; 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">    )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="124">
          <span class="hits">4</span>
          
          <code class="ruby">    st.save!</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="125">
          <span class="hits">4</span>
          
          <code class="ruby">    st.approve!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="127">
          <span class="hits">4</span>
          
          <code class="ruby">    redirect_to members_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="130">
          <span class="hits">2</span>
          
          <code class="ruby">private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">  # Create csv file of members in an org, then send data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">  # as a file stream for downloads.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby">  # @see http://api.rubyonrails.org/classes/ActionController/Streaming.html#method-i-send_data</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="136">
          <span class="hits">2</span>
          
          <code class="ruby">  def generate_csv</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="137">
          <span class="hits">1</span>
          
          <code class="ruby">    case co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">    when Association</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">      # Only Associations use the 'inducted_at' field.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="140">
          <span class="hits">1</span>
          
          <code class="ruby">      fields = [:first_name, :last_name, :email, :inducted_at, :last_logged_in_at]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby">    # In Ruby 1.9, FasterCSV is provided as the stdlib's CSV library.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="144">
          <span class="hits">1</span>
          
          <code class="ruby">    csv_library = defined?(FasterCSV) ? FasterCSV : CSV</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="146">
          <span class="hits">1</span>
          
          <code class="ruby">    csv = csv_library.generate do |csv|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="147">
          <span class="hits">1</span>
          
          <code class="ruby">      csv &lt;&lt; fields</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="148">
          <span class="hits">1</span>
          
          <code class="ruby">      @members.each do |member|</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="149">
          <span class="hits">24</span>
          
          <code class="ruby">        csv &lt;&lt; fields.collect { |f| member.send(f) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="153">
          <span class="hits">1</span>
          
          <code class="ruby">    filename = case co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">    when Association</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="155">
          <span class="hits">1</span>
          
          <code class="ruby">      &quot;#{co.name} Members.csv&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="158">
          <span class="hits">1</span>
          
          <code class="ruby">    send_data(csv,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">      :filename =&gt; filename,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">      :type =&gt; 'text/csv',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">      :disposition =&gt; 'attachment'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">    )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="bcee037100a2e96b26daba890ff946e8c9c0f541">
  <div class="header">
    <h3>app/controllers/membership_application_forms_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>9</b> relevant lines. 
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class MembershipApplicationFormsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def edit</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">    authorize! :update, co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def update</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="7">
          <span class="hits">4</span>
          
          <code class="ruby">    authorize! :update, co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="9">
          <span class="hits">4</span>
          
          <code class="ruby">    co.membership_application_text = params[:organisation][:membership_application_text]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="10">
          <span class="hits">4</span>
          
          <code class="ruby">    co.save!</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="11">
          <span class="hits">4</span>
          
          <code class="ruby">    flash[:notice] = &quot;The membership application form has been amended.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="13">
          <span class="hits">4</span>
          
          <code class="ruby">    redirect_to members_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="141e757ffc396dc3b89da7f95ce1724a5bce366d">
  <div class="header">
    <h3>app/controllers/officerships_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class OfficershipsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="3">
          <span class="hits">7</span>
          
          <code class="ruby">    @officership = co.officerships.build(:elected_on =&gt; Date.today)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="4">
          <span class="hits">7</span>
          
          <code class="ruby">    @officership.build_office</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="8">
          <span class="hits">6</span>
          
          <code class="ruby">    @officership = co.officerships.build(params[:officership])</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="9">
          <span class="hits">6</span>
          
          <code class="ruby">    @officership.save!</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="10">
          <span class="hits">6</span>
          
          <code class="ruby">    redirect_to directors_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">  def edit</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="14">
          <span class="hits">4</span>
          
          <code class="ruby">    @officership = co.officerships.find(params[:id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  def update</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="18">
          <span class="hits">4</span>
          
          <code class="ruby">    @officership = co.officerships.find(params[:id])</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="19">
          <span class="hits">4</span>
          
          <code class="ruby">    @officership.update_attributes(params[:officership])</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="20">
          <span class="hits">4</span>
          
          <code class="ruby">    redirect_to directors_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="4b839c55c024c50744210aed600606a8459e1339">
  <div class="header">
    <h3>app/controllers/one_click_controller.rb</h3>
    <h4><span class="green">92.31 %</span> covered</h4>
    <div>
      <b>26</b> relevant lines. 
      <span class="green"><b>24</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class OneClickController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def index</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3">
          
          
          <code class="ruby">    redirect_to(:action =&gt; 'dashboard')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def dashboard</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    # Fetch open proposals</code>
        </li>
      
        <li class="covered" data-hits="155" data-linenumber="8">
          <span class="hits">155</span>
          
          <code class="ruby">    @proposals = co.proposals.currently_open</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="155" data-linenumber="10">
          <span class="hits">155</span>
          
          <code class="ruby">    @new_proposal = co.proposals.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="155" data-linenumber="12">
          <span class="hits">155</span>
          
          <code class="ruby">    case co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    when Association</code>
        </li>
      
        <li class="covered" data-hits="60" data-linenumber="14">
          <span class="hits">60</span>
          
          <code class="ruby">      if current_organisation.pending? || current_organisation.proposed?</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="15">
          <span class="hits">18</span>
          
          <code class="ruby">        redirect_to constitution_path</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="16">
          <span class="hits">18</span>
          
          <code class="ruby">        return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="18">
          <span class="hits">42</span>
          
          <code class="ruby">      @add_member_proposal = co.add_member_proposals.build</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="20">
          <span class="hits">42</span>
          
          <code class="ruby">      @timeline = [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">        co.members.all,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">        co.proposals.all,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">        co.decisions.all,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">        co.resignations.all</code>
        </li>
      
        <li class="covered" data-hits="158" data-linenumber="25">
          <span class="hits">158</span>
          
          <code class="ruby">      ].flatten.map(&amp;:to_event).compact.sort{|a, b| b[:timestamp] &lt;=&gt; a[:timestamp]}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    when Company</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="27">
          <span class="hits">27</span>
          
          <code class="ruby">      @meeting = Meeting.new</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="28">
          <span class="hits">27</span>
          
          <code class="ruby">      @directors = co.members.where(:member_class_id =&gt; co.member_classes.find_by_name('Director').id)</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="29">
          <span class="hits">27</span>
          
          <code class="ruby">      @timeline = [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">        co.proposals.all,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">        co.decisions.all,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">        co.meetings.all</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="33">
          <span class="hits">24</span>
          
          <code class="ruby">      ].flatten.map(&amp;:to_event).compact.sort{|a, b| b[:timestamp] &lt;=&gt; a[:timestamp]}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    when Coop</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="35">
          <span class="hits">68</span>
          
          <code class="ruby">      unless co.active?</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="36">
          <span class="hits">11</span>
          
          <code class="ruby">        redirect_to checklist_path</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="37">
          <span class="hits">11</span>
          
          <code class="ruby">        return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="57" data-linenumber="39">
          <span class="hits">57</span>
          
          <code class="ruby">      @timeline = [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">        co.members.all,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">        co.meetings.all,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">        co.resolutions,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">        co.resolution_proposals</code>
        </li>
      
        <li class="covered" data-hits="85" data-linenumber="44">
          <span class="hits">85</span>
          
          <code class="ruby">      ].flatten.map(&amp;:to_event).compact.sort{|a, b| b[:timestamp] &lt;=&gt; a[:timestamp]}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="57" data-linenumber="46">
          <span class="hits">57</span>
          
          <code class="ruby">      @tasks = current_user.tasks.current</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="50">
          <span class="hits">2</span>
          
          <code class="ruby">  def checklist</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="51">
          <span class="hits">12</span>
          
          <code class="ruby">    if co.active?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">      redirect_to root_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="135385e3c312f06a1713a69276c14a2dafe6ee9a">
  <div class="header">
    <h3>app/controllers/organisations_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class OrganisationsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_organisation_exists</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_authenticated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  layout &quot;setup&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b4b6e199bd87480f0ec74e4677cbf05b6fbacfd7">
  <div class="header">
    <h3>app/controllers/password_resets_controller.rb</h3>
    <h4><span class="red">46.15 %</span> covered</h4>
    <div>
      <b>26</b> relevant lines. 
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>14</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class PasswordResetsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">    skip_before_filter :ensure_authenticated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="8">
          <span class="hits">5</span>
          
          <code class="ruby">    @email = params[:email]</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="9">
          <span class="hits">5</span>
          
          <code class="ruby">    if @member = co.members.where(:email =&gt; @email).first</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="10">
          <span class="hits">3</span>
          
          <code class="ruby">      @member.new_password_reset_code!</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="11">
          <span class="hits">3</span>
          
          <code class="ruby">      @member.save!</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="12">
          <span class="hits">3</span>
          
          <code class="ruby">      MembersMailer.password_reset(@member).deliver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="14">
          <span class="hits">5</span>
          
          <code class="ruby">    render(:action =&gt; :show)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  def edit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    @password_reset_code = params[:id]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    @member = Member.find_by_password_reset_code(@password_reset_code)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    unless @member</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">      render_404</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">  def update</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">    @password_reset_code = params[:id]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">    @member = Member.find_by_password_reset_code(@password_reset_code)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    @member.attributes = params[:member]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">    if @member.save</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">      @member.clear_password_reset_code!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">      log_in(@member)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">      flash[:notice] = &quot;Your new password has been saved.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">      redirect_to(root_path)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">      flash.now[:error] = &quot;There was a problem with your new details.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">      render(:action =&gt; :edit)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="fb158ab3822a81a9229b9074c1deb9606f80d86f">
  <div class="header">
    <h3>app/controllers/proposals_controller.rb</h3>
    <h4><span class="green">96.43 %</span> covered</h4>
    <div>
      <b>28</b> relevant lines. 
      <span class="green"><b>27</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ProposalsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  respond_to :html</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def index</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="5">
          <span class="hits">31</span>
          
          <code class="ruby">    case co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    when Coop</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="7">
          <span class="hits">28</span>
          
          <code class="ruby">      @proposals = co.resolutions.currently_open</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="8">
          <span class="hits">28</span>
          
          <code class="ruby">      @draft_proposals = co.resolutions.draft</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="9">
          <span class="hits">28</span>
          
          <code class="ruby">      @resolution_proposals = co.resolution_proposals</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">      # Fetch open proposals</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="12">
          <span class="hits">3</span>
          
          <code class="ruby">      @proposals = co.proposals.currently_open</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">      # Fetch five most recent decisions</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="15">
          <span class="hits">3</span>
          
          <code class="ruby">      @decisions = co.decisions.order(&quot;id DESC&quot;).limit(5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">      # Fetch five most recent failed proposals</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="18">
          <span class="hits">3</span>
          
          <code class="ruby">      @failed_proposals = co.proposals.failed.limit(5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">  def show</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="23">
          <span class="hits">9</span>
          
          <code class="ruby">    @proposal = co.proposals.find(params[:id])</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="24">
          <span class="hits">7</span>
          
          <code class="ruby">    @comments = @proposal.comments</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="25">
          <span class="hits">7</span>
          
          <code class="ruby">    @comment = Comment.new</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="26">
          <span class="hits">7</span>
          
          <code class="ruby">    @page_title = &quot;Proposal&quot;</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="27">
          <span class="hits">7</span>
          
          <code class="ruby">    respond_with @proposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  # Freeform proposal</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="32">
          <span class="hits">5</span>
          
          <code class="ruby">    authorize! :create, Proposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="34">
          <span class="hits">5</span>
          
          <code class="ruby">    @proposal = co.proposals.new(params[:proposal])</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="35">
          <span class="hits">5</span>
          
          <code class="ruby">    @proposal[:type] = 'Proposal' # Bug #138, cf. http://www.simple10.com/rails-3-sti/</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="36">
          <span class="hits">5</span>
          
          <code class="ruby">    @proposal.proposer = current_user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">        </code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="38">
          <span class="hits">5</span>
          
          <code class="ruby">    if @proposal.save</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="39">
          <span class="hits">5</span>
          
          <code class="ruby">      redirect_to proposal_path(@proposal), :flash =&gt; {:notice =&gt; &quot;Proposal was successfully created&quot;}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">      # TODO Preserve entered form values; render instead of redirect;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">      # use error_messages_for.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">      redirect root_path, :flash =&gt; {:error =&gt; &quot;Proposal not created&quot;}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="47">
          <span class="hits">2</span>
          
          <code class="ruby">  def open</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="48">
          <span class="hits">4</span>
          
          <code class="ruby">    @proposal = co.resolutions.find(params[:id])</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="49">
          <span class="hits">4</span>
          
          <code class="ruby">    @proposal.start!</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="50">
          <span class="hits">4</span>
          
          <code class="ruby">    redirect_to proposals_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="1bf6762d52323a4aa31c5dce27dc45130070ccf3">
  <div class="header">
    <h3>app/controllers/registration_forms_controller.rb</h3>
    <h4><span class="red">80.0 %</span> covered</h4>
    <div>
      <b>15</b> relevant lines. 
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class RegistrationFormsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def edit</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">    @registration_form = co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def update</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    @registration_form = co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    @registration_form.reg_form_timing_factors = params[:registration_form][:reg_form_timing_factors]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">    @registration_form.reg_form_financial_year_end = params[:registration_form][:reg_form_financial_year_end]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">    @registration_form.reg_form_membership_required = case params[:registration_form][:reg_form_membership_required]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    when 'true'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">      true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    when 'false'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">      false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">      nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    if @registration_form.save</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">      flash[:notice] = &quot;Your changes to the Registration Form were saved.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">      flash[:error] = &quot;There was a problem saving your changes to the Registration Form: #{@registration_form.errors.full_messages.to_sentence}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    redirect_to edit_registration_form_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="1673f88fcabf4b4e8e7875eed46773b25d8a0763">
  <div class="header">
    <h3>app/controllers/resolution_proposals_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>31</b> relevant lines. 
      <span class="green"><b>31</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ResolutionProposalsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def show</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">    @resolution_proposal = co.resolution_proposals.find(params[:id])</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">    @comments = @resolution_proposal.comments</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    @comment = Comment.new</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">    @page_title = &quot;Suggested resolution&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="10">
          <span class="hits">4</span>
          
          <code class="ruby">    @resolution_proposal = co.resolution_proposals.build</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="14">
          <span class="hits">5</span>
          
          <code class="ruby">    @resolution_proposal = co.resolution_proposals.build(params[:resolution_proposal])</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="15">
          <span class="hits">5</span>
          
          <code class="ruby">    @resolution_proposal.proposer = current_user</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="16">
          <span class="hits">5</span>
          
          <code class="ruby">    @resolution_proposal.save!</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="17">
          <span class="hits">5</span>
          
          <code class="ruby">    redirect_to proposals_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">  def edit</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="21">
          <span class="hits">4</span>
          
          <code class="ruby">    @resolution_proposal = co.resolution_proposals.find(params[:id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">  def update</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="25">
          <span class="hits">4</span>
          
          <code class="ruby">    @resolution_proposal = co.resolution_proposals.find(params[:id])</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="26">
          <span class="hits">4</span>
          
          <code class="ruby">    @resolution_proposal.update_attributes(params[:resolution_proposal])</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="27">
          <span class="hits">4</span>
          
          <code class="ruby">    redirect_to proposals_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">  def pass</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="31">
          <span class="hits">5</span>
          
          <code class="ruby">    @resolution_proposal = co.resolution_proposals.find(params[:id])</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="32">
          <span class="hits">5</span>
          
          <code class="ruby">    @resolution_proposal.force_passed = true</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="33">
          <span class="hits">5</span>
          
          <code class="ruby">    @resolution_proposal.close!</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="34">
          <span class="hits">5</span>
          
          <code class="ruby">    redirect_to proposals_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="37">
          <span class="hits">2</span>
          
          <code class="ruby">  def pass_to_meeting</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="38">
          <span class="hits">7</span>
          
          <code class="ruby">    @resolution_proposal = co.resolution_proposals.find(params[:id])</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="39">
          <span class="hits">7</span>
          
          <code class="ruby">    @resolution_proposal.force_passed = true</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="40">
          <span class="hits">7</span>
          
          <code class="ruby">    @resolution_proposal.create_draft_resolution = true</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="41">
          <span class="hits">7</span>
          
          <code class="ruby">    @resolution_proposal.close!</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="42">
          <span class="hits">7</span>
          
          <code class="ruby">    resolution = @resolution_proposal.new_resolution</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="43">
          <span class="hits">7</span>
          
          <code class="ruby">    redirect_to new_general_meeting_path(:resolution_id =&gt; resolution)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="45c960cdf8d5b375dd3a6d455c7ef12911c89d19">
  <div class="header">
    <h3>app/controllers/resolutions_controller.rb</h3>
    <h4><span class="red">66.67 %</span> covered</h4>
    <div>
      <b>15</b> relevant lines. 
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ResolutionsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">    unless can?(:create, Resolution) || can?(:create, ExtraordinaryResolution)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4">
          
          
          <code class="ruby">      redirect_to root_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">        </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">    @resolution = co.resolutions.build</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="12">
          <span class="hits">6</span>
          
          <code class="ruby">    @resolution = current_organisation.resolutions.build(params[:resolution])</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="13">
          <span class="hits">6</span>
          
          <code class="ruby">    @resolution.proposer = current_user</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="14">
          <span class="hits">6</span>
          
          <code class="ruby">    @resolution.save!</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="15">
          <span class="hits">6</span>
          
          <code class="ruby">    redirect_to proposals_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">  def show</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    @resolution = co.resolutions.find(params[:id])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    @comments = @resolution.comments</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">    @comment = Comment.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="865ef817e4e5582fb04f5d5a188d7c42c85e974a">
  <div class="header">
    <h3>app/controllers/setup_controller.rb</h3>
    <h4><span class="green">93.55 %</span> covered</h4>
    <div>
      <b>31</b> relevant lines. 
      <span class="green"><b>29</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class SetupController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_set_up</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  before_filter :ensure_not_set_up_yet</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_organisation_exists</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_authenticated</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_member_active_or_pending</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_member_inducted</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :prepare_notifications</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  layout 'setup'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def index</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="13">
          <span class="hits">6</span>
          
          <code class="ruby">    @base_domain = request.host_with_port</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="14">
          <span class="hits">6</span>
          
          <code class="ruby">    @signup_domain = request.host_with_port</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  def create_domains</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="18">
          <span class="hits">4</span>
          
          <code class="ruby">    @base_domain = params[:base_domain]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="19">
          <span class="hits">4</span>
          
          <code class="ruby">    @signup_domain = params[:signup_domain]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="20">
          <span class="hits">4</span>
          
          <code class="ruby">    if @base_domain.present? &amp;&amp; @signup_domain.present?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="21">
          <span class="hits">4</span>
          
          <code class="ruby">      Setting[:base_domain] = @base_domain</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="22">
          <span class="hits">4</span>
          
          <code class="ruby">      Setting[:signup_domain] = @signup_domain</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="23">
          <span class="hits">4</span>
          
          <code class="ruby">      flash[:notice] = &quot;Domains set. Now you can make an organisation.&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="24">
          <span class="hits">4</span>
          
          <code class="ruby">      redirect_to(new_organisation_url(:host =&gt; Setting[:signup_domain]))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">      flash.now[:error] = &quot;You must choose both a base domain and a sign-up domain.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">      render(:action =&gt; :index)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_single_organisation_mode</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="32">
          <span class="hits">4</span>
          
          <code class="ruby">    Setting[:single_organisation_mode] = &quot;true&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="33">
          <span class="hits">4</span>
          
          <code class="ruby">    Setting[:base_domain] = request.host_with_port</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="34">
          <span class="hits">4</span>
          
          <code class="ruby">    Setting[:signup_domain] = request.host_with_port</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="35">
          <span class="hits">4</span>
          
          <code class="ruby">    redirect_to(new_association_path)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">  def ensure_not_set_up_yet</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="41">
          <span class="hits">15</span>
          
          <code class="ruby">    if OneClickOrgs::Setup.complete?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">      redirect_to('/')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="edfcc88f55d07e3b56ae77db46a8c4e68c0716b5">
  <div class="header">
    <h3>app/controllers/share_applications_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines. 
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ShareApplicationsController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def new</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="3">
          <span class="hits">4</span>
          
          <code class="ruby">    @share_application = ShareApplication.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="7">
          <span class="hits">5</span>
          
          <code class="ruby">    @share_application = ShareApplication.new(params[:share_application])</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="8">
          <span class="hits">5</span>
          
          <code class="ruby">    @share_application.member = current_user</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="9">
          <span class="hits">5</span>
          
          <code class="ruby">    @share_application.save!</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="10">
          <span class="hits">5</span>
          
          <code class="ruby">    redirect_to shares_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="02031c10ca37a424f75e324aa9641085cabe1950">
  <div class="header">
    <h3>app/controllers/share_transactions_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ShareTransactionsController &lt; ApplicationController</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="0fa2db0357d00c20086ac9068b4e1bba65e53e86">
  <div class="header">
    <h3>app/controllers/shares_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>27</b> relevant lines. 
      <span class="green"><b>27</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class SharesController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def index</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="3">
          <span class="hits">9</span>
          
          <code class="ruby">    @tasks = current_user.tasks.current.shares_related</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def edit_share_value</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">    authorize! :update, co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  def update_share_value</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="11">
          <span class="hits">3</span>
          
          <code class="ruby">    authorize! :update, co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="13">
          <span class="hits">3</span>
          
          <code class="ruby">    if params[:organisation][:share_value_in_pounds].present?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="14">
          <span class="hits">3</span>
          
          <code class="ruby">      co.share_value_in_pounds = params[:organisation][:share_value_in_pounds]</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="15">
          <span class="hits">3</span>
          
          <code class="ruby">      co.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="18">
          <span class="hits">3</span>
          
          <code class="ruby">    redirect_to shares_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">  def edit_minimum_shareholding</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">    authorize! :update, co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">  def update_minimum_shareholding</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="26">
          <span class="hits">3</span>
          
          <code class="ruby">    authorize! :update, co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="28">
          <span class="hits">3</span>
          
          <code class="ruby">    if params[:organisation][:minimum_shareholding].present?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="29">
          <span class="hits">3</span>
          
          <code class="ruby">      co.minimum_shareholding = params[:organisation][:minimum_shareholding]</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="30">
          <span class="hits">3</span>
          
          <code class="ruby">      co.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="33">
          <span class="hits">3</span>
          
          <code class="ruby">    redirect_to shares_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="36">
          <span class="hits">2</span>
          
          <code class="ruby">  def edit_interest_rate</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="37">
          <span class="hits">2</span>
          
          <code class="ruby">    authorize! :update, co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">  def update_interest_rate</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="41">
          <span class="hits">3</span>
          
          <code class="ruby">    authorize! :update, co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="43">
          <span class="hits">3</span>
          
          <code class="ruby">    if params[:organisation][:interest_rate].present?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="44">
          <span class="hits">3</span>
          
          <code class="ruby">      co.interest_rate = params[:organisation][:interest_rate]</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="45">
          <span class="hits">3</span>
          
          <code class="ruby">      co.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="48">
          <span class="hits">3</span>
          
          <code class="ruby">    redirect_to shares_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="1118f9f872ad98e5035533533de1f0d4d0fa5c5a">
  <div class="header">
    <h3>app/controllers/system_controller.rb</h3>
    <h4><span class="red">54.55 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines. 
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class SystemController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :verify_authenticity_token, :only =&gt; [:test_email, :test_exception_notification]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_authenticated, :only =&gt; [:test_email, :test_exception_notification]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :prepare_notifications, :only =&gt; [:test_email, :test_exception_notification]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def test_email</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    if params[:address].blank?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">      render :text =&gt; &quot;ERROR&quot;, :status =&gt; 400</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">      TestMailer.test_email(params[:address], params[:token]).deliver</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">      render :text =&gt; &quot;OK&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">  def test_exception_notification</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    raise &quot;Boom!&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="670f9cf4a5941ba456024a4bd1c89b59b4b06820">
  <div class="header">
    <h3>app/controllers/votes_controller.rb</h3>
    <h4><span class="yellow">85.29 %</span> covered</h4>
    <div>
      <b>34</b> relevant lines. 
      <span class="green"><b>29</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'uri'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">class VotesController &lt; ApplicationController</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  #FIXME duplication  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  def vote_for</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="6">
          <span class="hits">7</span>
          
          <code class="ruby">    authorize! :create, Vote</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="8">
          <span class="hits">6</span>
          
          <code class="ruby">    id, return_to = params[:id], params[:return_to]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="9">
          <span class="hits">6</span>
          
          <code class="ruby">    raise ArgumentError, &quot;need proposal id&quot; unless id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="11">
          <span class="hits">6</span>
          
          <code class="ruby">    proposal = co.proposals.find(params[:id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="13">
          <span class="hits">6</span>
          
          <code class="ruby">    return_to = sanitise_path(return_to)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="15">
          <span class="hits">6</span>
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="16">
          <span class="hits">6</span>
          
          <code class="ruby">      current_user.cast_vote(:for, proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="18">
          <span class="hits">6</span>
          
          <code class="ruby">      if proposal.is_a?(FoundAssociationProposal)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">        if current_user.member_class.name == &quot;Founder&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">          track_analytics_event(&quot;FounderSupportsFounding&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="24">
          <span class="hits">6</span>
          
          <code class="ruby">      notice = case co</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">      when Coop</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">        &quot;You voted to support this resolution.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="28">
          <span class="hits">5</span>
          
          <code class="ruby">        &quot;Vote for proposal cast&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="31">
          <span class="hits">6</span>
          
          <code class="ruby">      redirect_to return_to, :notice =&gt; notice</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    rescue Exception =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">      redirect_to return_to, :notice =&gt; &quot;Error casting vote: #{e}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  #FIXME duplication</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">  def vote_against</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">    authorize! :create, Vote</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">    id, return_to = params[:id], params[:return_to]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">    raise ArgumentError, &quot;need proposal id&quot; unless id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">    proposal = co.proposals.find(params[:id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">    return_to = sanitise_path(return_to)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">      current_user.cast_vote(:against, proposal)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">      redirect_to return_to, :notice =&gt; &quot;Vote against proposal cast&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">    rescue Exception =&gt; e</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">      # TODO better error message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">      redirect_to return_to, :notice =&gt; &quot;Error casting vote: #{e}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  # If the given path is not in fact a path, but is a full URL, then</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  # replace it with a path to our site root.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  # This is to avoid a vulnerability where an attacker crafts a URL</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  # which causes our application to redirect to an external site</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  # chosen by the attacker.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="63">
          <span class="hits">2</span>
          
          <code class="ruby">  def sanitise_path(path)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="64">
          <span class="hits">7</span>
          
          <code class="ruby">    if URI.parse(path).host</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">      root_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="67">
          <span class="hits">6</span>
          
          <code class="ruby">      path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e889bd3535717270aad39b8c5ba1d7533d2b8baa">
  <div class="header">
    <h3>app/controllers/welcome_controller.rb</h3>
    <h4><span class="yellow">86.67 %</span> covered</h4>
    <div>
      <b>15</b> relevant lines. 
      <span class="green"><b>13</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class WelcomeController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :ensure_member_inducted</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  skip_before_filter :prepare_notifications</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  layout 'welcome'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  def index</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">    @organisation_name = co.name</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">    find_constitution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def induct_member</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">    member = current_user</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">    member.induct!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">    if current_user == co.members.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">      track_analytics_event('FounderAcceptsConstitution')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">    redirect_to root_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">  def cancel_membership</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    @organisation_name = co.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a92243d070d9eba1e4e9f4c80526838e1f61e745">
  <div class="header">
    <h3>app/helpers/add_member_proposals_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module AddMemberProposalsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5a7084ad4fa1ac626cfff2a20b37464d722e4d81">
  <div class="header">
    <h3>app/helpers/administrator_sessions_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module AdministratorSessionsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="0893819bb574f10c3ceb4984b129db7d87e34b10">
  <div class="header">
    <h3>app/helpers/application_helper.rb</h3>
    <h4><span class="yellow">80.49 %</span> covered</h4>
    <div>
      <b>41</b> relevant lines. 
      <span class="green"><b>33</b> lines covered</span> and
      <span class="red"><b>8</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module ApplicationHelper</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def get_satisfaction_widget</code>
        </li>
      
        <li class="covered" data-hits="531" data-linenumber="3">
          <span class="hits">531</span>
          
          <code class="ruby">    return unless Rails.env.production?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    raw &lt;&lt;-EOC</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">      &lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot;&gt;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">        var is_ssl = (&quot;https:&quot; == document.location.protocol);</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">        var asset_host = is_ssl ? &quot;https://s3.amazonaws.com/getsatisfaction.com/&quot; : &quot;http://s3.amazonaws.com/getsatisfaction.com/&quot;;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">        document.write(unescape(&quot;%3Cscript src='&quot; + asset_host + &quot;javascripts/feedback-v2.js' type='text/javascript'%3E%3C/script%3E&quot;));</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">      &lt;/script&gt;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">      &lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot;&gt;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">        var feedback_widget_options = {};</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">        feedback_widget_options.display = &quot;overlay&quot;;  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">        feedback_widget_options.company = &quot;oneclickorgs&quot;;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">        feedback_widget_options.placement = &quot;left&quot;;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">        feedback_widget_options.color = &quot;#222&quot;;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">        feedback_widget_options.style = &quot;idea&quot;;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">        var feedback_widget = new GSFN.feedback_widget(feedback_widget_options);</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">      &lt;/script&gt;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    EOC</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">  def google_analytics_code</code>
        </li>
      
        <li class="covered" data-hits="531" data-linenumber="23">
          <span class="hits">531</span>
          
          <code class="ruby">    return unless Rails.env.production? &amp;&amp; OneClickOrgs::GoogleAnalytics.active?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    analytics_js = &lt;&lt;-EOC</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">      var _gaq = _gaq || [];</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      _gaq.push(['_setAccount', '#{OneClickOrgs::GoogleAnalytics.id}']);</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">      _gaq.push(['_setDomainName', '#{OneClickOrgs::GoogleAnalytics.domain}']);</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">      _gaq.push(['_trackPageview']);</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">      (function() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">      })();</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    EOC</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    unless @analytics_events.blank?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">      analytics_js += @analytics_events.map do |event|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">        &quot;OneClickOrgs.trackAnalyticsEvent('#{event}');&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">      end.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">    ['&lt;script type=&quot;text/javascript&quot;&gt;', analytics_js, '&lt;/script&gt;'].join(&quot;\n&quot;).html_safe</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="44">
          <span class="hits">2</span>
          
          <code class="ruby">  def error_messages_for(object)</code>
        </li>
      
        <li class="covered" data-hits="86" data-linenumber="45">
          <span class="hits">86</span>
          
          <code class="ruby">    messages = object.errors.full_messages.map do |message|</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="46">
          <span class="hits">16</span>
          
          <code class="ruby">      content_tag(:li, message)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    end.join</code>
        </li>
      
        <li class="covered" data-hits="86" data-linenumber="48">
          <span class="hits">86</span>
          
          <code class="ruby">    content_tag(:ul, messages.html_safe, :class =&gt; 'errors')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="51">
          <span class="hits">2</span>
          
          <code class="ruby">  def organisation_name</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="52">
          <span class="hits">9</span>
          
          <code class="ruby">    current_organisation.try(:name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="55">
          <span class="hits">2</span>
          
          <code class="ruby">  def form_reveal_button(label, options={})</code>
        </li>
      
        <li class="covered" data-hits="82" data-linenumber="56">
          <span class="hits">82</span>
          
          <code class="ruby">    options = options.with_indifferent_access</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="82" data-linenumber="58">
          <span class="hits">82</span>
          
          <code class="ruby">    form_id = options.delete(:form_id)</code>
        </li>
      
        <li class="covered" data-hits="82" data-linenumber="59">
          <span class="hits">82</span>
          
          <code class="ruby">    raise RuntimeError, &quot;must specify form_id&quot; if form_id.blank?</code>
        </li>
      
        <li class="covered" data-hits="82" data-linenumber="60">
          <span class="hits">82</span>
          
          <code class="ruby">    options['data-form-id'] = form_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="82" data-linenumber="62">
          <span class="hits">82</span>
          
          <code class="ruby">    css_class = if options[:class].present?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">      options[:class] + ' button-form-show'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="82" data-linenumber="65">
          <span class="hits">82</span>
          
          <code class="ruby">      'button-form-show'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="82" data-linenumber="67">
          <span class="hits">82</span>
          
          <code class="ruby">    options[:class] = css_class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="82" data-linenumber="69">
          <span class="hits">82</span>
          
          <code class="ruby">    options[:value] = label</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="82" data-linenumber="71">
          <span class="hits">82</span>
          
          <code class="ruby">    options[:type] = 'button'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="82" data-linenumber="73">
          <span class="hits">82</span>
          
          <code class="ruby">    tag(:input, options)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="76">
          <span class="hits">2</span>
          
          <code class="ruby">  def link_button(label, options={})</code>
        </li>
      
        <li class="covered" data-hits="458" data-linenumber="77">
          <span class="hits">458</span>
          
          <code class="ruby">    options = options.with_indifferent_access</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="458" data-linenumber="79">
          <span class="hits">458</span>
          
          <code class="ruby">    url = options.delete(:url)</code>
        </li>
      
        <li class="covered" data-hits="458" data-linenumber="80">
          <span class="hits">458</span>
          
          <code class="ruby">    raise RuntimeError, &quot;must specify url&quot; if url.blank?</code>
        </li>
      
        <li class="covered" data-hits="458" data-linenumber="81">
          <span class="hits">458</span>
          
          <code class="ruby">    options['data-url'] = url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="458" data-linenumber="83">
          <span class="hits">458</span>
          
          <code class="ruby">    css_class = if options[:class].present?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">      options[:class] + ' button-form'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="458" data-linenumber="86">
          <span class="hits">458</span>
          
          <code class="ruby">      'button-form'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="458" data-linenumber="88">
          <span class="hits">458</span>
          
          <code class="ruby">    options[:class] = css_class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="458" data-linenumber="90">
          <span class="hits">458</span>
          
          <code class="ruby">    options[:value] = label</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="458" data-linenumber="92">
          <span class="hits">458</span>
          
          <code class="ruby">    options[:type] = 'button'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="458" data-linenumber="94">
          <span class="hits">458</span>
          
          <code class="ruby">    tag(:input, options)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="04c40c4c9998051eeedc09c74aaf2bb29ef3f8ed">
  <div class="header">
    <h3>app/helpers/associations_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module AssociationsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="34474df636d8eff1cb0a8702a465a73bff9f9c6a">
  <div class="header">
    <h3>app/helpers/ballots_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module BallotsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="08e92dfce9301432e302cd5b1ac6476c3d58d23f">
  <div class="header">
    <h3>app/helpers/board_meetings_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module BoardMeetingsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b4ae4f6b7c3ca50d53df02acc4136e9a1b63fcd4">
  <div class="header">
    <h3>app/helpers/board_resolutions_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module BoardResolutionsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="0ea901e894af3e18c74344651426bff10768915f">
  <div class="header">
    <h3>app/helpers/change_meeting_notice_period_resolutions_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module ChangeMeetingNoticePeriodResolutionsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="cc79ac982fd27cf8ec24d7c2b2adbdb4f502b0ef">
  <div class="header">
    <h3>app/helpers/change_member_class_proposals_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module ChangeMemberClassProposalsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="30a8d2d2cd234cce05cfd00abd7bbbe1862d8abf">
  <div class="header">
    <h3>app/helpers/change_quorum_resolutions_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module ChangeQuorumResolutionsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f5b66baf6541b1e196aef12fd6015f5ed1c1fff7">
  <div class="header">
    <h3>app/helpers/comments_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module CommentsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="03564eb8a2a61709ee6c942e17b28667036261c1">
  <div class="header">
    <h3>app/helpers/companies_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module CompaniesHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="2406beae7465e2d0c11af2285ac95d32c7381f70">
  <div class="header">
    <h3>app/helpers/constitutions_helper.rb</h3>
    <h4><span class="yellow">85.71 %</span> covered</h4>
    <div>
      <b>7</b> relevant lines. 
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module ConstitutionsHelper</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def edit_form(&amp;block)</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="3">
          <span class="hits">29</span>
          
          <code class="ruby">    if @constitution_wrapper</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="4">
          <span class="hits">10</span>
          
          <code class="ruby">      form_for(@constitution_wrapper, {:as =&gt; :constitution, :url =&gt; constitution_path, :method =&gt; :put}, &amp;block)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="5">
          <span class="hits">19</span>
          
          <code class="ruby">    elsif @constitution_proposal_bundle</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="6">
          <span class="hits">19</span>
          
          <code class="ruby">      form_for(@constitution_proposal_bundle, &amp;block)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">      raise RuntimeError, &quot;model object not set up&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="eb170d588d6e504850f33c4d41420d57648eba0f">
  <div class="header">
    <h3>app/helpers/coops_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module CoopsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="927b8e28263b64792daef14898234be57b601fda">
  <div class="header">
    <h3>app/helpers/decisions_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module DecisionsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="811eaa4e8e3d0cf0b50948533fbbc8d0ff822c04">
  <div class="header">
    <h3>app/helpers/directors_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module DirectorsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b6063b12a377ce24ab2b9ffa5fa818537670d494">
  <div class="header">
    <h3>app/helpers/directorships_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module DirectorshipsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="7b998c56a2a8aa7d78c2e023fa309927cb4ec0d8">
  <div class="header">
    <h3>app/helpers/eject_member_proposals_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module EjectMemberProposalsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="00a7071fcf74926378088daa9efae14ab71e5d0c">
  <div class="header">
    <h3>app/helpers/founding_members_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module FoundingMembersHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3ace8b913cf74cc3d17781beda572427a527814a">
  <div class="header">
    <h3>app/helpers/general_meetings_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module GeneralMeetingsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="af2904d55372925b20066c0410b2da9932fa272a">
  <div class="header">
    <h3>app/helpers/invitations_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module InvitationsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="348194b6ac591ef745a1d4860de7194224f0ff45">
  <div class="header">
    <h3>app/helpers/meetings_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module MeetingsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="7508674060fcc056d79e35529397c4c55d7c4b7a">
  <div class="header">
    <h3>app/helpers/member_sessions_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module MemberSessionsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ba950ae1fee0b5598b37a27537a2ecee03f4a881">
  <div class="header">
    <h3>app/helpers/members_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module MembersHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5f4f675354cea1743bbaf419928ca4fb356bd0b9">
  <div class="header">
    <h3>app/helpers/membership_application_forms_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module MembershipApplicationFormsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e233c22e7e1d379cba121c89d3b0379700d0e30d">
  <div class="header">
    <h3>app/helpers/officerships_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module OfficershipsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3f86df7bea5580be88a6cbf5830ab63e7941ac91">
  <div class="header">
    <h3>app/helpers/one_click_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module OneClickHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="67235943beca09855f841b40500d1f3277f56b26">
  <div class="header">
    <h3>app/helpers/organisations_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module OrganisationsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="d5d7ae33c283f0ffc01a0a1f29aa60bbc25f3026">
  <div class="header">
    <h3>app/helpers/proposals_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module ProposalsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="acad1627445a766c6e98ff147f3c4d6cbcda0409">
  <div class="header">
    <h3>app/helpers/registration_forms_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module RegistrationFormsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ca128c81a688e35b2ead5d1c8a33cbf43cb27f30">
  <div class="header">
    <h3>app/helpers/reset_password_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module ResetPasswordHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="441dc8c50ede3dc180ca435d1740e7be4412d53c">
  <div class="header">
    <h3>app/helpers/resolution_proposals_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module ResolutionProposalsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="4d1462f993a2c4327605ace0e1c5435235d909b2">
  <div class="header">
    <h3>app/helpers/resolutions_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module ResolutionsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b33e39e1668aa02937b27135edac7974ccf917f3">
  <div class="header">
    <h3>app/helpers/setup_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module SetupHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="baeede9c372f4e9f3cd141680fb7d13ba11bc60c">
  <div class="header">
    <h3>app/helpers/share_applications_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module ShareApplicationsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="c11dd0e45d895f959c6dc603a05978195491233d">
  <div class="header">
    <h3>app/helpers/share_transactions_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module ShareTransactionsHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="79dabce9557acec76b9eb5fc152c2e2d09e765cd">
  <div class="header">
    <h3>app/helpers/shares_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module SharesHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ba4452cca0024f143d4d8c10c282bb53c7fc37ec">
  <div class="header">
    <h3>app/helpers/votes_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module VotesHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="fdeb0258d486a2f64be2e3ea43f58253220965f2">
  <div class="header">
    <h3>app/mailers/decision_mailer.rb</h3>
    <h4><span class="green">96.0 %</span> covered</h4>
    <div>
      <b>25</b> relevant lines. 
      <span class="green"><b>24</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class DecisionMailer &lt; OcoMailer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  def notify_foundation_decision(member, decision)</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="4">
          <span class="hits">28</span>
          
          <code class="ruby">    default_url_options[:host] = member.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="6">
          <span class="hits">28</span>
          
          <code class="ruby">    @decision = decision</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="7">
          <span class="hits">28</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="8">
          <span class="hits">28</span>
          
          <code class="ruby">    raise ArgumentError, &quot;need decision and member&quot; unless @decision and @member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="10">
          <span class="hits">28</span>
          
          <code class="ruby">    @proposal = @decision.proposal</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="11">
          <span class="hits">28</span>
          
          <code class="ruby">    raise ArgumentError, &quot;decision has no attached proposal&quot; unless @proposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="13">
          <span class="hits">28</span>
          
          <code class="ruby">    @organisation = @proposal.organisation</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="14">
          <span class="hits">28</span>
          
          <code class="ruby">    raise ArgumentError, &quot;proposal has no attached organisation&quot; unless @organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="16">
          <span class="hits">28</span>
          
          <code class="ruby">    @members = (@organisation.members.active + @organisation.members.pending)</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="17">
          <span class="hits">28</span>
          
          <code class="ruby">    @organisation_name = @organisation.name</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="18">
          <span class="hits">28</span>
          
          <code class="ruby">    @member_vote = @member.votes.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="20">
          <span class="hits">28</span>
          
          <code class="ruby">    if @proposal.passed? then</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="21">
          <span class="hits">28</span>
          
          <code class="ruby">      create_mail(@organisation_name, @member.email, &quot;Vote passed: #{@organisation_name} has been formed as an Association&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">      create_mail(@organisation_name, @member.email, &quot;Vote did not pass: #{@organisation_name} has not been formed as an Association&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">  def notify_new_decision(member, decision)</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="28">
          <span class="hits">50</span>
          
          <code class="ruby">    default_url_options[:host] = member.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="30">
          <span class="hits">50</span>
          
          <code class="ruby">    @decision = decision</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="31">
          <span class="hits">50</span>
          
          <code class="ruby">    @proposal = @decision.proposal</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="32">
          <span class="hits">50</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="34">
          <span class="hits">50</span>
          
          <code class="ruby">    @organisation_name = member.organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="36">
          <span class="hits">50</span>
          
          <code class="ruby">    raise ArgumentError, &quot;need decision&quot; unless @decision and @member</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="37">
          <span class="hits">50</span>
          
          <code class="ruby">    raise ArgumentError, &quot;decision has no attached proposal&quot; unless @proposal</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="38">
          <span class="hits">50</span>
          
          <code class="ruby">    create_mail(@organisation_name, @member.email, &quot;Decision for proposal: #{@proposal.title}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5c3b838f0910aec634d9700571ed09a10684284e">
  <div class="header">
    <h3>app/mailers/directorship_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>7</b> relevant lines. 
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class DirectorshipMailer &lt; OcoMailer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def welcome_new_director(directorship)</code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="3">
          <span class="hits">144</span>
          
          <code class="ruby">    default_url_options[:host] = directorship.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="5">
          <span class="hits">144</span>
          
          <code class="ruby">    @director = directorship.director</code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="6">
          <span class="hits">144</span>
          
          <code class="ruby">    @organisation = directorship.organisation</code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="7">
          <span class="hits">144</span>
          
          <code class="ruby">    @organisation_name = @organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="9">
          <span class="hits">144</span>
          
          <code class="ruby">    create_mail(@organisation_name, @director.email, &quot;You have been made a Director of #{@organisation_name}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="741bf6222693bc545b45b53bd62c32f16ed156b4">
  <div class="header">
    <h3>app/mailers/meeting_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>16</b> relevant lines. 
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class MeetingMailer &lt; OcoMailer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def notify_creation(member, meeting)</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="3">
          <span class="hits">18</span>
          
          <code class="ruby">    default_url_options[:host] = meeting.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="5">
          <span class="hits">18</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="6">
          <span class="hits">18</span>
          
          <code class="ruby">    @meeting = meeting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    create_mail(</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="9">
          <span class="hits">18</span>
          
          <code class="ruby">      @meeting.organisation.name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">      @member.email,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">      &quot;New minutes submitted for #{@meeting.organisation.name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">  def notify_board_meeting_creation(member, meeting)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="16">
          <span class="hits">3</span>
          
          <code class="ruby">    default_url_options[:host] = meeting.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="18">
          <span class="hits">3</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="19">
          <span class="hits">3</span>
          
          <code class="ruby">    @meeting = meeting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    create_mail(</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="22">
          <span class="hits">3</span>
          
          <code class="ruby">      @meeting.organisation.name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">      @member.email,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">      &quot;A new Board Meeting has been convened&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">  def notify_general_meeting_creation(member, meeting)</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="29">
          <span class="hits">16</span>
          
          <code class="ruby">    default_url_options[:host] = meeting.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="31">
          <span class="hits">16</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="32">
          <span class="hits">16</span>
          
          <code class="ruby">    @meeting = meeting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    create_mail(</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="35">
          <span class="hits">16</span>
          
          <code class="ruby">      @meeting.organisation.name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">      @member.email,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">      &quot;A new General Meeting has been convened&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">    )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="7ae153d10085ffec5b9ea149c199269a514acc2a">
  <div class="header">
    <h3>app/mailers/members_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>78</b> relevant lines. 
      <span class="green"><b>78</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class MembersMailer &lt; OcoMailer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def welcome_founder(member)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="3">
          <span class="hits">3</span>
          
          <code class="ruby">    default_url_options[:host] = member.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="5">
          <span class="hits">3</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="6">
          <span class="hits">3</span>
          
          <code class="ruby">    raise ArgumentError, &quot;No member provided&quot; unless @member</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="7">
          <span class="hits">3</span>
          
          <code class="ruby">    @organisation = member.organisation</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="8">
          <span class="hits">3</span>
          
          <code class="ruby">    @organisation_name = member.organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="10">
          <span class="hits">3</span>
          
          <code class="ruby">    create_mail(@organisation_name, @member.email, &quot;#{@organisation_name} on One Click Orgs&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">  def welcome_new_founding_member(member)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="14">
          <span class="hits">5</span>
          
          <code class="ruby">    default_url_options[:host] = member.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="16">
          <span class="hits">5</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="17">
          <span class="hits">5</span>
          
          <code class="ruby">    raise ArgumentError, &quot;No member provided&quot; unless @member</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="18">
          <span class="hits">5</span>
          
          <code class="ruby">    @organisation = member.organisation</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="19">
          <span class="hits">5</span>
          
          <code class="ruby">    @organisation_name = member.organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="21">
          <span class="hits">5</span>
          
          <code class="ruby">    @founder = Member.founders(@organisation).first</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="22">
          <span class="hits">5</span>
          
          <code class="ruby">    raise ArgumentError, &quot;Organisation has no founder&quot; unless @founder</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="24">
          <span class="hits">5</span>
          
          <code class="ruby">    create_mail(@organisation_name, @member.email, &quot;Become a founding member of #{@organisation_name}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">  def welcome_coop_founding_member(member)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">    default_url_options[:host] = member.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">    raise ArgumentError, &quot;No member provided&quot; unless @member</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">    @organisation = member.organisation</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">    @organisation_name = member.organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">    @founder = Member.founder_members(@organisation).first</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="36">
          <span class="hits">2</span>
          
          <code class="ruby">    raise ArgumentError, &quot;Organisation has no founder&quot; unless @founder</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">    create_mail(@organisation_name, @member.email, &quot;Become a Founder Member of #{@organisation_name}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">  def welcome_new_member(member)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="42">
          <span class="hits">5</span>
          
          <code class="ruby">    default_url_options[:host] = member.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="44">
          <span class="hits">5</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="45">
          <span class="hits">5</span>
          
          <code class="ruby">    raise ArgumentError, &quot;No member provided&quot; unless @member</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="46">
          <span class="hits">5</span>
          
          <code class="ruby">    @organisation_name = member.organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="48">
          <span class="hits">5</span>
          
          <code class="ruby">    create_mail(@organisation_name, @member.email, &quot;Invitation to become a member of #{@organisation_name}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="51">
          <span class="hits">2</span>
          
          <code class="ruby">  def welcome_new_director(member)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="52">
          <span class="hits">3</span>
          
          <code class="ruby">    default_url_options[:host] = member.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="54">
          <span class="hits">3</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="55">
          <span class="hits">3</span>
          
          <code class="ruby">    raise ArgumentError, &quot;No member provided&quot; unless @member</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="56">
          <span class="hits">3</span>
          
          <code class="ruby">    @organisation_name = member.organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="58">
          <span class="hits">3</span>
          
          <code class="ruby">    create_mail(@organisation_name, @member.email, &quot;You have been added as a director of #{@organisation_name}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="61">
          <span class="hits">2</span>
          
          <code class="ruby">  def welcome_coop_new_member(member)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">    default_url_options[:host] = member.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">    raise ArgumentError, &quot;No member provided&quot; unless @member</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">    @organisation_name = member.organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">    create_mail(@organisation_name, @member.email, &quot;Your membership application for #{@organisation_name} has been approved&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="71">
          <span class="hits">2</span>
          
          <code class="ruby">  def password_reset(member)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="72">
          <span class="hits">5</span>
          
          <code class="ruby">    default_url_options[:host] = member.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="74">
          <span class="hits">5</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="75">
          <span class="hits">5</span>
          
          <code class="ruby">    raise ArgumentError, &quot;No member provided&quot; unless @member</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="76">
          <span class="hits">5</span>
          
          <code class="ruby">    @organisation_name = member.organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="78">
          <span class="hits">5</span>
          
          <code class="ruby">    create_mail(@organisation_name, @member.email, &quot;Your password for #{@organisation_name} on One Click Orgs&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="81">
          <span class="hits">2</span>
          
          <code class="ruby">  def notify_new_director(member, director)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="82">
          <span class="hits">8</span>
          
          <code class="ruby">    default_url_options[:host] = member.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="84">
          <span class="hits">8</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="85">
          <span class="hits">8</span>
          
          <code class="ruby">    @director = director</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="86">
          <span class="hits">8</span>
          
          <code class="ruby">    raise ArgumentError, &quot;No member provided&quot; unless @member</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="87">
          <span class="hits">8</span>
          
          <code class="ruby">    @organisation = member.organisation</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="88">
          <span class="hits">8</span>
          
          <code class="ruby">    @organisation_name = member.organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="90">
          <span class="hits">8</span>
          
          <code class="ruby">    create_mail(@organisation_name, @member.email, &quot;A new director has been added to #{@organisation_name}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="93">
          <span class="hits">2</span>
          
          <code class="ruby">  def notify_director_stand_down(member, director)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="94">
          <span class="hits">6</span>
          
          <code class="ruby">   default_url_options[:host] = member.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="96">
          <span class="hits">6</span>
          
          <code class="ruby">   @member = member</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="97">
          <span class="hits">6</span>
          
          <code class="ruby">   @director = director</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="98">
          <span class="hits">6</span>
          
          <code class="ruby">   raise ArgumentError, &quot;No member provided&quot; unless @member</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="99">
          <span class="hits">6</span>
          
          <code class="ruby">   @organisation = member.organisation</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="100">
          <span class="hits">6</span>
          
          <code class="ruby">   @organisation_name = member.organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="102">
          <span class="hits">6</span>
          
          <code class="ruby">   create_mail(@organisation_name, @member.email, &quot;#{@director.name} has stood down as a director of #{@organisation.name}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="105">
          <span class="hits">2</span>
          
          <code class="ruby">  def notify_resignation(recipient, resignee)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="106">
          <span class="hits">14</span>
          
          <code class="ruby">    default_url_options[:host] = recipient.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="108">
          <span class="hits">14</span>
          
          <code class="ruby">    @recipient = recipient</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="109">
          <span class="hits">14</span>
          
          <code class="ruby">    @resignee = resignee</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="111">
          <span class="hits">14</span>
          
          <code class="ruby">    @organisation_name = recipient.organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="113">
          <span class="hits">14</span>
          
          <code class="ruby">    create_mail(@organisation_name, @recipient.email, &quot;#{@resignee.name} has resigned&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="116">
          <span class="hits">2</span>
          
          <code class="ruby">  def notify_new_member(recipient, new_member)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="117">
          <span class="hits">3</span>
          
          <code class="ruby">    default_url_options[:host] = recipient.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="119">
          <span class="hits">3</span>
          
          <code class="ruby">    @recipient = recipient</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="120">
          <span class="hits">3</span>
          
          <code class="ruby">    @new_member = new_member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="122">
          <span class="hits">3</span>
          
          <code class="ruby">    @organisation_name = recipient.organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="124">
          <span class="hits">3</span>
          
          <code class="ruby">    create_mail(@organisation_name, @recipient.email, &quot;A new membership application has been received: #{@new_member.name}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="0c52af5951a16cfab0fb00048d65d8d04f38f7fa">
  <div class="header">
    <h3>app/mailers/oco_mailer.rb</h3>
    <h4><span class="red">58.62 %</span> covered</h4>
    <div>
      <b>29</b> relevant lines. 
      <span class="green"><b>17</b> lines covered</span> and
      <span class="red"><b>12</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/mail_helper'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">class OcoMailer &lt; ActionMailer::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  helper :application</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  include ActionView::Helpers::TextHelper</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  include OneClickOrgs::MailHelper</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  default :from =&gt; &quot;notifications@oneclickorgs.com&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  class EmailJob</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">    attr_reader :mail</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">    def initialize(mail)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">      @mail = mail.encoded</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">    def perform</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">      message = Mail::Message.new(mail)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">      ActionMailer::Base.wrap_delivery_behavior(message)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">      message.deliver!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  # Helper method to create email according to the following conventions:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  # * the sender is an OCO address, but is given the name of the current org</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  # * there is one recipient</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  # * the subject line will be truncated to 200 chars max, and any newlines will be stripped</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">  def create_mail(from_name, to, subject)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    mail(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">      :from =&gt; name_addr(from_name, 'notifications@oneclickorgs.com'),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">      :to =&gt; to, </code>
        </li>
      
        <li class="covered" data-hits="659" data-linenumber="31">
          <span class="hits">659</span>
          
          <code class="ruby">      :subject =&gt; truncate(subject, {:length =&gt; 200}).gsub(/[\r\n]+/, ' '))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.deliver_mail(mail)</code>
        </li>
      
        <li class="covered" data-hits="639" data-linenumber="35">
          <span class="hits">639</span>
          
          <code class="ruby">    if !Rails.env.test? &amp;&amp; worker_running?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">      Delayed::Job.enqueue EmailJob.new(mail)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="639" data-linenumber="38">
          <span class="hits">639</span>
          
          <code class="ruby">      Rails.logger.debug &quot;Worker not running, falling back to direct sending&quot;</code>
        </li>
      
        <li class="covered" data-hits="639" data-linenumber="39">
          <span class="hits">639</span>
          
          <code class="ruby">      super</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="43">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.worker_running?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    pid_file = File.join(Rails.root, 'tmp', 'pids', 'delayed_job.pid')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">    return false unless File.exist? pid_file</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">    pid = IO.read(pid_file).strip.to_i</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">      !!Process.kill(0, pid)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">    rescue Errno::ESRCH</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">      false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="6fe86854ee125a82de9f6bc68865728647321bd6">
  <div class="header">
    <h3>app/mailers/officership_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines. 
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class OfficershipMailer &lt; OcoMailer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def welcome_new_officer(officership)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="3">
          <span class="hits">10</span>
          
          <code class="ruby">    @officer = officership.officer</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="4">
          <span class="hits">10</span>
          
          <code class="ruby">    @office_title = officership.office.title</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="5">
          <span class="hits">10</span>
          
          <code class="ruby">    @organisation = officership.office.organisation</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="6">
          <span class="hits">10</span>
          
          <code class="ruby">    @organisation_name = @organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="8">
          <span class="hits">10</span>
          
          <code class="ruby">    default_url_options[:host] = @organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="10">
          <span class="hits">10</span>
          
          <code class="ruby">    create_mail(@organisation_name, @officer.email, &quot;You have been made the #{@office_title} of #{@organisation_name}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="54214331c7bfb3dad1b29733291e35e8497910d6">
  <div class="header">
    <h3>app/mailers/proposal_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>25</b> relevant lines. 
      <span class="green"><b>25</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ProposalMailer &lt; OcoMailer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  def notify_foundation_proposal(member, proposal)</code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="4">
          <span class="hits">52</span>
          
          <code class="ruby">    default_url_options[:host] = member.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="6">
          <span class="hits">52</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="7">
          <span class="hits">52</span>
          
          <code class="ruby">    @proposal = proposal</code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="8">
          <span class="hits">52</span>
          
          <code class="ruby">    raise ArgumentError, &quot;need member and proposal&quot; unless @member and @proposal</code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="9">
          <span class="hits">52</span>
          
          <code class="ruby">    @organisation = member.organisation</code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="10">
          <span class="hits">52</span>
          
          <code class="ruby">    @organisation_name = member.organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="12">
          <span class="hits">52</span>
          
          <code class="ruby">    @founder = Member.founders(@organisation).first</code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="13">
          <span class="hits">52</span>
          
          <code class="ruby">    raise ArgumentError, &quot;Organisation has no founder&quot; unless @founder</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="15">
          <span class="hits">52</span>
          
          <code class="ruby">    create_mail(@organisation_name, @member.email, &quot;Founding Vote for #{@organisation_name}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">  def notify_creation(member, proposal)</code>
        </li>
      
        <li class="covered" data-hits="258" data-linenumber="19">
          <span class="hits">258</span>
          
          <code class="ruby">    default_url_options[:host] = member.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="258" data-linenumber="21">
          <span class="hits">258</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="covered" data-hits="258" data-linenumber="22">
          <span class="hits">258</span>
          
          <code class="ruby">    @proposal = proposal</code>
        </li>
      
        <li class="covered" data-hits="258" data-linenumber="23">
          <span class="hits">258</span>
          
          <code class="ruby">    raise ArgumentError, &quot;need member and proposal&quot; unless @member and @proposal</code>
        </li>
      
        <li class="covered" data-hits="258" data-linenumber="24">
          <span class="hits">258</span>
          
          <code class="ruby">    @organisation_name = member.organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="258" data-linenumber="26">
          <span class="hits">258</span>
          
          <code class="ruby">    create_mail(@organisation_name, @member.email, &quot;New proposal: #{@proposal.title}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">  def notify_resolution_proposal(member, proposal)</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="30">
          <span class="hits">20</span>
          
          <code class="ruby">    default_url_options[:host] = member.organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="32">
          <span class="hits">20</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="33">
          <span class="hits">20</span>
          
          <code class="ruby">    @proposal = proposal</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="34">
          <span class="hits">20</span>
          
          <code class="ruby">    raise ArgumentError, &quot;need member and proposal&quot; unless @member and @proposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="36">
          <span class="hits">20</span>
          
          <code class="ruby">    @organisation_name = member.organisation.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="38">
          <span class="hits">20</span>
          
          <code class="ruby">    create_mail(@organisation_name, @member.email, &quot;New resolution suggestion: #{@proposal.title}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5eeeaf25157693d384e2535f342e66b2e571fd82">
  <div class="header">
    <h3>app/mailers/share_transaction_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines. 
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ShareTransactionMailer &lt; OcoMailer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def notify_share_application(recipient, share_transaction)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="3">
          <span class="hits">4</span>
          
          <code class="ruby">    @recipient = recipient</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="4">
          <span class="hits">4</span>
          
          <code class="ruby">    @share_transaction = share_transaction</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="6">
          <span class="hits">4</span>
          
          <code class="ruby">    raise ArgumentError, &quot;recipient and share_transaction must be passed&quot; unless @recipient &amp;&amp; @share_transaction</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="8">
          <span class="hits">4</span>
          
          <code class="ruby">    @applicant = @share_transaction.to_account.owner</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="9">
          <span class="hits">4</span>
          
          <code class="ruby">    raise ArgumentError, &quot;could not find applicant from share transaction&quot; unless @applicant</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="11">
          <span class="hits">4</span>
          
          <code class="ruby">    @organisation = @applicant.organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="13">
          <span class="hits">4</span>
          
          <code class="ruby">    default_url_options[:host] = @organisation.domain(:only_host =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="15">
          <span class="hits">4</span>
          
          <code class="ruby">    create_mail(@organisation.name, @recipient.email, &quot;#{@applicant.name} made a new application for shares&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="7109991646102c6dff6ed6700205dc4c5d4493fa">
  <div class="header">
    <h3>app/mailers/test_mailer.rb</h3>
    <h4><span class="red">50.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class TestMailer &lt; OcoMailer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def test_email(address, token=nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3">
          
          
          <code class="ruby">    mail(:to =&gt; address, :subject =&gt; &quot;Test email&quot;, :from =&gt; &quot;&lt;notifications@oneclickorgs.com&gt;&quot;) do |format|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4">
          
          
          <code class="ruby">      format.text { render :text =&gt; &quot;testing: #{Time.now}\ntoken: #{token}&quot; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="1ff3afefca659f070fe5e7bd1dbe18ada63bdfa0">
  <div class="header">
    <h3>app/models/ability.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>51</b> relevant lines. 
      <span class="green"><b>51</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># Translates the permissions associated with a member class into fine-grained</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># permissions for the CRUD actions on each model. Also consolidates checks</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># related to the current status of the organisation.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">class Ability</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  include CanCan::Ability</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  def initialize(user)</code>
        </li>
      
        <li class="covered" data-hits="447" data-linenumber="8">
          <span class="hits">447</span>
          
          <code class="ruby">    return unless user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="397" data-linenumber="10">
          <span class="hits">397</span>
          
          <code class="ruby">    if user.has_permission(:vote)</code>
        </li>
      
        <li class="covered" data-hits="302" data-linenumber="11">
          <span class="hits">302</span>
          
          <code class="ruby">      can :create, Vote</code>
        </li>
      
        <li class="covered" data-hits="302" data-linenumber="12">
          <span class="hits">302</span>
          
          <code class="ruby">      can :vote_on, Proposal do |proposal|</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="13">
          <span class="hits">25</span>
          
          <code class="ruby">        user.eligible_to_vote?(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="397" data-linenumber="17">
          <span class="hits">397</span>
          
          <code class="ruby">    can :update, Member, :id =&gt; user.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="397" data-linenumber="19">
          <span class="hits">397</span>
          
          <code class="ruby">    case user.organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    when Association</code>
        </li>
      
        <li class="covered" data-hits="195" data-linenumber="21">
          <span class="hits">195</span>
          
          <code class="ruby">      if user.has_permission(:freeform_proposal)</code>
        </li>
      
        <li class="covered" data-hits="91" data-linenumber="22">
          <span class="hits">91</span>
          
          <code class="ruby">        can :create, Proposal if !user.organisation.proposed?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="195" data-linenumber="25">
          <span class="hits">195</span>
          
          <code class="ruby">      if user.has_permission(:membership_proposal)</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="26">
          <span class="hits">113</span>
          
          <code class="ruby">        can :create, AddMemberProposal if user.organisation.active?</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="27">
          <span class="hits">113</span>
          
          <code class="ruby">        can :create, ChangeMemberClassProposal</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="28">
          <span class="hits">113</span>
          
          <code class="ruby">        can :create, EjectMemberProposal</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="29">
          <span class="hits">113</span>
          
          <code class="ruby">        can :create, FoundingMember if user.has_permission(:founder) &amp;&amp; user.organisation.pending?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="195" data-linenumber="32">
          <span class="hits">195</span>
          
          <code class="ruby">      if user.has_permission(:constitution_proposal)</code>
        </li>
      
        <li class="covered" data-hits="123" data-linenumber="33">
          <span class="hits">123</span>
          
          <code class="ruby">        can :update, Constitution if user.organisation.pending? &amp;&amp; user.has_permission(:founder)</code>
        </li>
      
        <li class="covered" data-hits="123" data-linenumber="34">
          <span class="hits">123</span>
          
          <code class="ruby">        can :create, ConstitutionProposalBundle if user.organisation.active?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="195" data-linenumber="37">
          <span class="hits">195</span>
          
          <code class="ruby">      if user.has_permission(:found_association_proposal)</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="38">
          <span class="hits">26</span>
          
          <code class="ruby">        can :create, FoundAssociationProposal if user.organisation.pending?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    when Company</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="41">
          <span class="hits">36</span>
          
          <code class="ruby">      if user.has_permission(:freeform_proposal)</code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="42">
          <span class="hits">35</span>
          
          <code class="ruby">        can :create, Proposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="45">
          <span class="hits">36</span>
          
          <code class="ruby">      if user.has_permission(:director)</code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="46">
          <span class="hits">35</span>
          
          <code class="ruby">        can :create, Director</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="49">
          <span class="hits">36</span>
          
          <code class="ruby">      if user.has_permission(:meeting)</code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="50">
          <span class="hits">35</span>
          
          <code class="ruby">        can :read, Meeting</code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="51">
          <span class="hits">35</span>
          
          <code class="ruby">        can :create, Meeting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    when Coop</code>
        </li>
      
        <li class="covered" data-hits="166" data-linenumber="54">
          <span class="hits">166</span>
          
          <code class="ruby">      if user.has_permission(:resolution)</code>
        </li>
      
        <li class="covered" data-hits="116" data-linenumber="55">
          <span class="hits">116</span>
          
          <code class="ruby">        can :create, Resolution</code>
        </li>
      
        <li class="covered" data-hits="116" data-linenumber="56">
          <span class="hits">116</span>
          
          <code class="ruby">        can :edit, ResolutionProposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="166" data-linenumber="59">
          <span class="hits">166</span>
          
          <code class="ruby">      if user.has_permission(:board_resolution)</code>
        </li>
      
        <li class="covered" data-hits="116" data-linenumber="60">
          <span class="hits">116</span>
          
          <code class="ruby">        can :create, BoardResolution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="166" data-linenumber="63">
          <span class="hits">166</span>
          
          <code class="ruby">      if user.has_permission(:resolution_proposal)</code>
        </li>
      
        <li class="covered" data-hits="41" data-linenumber="64">
          <span class="hits">41</span>
          
          <code class="ruby">        can :create, ResolutionProposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="166" data-linenumber="67">
          <span class="hits">166</span>
          
          <code class="ruby">      if user.has_permission(:meeting)</code>
        </li>
      
        <li class="covered" data-hits="116" data-linenumber="68">
          <span class="hits">116</span>
          
          <code class="ruby">        can :create, Meeting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="166" data-linenumber="71">
          <span class="hits">166</span>
          
          <code class="ruby">      if user.has_permission(:constitution) || user.organisation.pending?</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="72">
          <span class="hits">9</span>
          
          <code class="ruby">        can :update, Constitution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="166" data-linenumber="75">
          <span class="hits">166</span>
          
          <code class="ruby">      if user.has_permission(:organisation) || user.organisation.pending?</code>
        </li>
      
        <li class="covered" data-hits="116" data-linenumber="76">
          <span class="hits">116</span>
          
          <code class="ruby">        can :update, Coop do |coop|</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="77">
          <span class="hits">21</span>
          
          <code class="ruby">          user.organisation == coop</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="166" data-linenumber="81">
          <span class="hits">166</span>
          
          <code class="ruby">      if user.has_permission(:founder_member) || user.organisation.pending?</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="82">
          <span class="hits">9</span>
          
          <code class="ruby">        can :create, FounderMember</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="166" data-linenumber="85">
          <span class="hits">166</span>
          
          <code class="ruby">      can :update, Member do |member|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">        user.has_permission(:member) || user == member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="166" data-linenumber="89">
          <span class="hits">166</span>
          
          <code class="ruby">      can :read, GeneralMeeting</code>
        </li>
      
        <li class="covered" data-hits="166" data-linenumber="90">
          <span class="hits">166</span>
          
          <code class="ruby">      can :read, BoardMeeting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="166" data-linenumber="92">
          <span class="hits">166</span>
          
          <code class="ruby">      can :create, ConstitutionProposalBundle</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="166" data-linenumber="94">
          <span class="hits">166</span>
          
          <code class="ruby">      can :create, ShareApplication</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="dba0f2ac2c34b50588d14d7f54627d1edebe3451">
  <div class="header">
    <h3>app/models/add_member_proposal.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>39</b> relevant lines. 
      <span class="green"><b>39</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class AddMemberProposal &lt; MembershipProposal</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :draft_member, :first_name, :last_name, :email, :member_class_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :draft_member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  validate :member_must_not_already_be_active</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_must_not_already_be_active</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="8">
          <span class="hits">19</span>
          
          <code class="ruby">    errors.add(:base, &quot;A member with this email address already exists&quot;) if organisation.members.active.find_by_email(parameters['email'])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">  validate :member_attributes_must_be_valid</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_attributes_must_be_valid</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="13">
          <span class="hits">19</span>
          
          <code class="ruby">    @draft_member = organisation.members.build(parameters, :as =&gt; :proposal)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="14">
          <span class="hits">19</span>
          
          <code class="ruby">    @draft_member.allow_duplicate_email = true</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="15">
          <span class="hits">19</span>
          
          <code class="ruby">    unless @draft_member.valid?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="16">
          <span class="hits">4</span>
          
          <code class="ruby">      @draft_member.errors.each do |attribute, message|</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="17">
          <span class="hits">8</span>
          
          <code class="ruby">        errors.add(attribute, message)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">  before_create :set_default_title</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_title</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="24">
          <span class="hits">11</span>
          
          <code class="ruby">    self.title ||= &quot;Add #{parameters['first_name']} #{parameters['last_name']} as a member of #{organisation.try(:name)}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">  def enact!</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="28">
          <span class="hits">4</span>
          
          <code class="ruby">    @existing_member = organisation.members.inactive.find_by_email(parameters['email'])</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="29">
          <span class="hits">4</span>
          
          <code class="ruby">    if @existing_member</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">      @existing_member.reactivate!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="32">
          <span class="hits">3</span>
          
          <code class="ruby">      member = organisation.members.build(parameters)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="33">
          <span class="hits">3</span>
          
          <code class="ruby">      member.send_welcome = true</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="34">
          <span class="hits">3</span>
          
          <code class="ruby">      member.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">  def email</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="39">
          <span class="hits">45</span>
          
          <code class="ruby">    parameters['email']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>
          
          <code class="ruby">  def email=(email)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="43">
          <span class="hits">11</span>
          
          <code class="ruby">    self.parameters['email'] = email</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="46">
          <span class="hits">2</span>
          
          <code class="ruby">  def first_name</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="47">
          <span class="hits">45</span>
          
          <code class="ruby">    parameters['first_name']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="50">
          <span class="hits">2</span>
          
          <code class="ruby">  def first_name=(first_name)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="51">
          <span class="hits">11</span>
          
          <code class="ruby">    self.parameters['first_name'] = first_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="54">
          <span class="hits">2</span>
          
          <code class="ruby">  def last_name</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="55">
          <span class="hits">45</span>
          
          <code class="ruby">    parameters['last_name']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="58">
          <span class="hits">2</span>
          
          <code class="ruby">  def last_name=(last_name)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="59">
          <span class="hits">11</span>
          
          <code class="ruby">    self.parameters['last_name'] = last_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="62">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_class_id</code>
        </li>
      
        <li class="covered" data-hits="89" data-linenumber="63">
          <span class="hits">89</span>
          
          <code class="ruby">    parameters['member_class_id']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="66">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_class_id=(member_class_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">    self.parameters['member_class_id'] = member_class_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="9dcc13f30dbdee4533f24692ead618d2b7b9b6b0">
  <div class="header">
    <h3>app/models/administrator.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/user_authentication'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">class Administrator &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  include OneClickOrgs::UserAuthentication</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="6d564e64a6e054472a084a19da3f521e5930b59a">
  <div class="header">
    <h3>app/models/annual_general_meeting.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class AnnualGeneralMeeting &lt; GeneralMeeting</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :electronic_voting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  has_one :election, :foreign_key =&gt; 'meeting_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  after_create :create_election_if_necessary</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  def create_election_if_necessary</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="8">
          <span class="hits">10</span>
          
          <code class="ruby">    return if election</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="9">
          <span class="hits">10</span>
          
          <code class="ruby">    return unless electronic_nominations || electronic_voting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="11">
          <span class="hits">8</span>
          
          <code class="ruby">    build_election(:organisation =&gt; organisation)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="13">
          <span class="hits">8</span>
          
          <code class="ruby">    if electronic_nominations &amp;&amp; nominations_closing_date</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">      election.nominations_closing_date = nominations_closing_date</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="17">
          <span class="hits">8</span>
          
          <code class="ruby">    if electronic_voting &amp;&amp; voting_closing_date</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">      election.voting_closing_date = voting_closing_date</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="21">
          <span class="hits">8</span>
          
          <code class="ruby">    election.seats = organisation.directors_retiring.count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="23">
          <span class="hits">8</span>
          
          <code class="ruby">    election.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="1e1deb38ffd012469cbd2c52e8be32d4ca2c4723">
  <div class="header">
    <h3>app/models/association.rb</h3>
    <h4><span class="green">96.59 %</span> covered</h4>
    <div>
      <b>88</b> relevant lines. 
      <span class="green"><b>85</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class Association &lt; Organisation</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  state_machine :initial =&gt; :pending do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">    event :propose do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">      transition :pending =&gt; :proposed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">    event :found do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">      transition :proposed =&gt; :active</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">    event :reject_founding do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">      transition :proposed =&gt; :pending</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">    after_transition :proposed =&gt; :active, :do =&gt; :destroy_pending_state_member_classes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  # Need to add the subclasses individually so that we can do things like:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  #   co.add_member_proposals.create(...)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  # to create a properly-scoped AddMemberProposal.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :add_member_proposals            , :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :change_member_class_proposals   , :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :change_voting_period_proposals  , :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :change_voting_system_proposals  , :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :eject_member_proposals          , :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :found_association_proposals     , :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_presence_of :objectives</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">  def objectives</code>
        </li>
      
        <li class="covered" data-hits="353" data-linenumber="31">
          <span class="hits">353</span>
          
          <code class="ruby">    @objectives ||= clauses.get_text('organisation_objectives')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">  def objectives=(objectives)</code>
        </li>
      
        <li class="covered" data-hits="240" data-linenumber="35">
          <span class="hits">240</span>
          
          <code class="ruby">    clauses.build(:name =&gt; 'organisation_objectives', :text_value =&gt; objectives)</code>
        </li>
      
        <li class="covered" data-hits="240" data-linenumber="36">
          <span class="hits">240</span>
          
          <code class="ruby">    @objectives = objectives</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="39">
          <span class="hits">2</span>
          
          <code class="ruby">  def assets</code>
        </li>
      
        <li class="covered" data-hits="83" data-linenumber="40">
          <span class="hits">83</span>
          
          <code class="ruby">    @assets ||= clauses.get_boolean('assets')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="43">
          <span class="hits">2</span>
          
          <code class="ruby">  def assets=(assets)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    clauses.build(:name =&gt; 'assets', :boolean_value =&gt; assets)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">    @assets = assets</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="48">
          <span class="hits">2</span>
          
          <code class="ruby">  def convener</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="49">
          <span class="hits">9</span>
          
          <code class="ruby">    members.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  # Delete Founder and Founding Member member classes</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="53">
          <span class="hits">2</span>
          
          <code class="ruby">  def destroy_pending_state_member_classes</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="54">
          <span class="hits">8</span>
          
          <code class="ruby">    member_classes.find_by_name('Founder').destroy</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="55">
          <span class="hits">8</span>
          
          <code class="ruby">    member_classes.find_by_name('Founding Member').destroy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="58">
          <span class="hits">2</span>
          
          <code class="ruby">  def can_hold_founding_vote?</code>
        </li>
      
        <li class="covered" data-hits="164" data-linenumber="59">
          <span class="hits">164</span>
          
          <code class="ruby">    pending? &amp;&amp; members.count &gt;= minimum_members_required_for_founding_vote</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="62">
          <span class="hits">2</span>
          
          <code class="ruby">  def minimum_members_required_for_founding_vote</code>
        </li>
      
        <li class="covered" data-hits="49" data-linenumber="63">
          <span class="hits">49</span>
          
          <code class="ruby">    3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="66">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_eligible_to_vote?(member, proposal)</code>
        </li>
      
        <li class="covered" data-hits="141" data-linenumber="67">
          <span class="hits">141</span>
          
          <code class="ruby">    return true if proposed?</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="68">
          <span class="hits">88</span>
          
          <code class="ruby">    member.inducted? &amp;&amp; proposal.creation_date &gt;= member.inducted_at</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="71">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_count_for_proposal(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">    # TODO: find out how to do the following in one query</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="73">
          <span class="hits">10</span>
          
          <code class="ruby">    count = 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">    # To vote, a member must be inducted, and must have been added (created)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">    # before this proposal was made.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">    # Members who were founding members are an exception. They are allowed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">    # to vote in proposals before they have been inducted.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">    # (This is because, by participating in the founding vote, they have</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">    # already agreed to the constitution.)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">    # We determine who was a founding member by seeing whether they were</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">    # created before the FoundAssociationProposal for this org.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="85">
          <span class="hits">10</span>
          
          <code class="ruby">    fap = found_association_proposals.last</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="86">
          <span class="hits">10</span>
          
          <code class="ruby">    if fap</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">      members.where(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">        &quot;(state = 'active' AND created_at &lt; :proposal_creation_date) &quot; +</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">        &quot;OR (state &lt;&gt; 'inactive' and created_at &lt; :founding_date)&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">        :proposal_creation_date =&gt; proposal.creation_date,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">        :founding_date =&gt; fap.creation_date</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">      ).each do |m|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="93">
          <span class="hits">3</span>
          
          <code class="ruby">        count += 1 if m.has_permission(:vote)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">      # FIXME This 'if' branch is checking for the case where there is no</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">      # FoundAssociationProposal yet, so shouldn't it be including members</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">      # who haven't been inducted yet (since no member gets inducted during</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">      # the pending state of the organisation)?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">      #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">      # Suspect that this is only working because FoundAssociationProposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">      # overrides #member_count, so this branch never really gets executed.</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="103">
          <span class="hits">9</span>
          
          <code class="ruby">      members.active.where(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">        &quot;created_at &lt; :proposal_creation_date&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">        :proposal_creation_date =&gt; proposal.creation_date</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">      ).each do |m|</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="107">
          <span class="hits">36</span>
          
          <code class="ruby">        count += 1 if m.has_permission(:vote)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="110">
          <span class="hits">10</span>
          
          <code class="ruby">    count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="113">
          <span class="hits">2</span>
          
          <code class="ruby">  def welcome_email_action</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="114">
          <span class="hits">10</span>
          
          <code class="ruby">    if pending?</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="115">
          <span class="hits">5</span>
          
          <code class="ruby">      :welcome_new_founding_member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="117">
          <span class="hits">5</span>
          
          <code class="ruby">      :welcome_new_member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="121">
          <span class="hits">2</span>
          
          <code class="ruby">  def create_default_member_classes</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="122">
          <span class="hits">237</span>
          
          <code class="ruby">    members = member_classes.find_or_create_by_name('Member')</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="123">
          <span class="hits">237</span>
          
          <code class="ruby">    members.set_permission!(:constitution_proposal, true)</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="124">
          <span class="hits">237</span>
          
          <code class="ruby">    members.set_permission!(:membership_proposal, true)</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="125">
          <span class="hits">237</span>
          
          <code class="ruby">    members.set_permission!(:freeform_proposal, true)</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="126">
          <span class="hits">237</span>
          
          <code class="ruby">    members.set_permission!(:vote, true)</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="127">
          <span class="hits">237</span>
          
          <code class="ruby">    members.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="129">
          <span class="hits">237</span>
          
          <code class="ruby">    founder = member_classes.find_or_create_by_name('Founder')</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="130">
          <span class="hits">237</span>
          
          <code class="ruby">    founder.set_permission!(:founder, true)</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="131">
          <span class="hits">237</span>
          
          <code class="ruby">    founder.set_permission!(:constitution_proposal, true)</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="132">
          <span class="hits">237</span>
          
          <code class="ruby">    founder.set_permission!(:membership_proposal, true)</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="133">
          <span class="hits">237</span>
          
          <code class="ruby">    founder.set_permission!(:freeform_proposal, true)</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="134">
          <span class="hits">237</span>
          
          <code class="ruby">    founder.set_permission!(:found_association_proposal, true)</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="135">
          <span class="hits">237</span>
          
          <code class="ruby">    founder.set_permission!(:vote, true)</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="136">
          <span class="hits">237</span>
          
          <code class="ruby">    founder.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="138">
          <span class="hits">237</span>
          
          <code class="ruby">    founding_member = member_classes.find_or_create_by_name('Founding Member')</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="139">
          <span class="hits">237</span>
          
          <code class="ruby">    founding_member.set_permission!(:founder, false)</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="140">
          <span class="hits">237</span>
          
          <code class="ruby">    founding_member.set_permission!(:constitution_proposal, false)</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="141">
          <span class="hits">237</span>
          
          <code class="ruby">    founding_member.set_permission!(:membership_proposal, false)</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="142">
          <span class="hits">237</span>
          
          <code class="ruby">    founding_member.set_permission!(:freeform_proposal, false)</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="143">
          <span class="hits">237</span>
          
          <code class="ruby">    founding_member.set_permission!(:found_association_proposal, false)</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="144">
          <span class="hits">237</span>
          
          <code class="ruby">    founding_member.set_permission!(:vote, true)</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="145">
          <span class="hits">237</span>
          
          <code class="ruby">    founding_member.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="148">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_voting_systems</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="149">
          <span class="hits">237</span>
          
          <code class="ruby">    constitution.set_voting_system(:general, 'RelativeMajority')</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="150">
          <span class="hits">237</span>
          
          <code class="ruby">    constitution.set_voting_system(:membership, 'Veto')</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="151">
          <span class="hits">237</span>
          
          <code class="ruby">    constitution.set_voting_system(:constitution, 'AbsoluteTwoThirdsMajority')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="154">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_voting_period</code>
        </li>
      
        <li class="covered" data-hits="237" data-linenumber="155">
          <span class="hits">237</span>
          
          <code class="ruby">    constitution.set_voting_period(259200)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">  # FAKE ASSOCIATIONS</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="160">
          <span class="hits">2</span>
          
          <code class="ruby">  def founding_members</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">    members.founding_members(self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="164">
          <span class="hits">2</span>
          
          <code class="ruby">  def build_founding_member(attributes={})</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="165">
          <span class="hits">11</span>
          
          <code class="ruby">    FoundingMember.new(attributes).tap{|m|</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="166">
          <span class="hits">11</span>
          
          <code class="ruby">      m.organisation = self</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="167">
          <span class="hits">11</span>
          
          <code class="ruby">      m.member_class = member_classes.find_by_name(&quot;Founding Member&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="171">
          <span class="hits">2</span>
          
          <code class="ruby">  def terms_and_conditions_required?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="172">
          <span class="hits">14</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="2653c7b61f9baad893feb0dd69c7183ff665e943">
  <div class="header">
    <h3>app/models/ballot.rb</h3>
    <h4><span class="green">96.3 %</span> covered</h4>
    <div>
      <b>27</b> relevant lines. 
      <span class="green"><b>26</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># Represents a single 'ballot paper' in an election. To vote, a member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># ranks any number of nominees in order of preference.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># This ranking is stored in the attribute 'ranking', as an array of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"># Nomination IDs.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">class Ballot &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  serialize :ranking, Array</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">  def ranking</code>
        </li>
      
        <li class="covered" data-hits="54" data-linenumber="14">
          <span class="hits">54</span>
          
          <code class="ruby">    self[:ranking] ||= []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  def method_missing(name, *args, &amp;block)</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="18">
          <span class="hits">16</span>
          
          <code class="ruby">    if name.to_s.match(/\Aranking_\d+=?\Z/)</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="19">
          <span class="hits">16</span>
          
          <code class="ruby">      handle_ranking_method(name, *args)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">      super</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">  def respond_to?(name, include_priv=false)</code>
        </li>
      
        <li class="covered" data-hits="434" data-linenumber="26">
          <span class="hits">434</span>
          
          <code class="ruby">    if name.to_s.match(/\Aranking_\d+=?\Z/)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="27">
          <span class="hits">7</span>
          
          <code class="ruby">      true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="427" data-linenumber="29">
          <span class="hits">427</span>
          
          <code class="ruby">      super</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">  def handle_ranking_method(name, *args)</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="34">
          <span class="hits">16</span>
          
          <code class="ruby">    if name.to_s.match(/=\Z/)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="35">
          <span class="hits">10</span>
          
          <code class="ruby">      handle_ranking_setter_method(name, *args)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="37">
          <span class="hits">6</span>
          
          <code class="ruby">      handle_ranking_getter_method(name, *args)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">  def handle_ranking_setter_method(name, *args)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="42">
          <span class="hits">10</span>
          
          <code class="ruby">    nomination_id = name.to_s.match(/\Aranking_(.*?)=\Z/)[1].to_i</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="43">
          <span class="hits">10</span>
          
          <code class="ruby">    ranking_position = args[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="45">
          <span class="hits">10</span>
          
          <code class="ruby">    unless ranking_position.blank?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="46">
          <span class="hits">7</span>
          
          <code class="ruby">      self.ranking[ranking_position.to_i - 1] = nomination_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="49">
          <span class="hits">10</span>
          
          <code class="ruby">    ranking_position</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="52">
          <span class="hits">2</span>
          
          <code class="ruby">  def handle_ranking_getter_method(name, *args)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="53">
          <span class="hits">6</span>
          
          <code class="ruby">    nomination_id = name.to_s.match(/\Aranking_(.*?)\Z/)[1].to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="55">
          <span class="hits">6</span>
          
          <code class="ruby">    self.ranking.find_index(nomination_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="bfb4658584deca3bc01ce23fe760705c0b097356">
  <div class="header">
    <h3>app/models/board_meeting.rb</h3>
    <h4><span class="yellow">87.5 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines. 
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class BoardMeeting &lt; Meeting</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :start_time, :venue, :agenda</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def creation_notification_email_action</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="5">
          <span class="hits">5</span>
          
          <code class="ruby">    :notify_board_meeting_creation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  def members_to_notify</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="9">
          <span class="hits">4</span>
          
          <code class="ruby">    organisation.directors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def to_event</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    {:timestamp =&gt; created_at, :object =&gt; self, :kind =&gt; :board_meeting}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="8ba260168da40660dbc0ccbfc32557208a064c2e">
  <div class="header">
    <h3>app/models/board_resolution.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class BoardResolution &lt; Resolution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b9a94b8d2015510824d131b4a2f6f2c0f920945c">
  <div class="header">
    <h3>app/models/change_boolean_proposal.rb</h3>
    <h4><span class="red">58.33 %</span> covered</h4>
    <div>
      <b>12</b> relevant lines. 
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># Represents a proposal to change one of the boolean fields</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># in the constitution; e.g. the assets-holding</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">class ChangeBooleanProposal &lt; ConstitutionProposal</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :name, :value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def enact!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    organisation.clauses.set_boolean!(parameters['name'], parameters['value'])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  def name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    parameters['name']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">  def name=(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    parameters['name'] = name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">  def value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    parameters['value']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">  def value=(value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">    parameters['value'] = value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="203373be251d19a6bb5c42695582c2b6ef404f1c">
  <div class="header">
    <h3>app/models/change_boolean_resolution.rb</h3>
    <h4><span class="red">75.0 %</span> covered</h4>
    <div>
      <b>12</b> relevant lines. 
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ChangeBooleanResolution &lt; Resolution</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :name, :value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def enact!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    organisation.clauses.set_boolean!(parameters['name'], parameters['value'])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  def name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">    parameters['name']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def name=(name)</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="13">
          <span class="hits">50</span>
          
          <code class="ruby">    parameters['name'] = name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">  def value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    parameters['value']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">  def value=(value)</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="21">
          <span class="hits">50</span>
          
          <code class="ruby">    parameters['value'] = value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3e7c6d5c459a9070168da011e41b952da45e79ce">
  <div class="header">
    <h3>app/models/change_integer_resolution.rb</h3>
    <h4><span class="red">77.78 %</span> covered</h4>
    <div>
      <b>18</b> relevant lines. 
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ChangeIntegerResolution &lt; Resolution</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :name, :value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  before_create :set_default_title</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_title</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="6">
          <span class="hits">50</span>
          
          <code class="ruby">    self.title ||= &quot;Change #{name.humanize.downcase} to #{value}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  def enact!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    organisation.clauses.set_integer!(parameters['name'], parameters['value'])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_each :parameters do |record, attribute, value|</code>
        </li>
      
        <li class="covered" data-hits="100" data-linenumber="14">
          <span class="hits">100</span>
          
          <code class="ruby">    if Clause.get_integer(record.parameters['name']) == record.parameters['value']</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">      record.errors.add :base, &quot;Proposal does not change the current clause&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">  def name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    parameters['name']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">  def name=(name)</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="24">
          <span class="hits">50</span>
          
          <code class="ruby">    parameters['name'] = name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">  def value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    parameters['value']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">  def value=(value)</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="32">
          <span class="hits">50</span>
          
          <code class="ruby">    parameters['value'] = value.to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="43140d21695ba5605f2c99e87e17bb98f54e744e">
  <div class="header">
    <h3>app/models/change_meeting_notice_period_resolution.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>12</b> relevant lines. 
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ChangeMeetingNoticePeriodResolution &lt; Resolution</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :pass_immediately, :meeting_notice_period</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def meeting_notice_period</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="5">
          <span class="hits">14</span>
          
          <code class="ruby">    parameters['meeting_notice_period']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  def meeting_notice_period=(meeting_notice_period)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="9">
          <span class="hits">10</span>
          
          <code class="ruby">    self.parameters['meeting_notice_period'] = meeting_notice_period.to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_title</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="13">
          <span class="hits">7</span>
          
          <code class="ruby">    self.title ||= &quot;Change notice period for General Meetings to #{meeting_notice_period} clear days&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">  def enact!</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="17">
          <span class="hits">3</span>
          
          <code class="ruby">    organisation.constitution.meeting_notice_period = parameters['meeting_notice_period']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">  def notice_period_increased?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="21">
          <span class="hits">4</span>
          
          <code class="ruby">    meeting_notice_period &gt; organisation.constitution.meeting_notice_period</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="7475991df5a4f50562fba163c744abc3ca79a053">
  <div class="header">
    <h3>app/models/change_member_class_proposal.rb</h3>
    <h4><span class="yellow">82.14 %</span> covered</h4>
    <div>
      <b>28</b> relevant lines. 
      <span class="green"><b>23</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ChangeMemberClassProposal &lt; MembershipProposal</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :member_id, :member_class_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  validate :member_must_exist</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_must_exist</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="6">
          <span class="hits">6</span>
          
          <code class="ruby">    errors.add(:member, &quot;does not exist&quot;) unless organisation.members.exists?(parameters['member_id'])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  validate :member_class_must_exist</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_class_must_exist</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="11">
          <span class="hits">6</span>
          
          <code class="ruby">    errors.add(:member_class, &quot;does not exist&quot;) unless organisation.member_classes.exists?(parameters['member_class_id'])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">  def enact!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    # TODO: Needs backwards compatibility; previously stored the member's ID in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    # the 'id' key, not 'member_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    member = organisation.members.find(parameters['member_id']) # TODO verify that this member still exists</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    mc = organisation.member_classes.find(parameters['member_class_id']) # TODO verify that this member class still exists</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    member.member_class = mc</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">    member.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">  before_create :set_default_title</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_title</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="26">
          <span class="hits">6</span>
          
          <code class="ruby">    member = organisation.members.find(parameters['member_id'])</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="27">
          <span class="hits">6</span>
          
          <code class="ruby">    member_class = organisation.member_classes.find(parameters['member_class_id'])</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="28">
          <span class="hits">6</span>
          
          <code class="ruby">    self.title ||= &quot;Change member class of #{member.name} from #{member.member_class.name} to #{member_class.name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_id</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="32">
          <span class="hits">6</span>
          
          <code class="ruby">    parameters['member_id']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_id=(member_id)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="36">
          <span class="hits">6</span>
          
          <code class="ruby">    parameters['member_id'] = member_id.to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="39">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_class_id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">    parameters['member_class_id']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="43">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_class_id=(member_class_id)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="44">
          <span class="hits">6</span>
          
          <code class="ruby">    parameters['member_class_id'] = member_class_id.to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="47">
          <span class="hits">2</span>
          
          <code class="ruby">  def member</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="48">
          <span class="hits">6</span>
          
          <code class="ruby">    organisation.members.find(member_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="817885978429f8334680c7a00911f086c114fda2">
  <div class="header">
    <h3>app/models/change_quorum_resolution.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>15</b> relevant lines. 
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ChangeQuorumResolution &lt; ExtraordinaryResolution</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :pass_immediately, :quorum_number, :quorum_percentage</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def quorum_number</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="5">
          <span class="hits">6</span>
          
          <code class="ruby">    parameters['quorum_number']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  def quorum_number=(new_quorum_number)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="9">
          <span class="hits">7</span>
          
          <code class="ruby">    self.parameters['quorum_number'] = new_quorum_number.to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def quorum_percentage</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="13">
          <span class="hits">6</span>
          
          <code class="ruby">    parameters['quorum_percentage']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">  def quorum_percentage=(new_quorum_percentage)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="17">
          <span class="hits">7</span>
          
          <code class="ruby">    self.parameters['quorum_percentage'] = new_quorum_percentage.to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_title</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="21">
          <span class="hits">6</span>
          
          <code class="ruby">    self.title ||= &quot;Change quorum for General Meetings to the greater of #{quorum_number} members or #{quorum_percentage}% of the membership&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">  def enact!</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="25">
          <span class="hits">3</span>
          
          <code class="ruby">    organisation.constitution.quorum_number = parameters['quorum_number']</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="26">
          <span class="hits">3</span>
          
          <code class="ruby">    organisation.constitution.quorum_percentage = parameters['quorum_percentage']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="85976b46305e321d6cdfa185d1cc76938b101b73">
  <div class="header">
    <h3>app/models/change_text_proposal.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>18</b> relevant lines. 
      <span class="green"><b>18</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># Represents a proposal to change one of the free-text fields</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># in the constitution; e.g. the organisation name, or the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># organisation objectives.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">class ChangeTextProposal &lt; ConstitutionProposal</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :name, :value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  before_create :set_default_title</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_title</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="9">
          <span class="hits">3</span>
          
          <code class="ruby">    self.title ||= &quot;Change #{name.humanize.downcase} to '#{value}'&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def enact!</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">    organisation.clauses.set_text!(parameters['name'], parameters['value'])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_each :parameters do |record, attribute, value|</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="17">
          <span class="hits">8</span>
          
          <code class="ruby">    if Clause.get_text(record.parameters['name']) == record.parameters['value']</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">      record.errors.add :base, &quot;Proposal does not change the current clause&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">  def name</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">    parameters['name']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">  def name=(name)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">    parameters['name'] = name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">  def value</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">    parameters['value']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">  def value=(value)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">    parameters['value'] = value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b59be7f7b996c37290f96d3b17ebbaf1a2752dca">
  <div class="header">
    <h3>app/models/change_text_resolution.rb</h3>
    <h4><span class="green">94.44 %</span> covered</h4>
    <div>
      <b>18</b> relevant lines. 
      <span class="green"><b>17</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ChangeTextResolution &lt; Resolution</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :name, :value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  before_create :set_default_title</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_title</code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="6">
          <span class="hits">46</span>
          
          <code class="ruby">    self.title ||= &quot;Change #{name.humanize.downcase} to '#{value}'&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  def enact!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">    organisation.clauses.set_text!(parameters['name'], parameters['value'])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_each :parameters do |record, attribute, value|</code>
        </li>
      
        <li class="covered" data-hits="56" data-linenumber="14">
          <span class="hits">56</span>
          
          <code class="ruby">    if Clause.get_text(record.parameters['name']) == record.parameters['value']</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">      record.errors.add :base, &quot;Proposal does not change the current clause&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">  def name</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="20">
          <span class="hits">36</span>
          
          <code class="ruby">    parameters['name']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">  def name=(name)</code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="24">
          <span class="hits">46</span>
          
          <code class="ruby">    parameters['name'] = name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">  def value</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="28">
          <span class="hits">36</span>
          
          <code class="ruby">    parameters['value']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">  def value=(value)</code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="32">
          <span class="hits">46</span>
          
          <code class="ruby">    parameters['value'] = value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="aac5f15215973379cd0ac0d0c1cccb88ab0c409d">
  <div class="header">
    <h3>app/models/change_voting_period_proposal.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># Represents a proposal to change the voting period for propsosals.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">class ChangeVotingPeriodProposal &lt; ConstitutionProposal</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :new_voting_period</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  before_create :set_default_title</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_title</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">    self.title ||= &quot;Change voting period to #{VotingPeriods.name_for_value(new_voting_period)}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  def enact!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">    organisation.constitution.change_voting_period(parameters['new_voting_period'].to_i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">  def new_voting_period</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">    parameters['new_voting_period']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">  def new_voting_period=(new_voting_period)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    parameters['new_voting_period'] = new_voting_period</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="87d2e9aac60a7952a3618ae3df75d4762fad1d5a">
  <div class="header">
    <h3>app/models/change_voting_system_proposal.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>15</b> relevant lines. 
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ChangeVotingSystemProposal &lt; ConstitutionProposal</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :proposal_type, :proposed_system</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  before_create :set_default_title</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_title</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="6">
          <span class="hits">3</span>
          
          <code class="ruby">    self.title ||= &quot;Change #{proposal_type.humanize.downcase} voting system to #{VotingSystems.get(proposed_system).description}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  def enact!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    # TODO needs backwards compatiblity; previous proposals used 'type' instead of 'proposal_type'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">    organisation.constitution.change_voting_system(parameters['proposal_type'], parameters['proposed_system'])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">  def proposal_type</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="15">
          <span class="hits">3</span>
          
          <code class="ruby">    parameters['proposal_type']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">  def proposal_type=(proposal_type)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="19">
          <span class="hits">3</span>
          
          <code class="ruby">    parameters['proposal_type'] = proposal_type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">  def proposed_system</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="23">
          <span class="hits">3</span>
          
          <code class="ruby">    parameters['proposed_system']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">  def proposed_system=(proposed_system)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="27">
          <span class="hits">3</span>
          
          <code class="ruby">    parameters['proposed_system'] = proposed_system</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="de666b7a4b1a2be96e7d217f573b9437aa28305c">
  <div class="header">
    <h3>app/models/clause.rb</h3>
    <h4><span class="green">93.18 %</span> covered</h4>
    <div>
      <b>44</b> relevant lines. 
      <span class="green"><b>41</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># Represents the clauses in the constitution which may be modified by the user.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># The current necessary clauses are:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"># Name                        Value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"># organisation_name           String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"># organisation_objectives     String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"># assets                      Boolean</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"># voting_period               Integer representing one of the options</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"># general_voting_system       String -- the class name of the VotingSystem in use</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"># membership_voting_system    String -- the class name of the VotingSystem in use</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"># constitution_voting_system  String -- the class name of the VotingSystem in use</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">class Clause &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :name, :text_value, :integer_value, :boolean_value, :decimal_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_presence_of :name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  # TODO: validate presence of exactly one of the value columns</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">  validate(:on =&gt; :create) do |c|</code>
        </li>
      
        <li class="covered" data-hits="13959" data-linenumber="22">
          <span class="hits">13959</span>
          
          <code class="ruby">    if [c.boolean_value, c.integer_value, c.text_value, c.decimal_value].all?(&amp;:nil?)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">      errors.add('One of boolean_value, integer_value or text_value', 'cannot be empty')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">  scope :current, where('ended_at IS NULL')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">  before_create :set_started_at</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_started_at</code>
        </li>
      
        <li class="covered" data-hits="11262" data-linenumber="32">
          <span class="hits">11262</span>
          
          <code class="ruby">    self.started_at ||= Time.now.utc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">  public</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  # Returns the currently active clause for the given name.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="37">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.get_current(name)</code>
        </li>
      
        <li class="covered" data-hits="5440" data-linenumber="38">
          <span class="hits">5440</span>
          
          <code class="ruby">    current.where([&quot;name = ? AND started_at &lt;= ?&quot;, name, Time.now.utc]).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">  after_create :end_previous</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  # Finds the previous open clauses for this name, and ends them.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="44">
          <span class="hits">2</span>
          
          <code class="ruby">  def end_previous</code>
        </li>
      
        <li class="covered" data-hits="11262" data-linenumber="45">
          <span class="hits">11262</span>
          
          <code class="ruby">    organisation.clauses.current.where([&quot;name = ? AND id != ?&quot;, name, self.id]).update_all(:ended_at =&gt; Time.now.utc)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="47">
          <span class="hits">2</span>
          
          <code class="ruby">  public</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="49">
          <span class="hits">2</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">    &quot;#{name}: #{text_value || integer_value || boolean_value}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="53">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.currently_exists?(name)</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="54">
          <span class="hits">13</span>
          
          <code class="ruby">    !!get_current(name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="57">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.set_text!(name, value)</code>
        </li>
      
        <li class="covered" data-hits="833" data-linenumber="58">
          <span class="hits">833</span>
          
          <code class="ruby">    create!(:name =&gt; name.to_s, :text_value =&gt; value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="61">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.get_text(name)</code>
        </li>
      
        <li class="covered" data-hits="1295" data-linenumber="62">
          <span class="hits">1295</span>
          
          <code class="ruby">    v = get_current(name.to_s)</code>
        </li>
      
        <li class="covered" data-hits="1295" data-linenumber="63">
          <span class="hits">1295</span>
          
          <code class="ruby">    (v ? v.text_value : nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="66">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.set_boolean!(name, value)</code>
        </li>
      
        <li class="covered" data-hits="6975" data-linenumber="67">
          <span class="hits">6975</span>
          
          <code class="ruby">    create!(:name =&gt; name.to_s, :boolean_value =&gt; value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="70">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.get_boolean(name)</code>
        </li>
      
        <li class="covered" data-hits="3312" data-linenumber="71">
          <span class="hits">3312</span>
          
          <code class="ruby">    v = get_current(name.to_s)</code>
        </li>
      
        <li class="covered" data-hits="3312" data-linenumber="72">
          <span class="hits">3312</span>
          
          <code class="ruby">    (v ? v.boolean_value? : nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="75">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.set_integer!(name, value)</code>
        </li>
      
        <li class="covered" data-hits="753" data-linenumber="76">
          <span class="hits">753</span>
          
          <code class="ruby">    create!(:name =&gt; name.to_s, :integer_value =&gt; value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="79">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.get_integer(name)</code>
        </li>
      
        <li class="covered" data-hits="580" data-linenumber="80">
          <span class="hits">580</span>
          
          <code class="ruby">    v = get_current(name.to_s)</code>
        </li>
      
        <li class="covered" data-hits="580" data-linenumber="81">
          <span class="hits">580</span>
          
          <code class="ruby">    (v ? v.integer_value : nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="84">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.set_decimal!(name, value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">    create!(:name =&gt; name.to_s, :decimal_value =&gt; value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="88">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.get_decimal(name)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="89">
          <span class="hits">9</span>
          
          <code class="ruby">    v = get_current(name.to_s)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="90">
          <span class="hits">9</span>
          
          <code class="ruby">    (v ? v.decimal_value : nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3de55437c663abd4625d2c2edee6d4c07faf19de">
  <div class="header">
    <h3>app/models/comment.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class Comment &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :body</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  default_scope order(&quot;created_at ASC&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :commentable, :polymorphic =&gt; true</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :author, :class_name =&gt; 'Member', :foreign_key =&gt; 'author_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b59d362145d47440f82b0537dc6a669de968bb5c">
  <div class="header">
    <h3>app/models/company.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>25</b> relevant lines. 
      <span class="green"><b>25</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class Company &lt; Organisation</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :meetings, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :directors, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_eligible_to_vote?(member, proposal)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="7">
          <span class="hits">8</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_count_for_proposal(proposal)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">    directors.active.count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">  def welcome_email_action</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="15">
          <span class="hits">3</span>
          
          <code class="ruby">    :welcome_new_director</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">  def create_default_member_classes</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="19">
          <span class="hits">42</span>
          
          <code class="ruby">    directors = member_classes.find_or_create_by_name('Director')</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="20">
          <span class="hits">42</span>
          
          <code class="ruby">    directors.set_permission!(:freeform_proposal, true)</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="21">
          <span class="hits">42</span>
          
          <code class="ruby">    directors.set_permission!(:vote, true)</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="22">
          <span class="hits">42</span>
          
          <code class="ruby">    directors.set_permission!(:director, true)</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="23">
          <span class="hits">42</span>
          
          <code class="ruby">    directors.set_permission!(:meeting, true)</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="24">
          <span class="hits">42</span>
          
          <code class="ruby">    directors.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_voting_systems</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="28">
          <span class="hits">42</span>
          
          <code class="ruby">    constitution.set_voting_system(:general, 'AbsoluteMajority')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_voting_period</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="32">
          <span class="hits">42</span>
          
          <code class="ruby">    constitution.set_voting_period(604800)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">  def build_director(attributes={})</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="36">
          <span class="hits">3</span>
          
          <code class="ruby">    Director.new(attributes).tap{|m|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="37">
          <span class="hits">3</span>
          
          <code class="ruby">      m.organisation = self</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="38">
          <span class="hits">3</span>
          
          <code class="ruby">      m.member_class = member_classes.find_by_name(&quot;Director&quot;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="39">
          <span class="hits">3</span>
          
          <code class="ruby">      m.state = 'active'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="4e778582d730ea196e015f33762acc45835d12da">
  <div class="header">
    <h3>app/models/constitution.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>26</b> relevant lines. 
      <span class="green"><b>26</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># Constitution is a convenience class that provides methods for getting and setting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># constitution-related aspects of an organisation.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># Typically, you'll let your Organisation object set up the Constitution object</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"># for you, e.g.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"># </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">#   organisation.constitution.change_voting_system(:general, 'RelativeMajority')</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">class Constitution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  def initialize(organisation)</code>
        </li>
      
        <li class="covered" data-hits="735" data-linenumber="11">
          <span class="hits">735</span>
          
          <code class="ruby">    @organisation = organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">  def organisation</code>
        </li>
      
        <li class="covered" data-hits="2250" data-linenumber="15">
          <span class="hits">2250</span>
          
          <code class="ruby">    @organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">  delegate :name, :objectives, :assets, :domain,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    :meeting_notice_period, :meeting_notice_period=,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    :quorum_number, :quorum_number=,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    :quorum_percentage, :quorum_percentage=,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    :registered_office_address,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    :user_members, :employee_members, :supporter_members, :producer_members, :consumer_members,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    :single_shareholding,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    :max_user_directors, :max_employee_directors, :max_supporter_directors, :max_producer_directors, :max_consumer_directors,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    :common_ownership, :to =&gt; :organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">  alias_method :organisation_name, :name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  # VOTING SYSTEMS</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">  def voting_system(type = :general)     </code>
        </li>
      
        <li class="covered" data-hits="230" data-linenumber="33">
          <span class="hits">230</span>
          
          <code class="ruby">    clause = organisation.clauses.get_current(&quot;#{type}_voting_system&quot;) </code>
        </li>
      
        <li class="covered" data-hits="230" data-linenumber="34">
          <span class="hits">230</span>
          
          <code class="ruby">    raise ArgumentError, &quot;invalid system: #{type}&quot; unless clause &amp;&amp; clause.text_value</code>
        </li>
      
        <li class="covered" data-hits="229" data-linenumber="35">
          <span class="hits">229</span>
          
          <code class="ruby">    VotingSystems.get(clause.text_value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_voting_system(type, new_system)</code>
        </li>
      
        <li class="covered" data-hits="763" data-linenumber="39">
          <span class="hits">763</span>
          
          <code class="ruby">    raise ArgumentError, &quot;system #{type} not found&quot; unless ['general', 'membership', 'constitution'].include?(type.to_s)</code>
        </li>
      
        <li class="covered" data-hits="763" data-linenumber="40">
          <span class="hits">763</span>
          
          <code class="ruby">    raise ArgumentError, &quot;invalid voting system: #{new_system}&quot; unless VotingSystems.get(new_system)</code>
        </li>
      
        <li class="covered" data-hits="761" data-linenumber="41">
          <span class="hits">761</span>
          
          <code class="ruby">    organisation.clauses.set_text!(&quot;#{type}_voting_system&quot;, new_system)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="44">
          <span class="hits">2</span>
          
          <code class="ruby">  def change_voting_system(type, new_system)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="45">
          <span class="hits">10</span>
          
          <code class="ruby">    raise ArgumentError, &quot;no previous voting system&quot; unless organisation.clauses.currently_exists?(&quot;#{type}_voting_system&quot;)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="46">
          <span class="hits">10</span>
          
          <code class="ruby">    set_voting_system(type, new_system)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  # VOTING PERIOD</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="51">
          <span class="hits">2</span>
          
          <code class="ruby">  def voting_period</code>
        </li>
      
        <li class="covered" data-hits="298" data-linenumber="52">
          <span class="hits">298</span>
          
          <code class="ruby">    organisation.clauses.get_integer('voting_period')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="55">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_voting_period(new_period)</code>
        </li>
      
        <li class="covered" data-hits="453" data-linenumber="56">
          <span class="hits">453</span>
          
          <code class="ruby">    raise ArgumentError, &quot;invalid voting period #{new_period}&quot; unless new_period &gt; 0</code>
        </li>
      
        <li class="covered" data-hits="453" data-linenumber="57">
          <span class="hits">453</span>
          
          <code class="ruby">    organisation.clauses.set_integer!('voting_period', new_period)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="60">
          <span class="hits">2</span>
          
          <code class="ruby">  def change_voting_period(new_period)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="61">
          <span class="hits">3</span>
          
          <code class="ruby">    raise ArgumentError, &quot;no previous voting period&quot; unless organisation.clauses.currently_exists?('voting_period')</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="62">
          <span class="hits">3</span>
          
          <code class="ruby">    set_voting_period(new_period)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e1089605b7c5daa4b647637e358250cec6ed024d">
  <div class="header">
    <h3>app/models/constitution_proposal.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ConstitutionProposal &lt; Proposal</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def voting_system</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="3">
          <span class="hits">3</span>
          
          <code class="ruby">    organisation.constitution.voting_system(:constitution)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def decision_notification_message</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="7">
          <span class="hits">16</span>
          
          <code class="ruby">    &quot;If you have previously printed/saved a PDF copy of the constitution, this prior copy is now out of date. Please consider reprinting/saving a copy of the latest constitution for your records.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="aa8a2bd3a5ee350db9650ef5c9905c5acba3bc60">
  <div class="header">
    <h3>app/models/constitution_proposal_bundle.rb</h3>
    <h4><span class="red">78.84 %</span> covered</h4>
    <div>
      <b>241</b> relevant lines. 
      <span class="green"><b>190</b> lines covered</span> and
      <span class="red"><b>51</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/model_wrapper'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># Provides an ActiveModel like interface to a bundle of ConstitutionProposals.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># The attributes exposed are the constitution settings themselves (e.g. organisation_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"># voting_period, etc.), plus a single 'proposer' attribute.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">class ConstitutionProposalBundle &lt; OneClickOrgs::ModelWrapper</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :organisation,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    :organisation_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    :objectives,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    :assets,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    :general_voting_system,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    :membership_voting_system,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    :constitution_voting_system,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    :voting_period,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    :proposer,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    :proposals,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    :registered_office_address, # Coop clauses</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    :user_members, :employee_members, :supporter_members, :producer_members, :consumer_members,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    :single_shareholding,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    :max_user_directors, :max_employee_directors, :max_supporter_directors, :max_producer_directors, :max_consumer_directors,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    :common_ownership</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_initialize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    # Load existing settings from organisation, if given, but don't</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    # overwrite new settings that have been passed directly in as attributes.</code>
        </li>
      
        <li class="covered" data-hits="54" data-linenumber="27">
          <span class="hits">54</span>
          
          <code class="ruby">    if organisation</code>
        </li>
      
        <li class="covered" data-hits="54" data-linenumber="28">
          <span class="hits">54</span>
          
          <code class="ruby">      case organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">      when Association</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="30">
          <span class="hits">32</span>
          
          <code class="ruby">        [:organisation_name, :objectives, :voting_period].each do |clause_name|</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="31">
          <span class="hits">96</span>
          
          <code class="ruby">          send(&quot;#{clause_name}=&quot;, organisation.constitution.send(clause_name)) unless send(&quot;#{clause_name}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="33">
          <span class="hits">32</span>
          
          <code class="ruby">        [:general, :membership, :constitution].each do |voting_system_type|</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="34">
          <span class="hits">96</span>
          
          <code class="ruby">          send(&quot;#{voting_system_type}_voting_system=&quot;, organisation.constitution.voting_system(voting_system_type).simple_name) unless send(&quot;#{voting_system_type}_voting_system&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="36">
          <span class="hits">32</span>
          
          <code class="ruby">        self.assets = (!!organisation.constitution.assets ? '1' : '0') unless assets</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">      when Coop</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">        [</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="39">
          <span class="hits">22</span>
          
          <code class="ruby">          :organisation_name, :objectives, :registered_office_address,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">          :max_user_directors, :max_employee_directors, :max_supporter_directors, :max_producer_directors, :max_consumer_directors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">        ].each do |clause_name|</code>
        </li>
      
        <li class="covered" data-hits="176" data-linenumber="42">
          <span class="hits">176</span>
          
          <code class="ruby">          send(&quot;#{clause_name}=&quot;, organisation.constitution.send(clause_name)) unless send(clause_name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">        [</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="45">
          <span class="hits">22</span>
          
          <code class="ruby">          :user_members, :employee_members, :supporter_members, :producer_members, :consumer_members,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">          :single_shareholding,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">          :common_ownership</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">        ].each do |clause_name|</code>
        </li>
      
        <li class="covered" data-hits="154" data-linenumber="49">
          <span class="hits">154</span>
          
          <code class="ruby">          send(&quot;#{clause_name}=&quot;, !!organisation.constitution.send(clause_name) ? '1' : '0') unless send(clause_name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="54" data-linenumber="54">
          <span class="hits">54</span>
          
          <code class="ruby">    self.proposals ||= []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="57">
          <span class="hits">2</span>
          
          <code class="ruby">  def save</code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="58">
          <span class="hits">35</span>
          
          <code class="ruby">    case organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">    when Association</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="60">
          <span class="hits">15</span>
          
          <code class="ruby">      build_proposals_for_association</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">    when Coop</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="62">
          <span class="hits">20</span>
          
          <code class="ruby">      build_proposals_for_coop</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">    # Early exit?</code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="66">
          <span class="hits">35</span>
          
          <code class="ruby">    if proposals.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">      errors.add(:base, &quot;No changes were made&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">    # Only save if we have no errors</code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="72">
          <span class="hits">35</span>
          
          <code class="ruby">    if errors.empty?</code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="73">
          <span class="hits">35</span>
          
          <code class="ruby">      proposals.each(&amp;:save!)</code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="74">
          <span class="hits">35</span>
          
          <code class="ruby">      true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">      false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="80">
          <span class="hits">2</span>
          
          <code class="ruby">  def persisted?</code>
        </li>
      
        <li class="covered" data-hits="57" data-linenumber="81">
          <span class="hits">57</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="84">
          <span class="hits">2</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="86">
          <span class="hits">2</span>
          
          <code class="ruby">  def build_proposals_for_association</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">    # Organisation name</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="88">
          <span class="hits">15</span>
          
          <code class="ruby">    if organisation.name != organisation_name</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="89">
          <span class="hits">8</span>
          
          <code class="ruby">      proposal = (organisation.change_text_proposals.new(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">        :name =&gt; 'organisation_name',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">        :value =&gt; organisation_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">      ))</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="93">
          <span class="hits">8</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="94">
          <span class="hits">8</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="95">
          <span class="hits">8</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">        errors.add(:organisation_name, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">    # Objectives</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="102">
          <span class="hits">15</span>
          
          <code class="ruby">    if organisation.objectives != objectives</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="103">
          <span class="hits">15</span>
          
          <code class="ruby">      proposal = (organisation.change_text_proposals.new(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">        :name =&gt; 'organisation_objectives',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">        :value =&gt; objectives</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">      ))</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="107">
          <span class="hits">15</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="108">
          <span class="hits">15</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="109">
          <span class="hits">15</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="111">
          
          
          <code class="ruby">        errors.add(:objectives, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">    # Assets</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="116">
          <span class="hits">15</span>
          
          <code class="ruby">    if assets == '1'</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="117">
          <span class="hits">7</span>
          
          <code class="ruby">      title = &quot;Change the constitution to allow holding, transferral and disposal of material assets and intangible assets&quot;</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="118">
          <span class="hits">7</span>
          
          <code class="ruby">      new_assets_value = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="120">
          <span class="hits">8</span>
          
          <code class="ruby">      title = &quot;Change the constitution to prohibit holding, transferral or disposal of material assets and intangible assets&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="121">
          <span class="hits">8</span>
          
          <code class="ruby">      new_assets_value = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="124">
          <span class="hits">15</span>
          
          <code class="ruby">    if (organisation.assets &amp;&amp; !new_assets_value) || (!organisation.assets &amp;&amp; new_assets_value) # Bit verbose, to cope with null values</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="125">
          <span class="hits">7</span>
          
          <code class="ruby">      proposal = (organisation.change_boolean_proposals.new(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">        :title =&gt; title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">        :name =&gt; 'assets',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">        :value =&gt; new_assets_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">      ))</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="130">
          <span class="hits">7</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="131">
          <span class="hits">7</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="132">
          <span class="hits">7</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="134">
          
          
          <code class="ruby">        errors.add(:assets, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">    # General voting system</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="139">
          <span class="hits">15</span>
          
          <code class="ruby">    proposed_system = VotingSystems.get(general_voting_system)</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="140">
          <span class="hits">15</span>
          
          <code class="ruby">    current_system = organisation.constitution.voting_system :general</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="142">
          <span class="hits">15</span>
          
          <code class="ruby">    if current_system != proposed_system</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="143">
          <span class="hits">15</span>
          
          <code class="ruby">      proposal = (organisation.change_voting_system_proposals.new(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">        :proposal_type =&gt; 'general',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">        :proposed_system =&gt; proposed_system.simple_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">      ))</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="147">
          <span class="hits">15</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="148">
          <span class="hits">15</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="149">
          <span class="hits">15</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="151">
          
          
          <code class="ruby">        errors.add(:general_voting_system, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">    # Membership voting system</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="156">
          <span class="hits">15</span>
          
          <code class="ruby">    proposed_system = VotingSystems.get(membership_voting_system)</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="157">
          <span class="hits">15</span>
          
          <code class="ruby">    current_system = organisation.constitution.voting_system :membership</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="159">
          <span class="hits">15</span>
          
          <code class="ruby">    if current_system != proposed_system</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="160">
          <span class="hits">8</span>
          
          <code class="ruby">      proposal = (organisation.change_voting_system_proposals.new(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">        :proposal_type =&gt; 'membership',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">        :proposed_system =&gt; proposed_system.simple_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">      ))</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="164">
          <span class="hits">8</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="165">
          <span class="hits">8</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="166">
          <span class="hits">8</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="168">
          
          
          <code class="ruby">        errors.add(:membership_voting_system, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">    # Constitution voting system</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="173">
          <span class="hits">15</span>
          
          <code class="ruby">    proposed_system = VotingSystems.get(constitution_voting_system)</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="174">
          <span class="hits">15</span>
          
          <code class="ruby">    current_system = organisation.constitution.voting_system :constitution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="176">
          <span class="hits">15</span>
          
          <code class="ruby">    if current_system != proposed_system</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="177">
          <span class="hits">8</span>
          
          <code class="ruby">      proposal = (organisation.change_voting_system_proposals.new(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">        :proposal_type =&gt; 'constitution',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby">        :proposed_system =&gt; proposed_system.simple_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">      ))</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="181">
          <span class="hits">8</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="182">
          <span class="hits">8</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="183">
          <span class="hits">8</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="185">
          
          
          <code class="ruby">        errors.add(:constitution_voting_system, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby">    # Voting period</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="190">
          <span class="hits">15</span>
          
          <code class="ruby">    if organisation.constitution.voting_period != voting_period.to_i</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="191">
          <span class="hits">8</span>
          
          <code class="ruby">      proposal = organisation.change_voting_period_proposals.new(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">        :new_voting_period =&gt; voting_period</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">      )</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="194">
          <span class="hits">8</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="195">
          <span class="hits">8</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="196">
          <span class="hits">8</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="198">
          
          
          <code class="ruby">        errors.add(:voting_period, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="203">
          <span class="hits">2</span>
          
          <code class="ruby">  def build_proposals_for_coop</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="204">
          <span class="hits">20</span>
          
          <code class="ruby">    ability = Ability.new(proposer)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">    # Organisation name</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="207">
          <span class="hits">20</span>
          
          <code class="ruby">    if organisation.name != organisation_name</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="208">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal = if ability.can?(:create, Resolution)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="209">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.change_text_resolutions.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">          :name =&gt; 'organisation_name',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby">          :value =&gt; organisation_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">          :draft =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">      elsif ability.can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="215">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.resolution_proposals.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">          :resolution_class =&gt; 'ChangeTextResolution',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby">          :resolution_parameters =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="218">
          
          
          <code class="ruby">            :name =&gt; 'organisation_name',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">            :value =&gt; organisation_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="223">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="224">
          <span class="hits">20</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="225">
          <span class="hits">20</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="227">
          
          
          <code class="ruby">        errors.add(:organisation_name, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">    # Objectives</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="232">
          <span class="hits">20</span>
          
          <code class="ruby">    if organisation.objectives != objectives</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="233">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal = if ability.can?(:create, Resolution)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="234">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.change_text_resolutions.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby">          :name =&gt; 'organisation_objectives',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby">          :value =&gt; objectives,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">          :title =&gt; &quot;Change objects to '#{objectives}'&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby">          :draft =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby">      elsif ability.can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="241">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.resolution_proposals.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="242">
          
          
          <code class="ruby">          :title =&gt; &quot;Change objects to '#{objectives}'&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby">          :resolution_class =&gt; &quot;ChangeTextResolution&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby">          :resolution_parameters =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby">            :name =&gt; 'organisation_objectives',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby">            :value =&gt; objectives,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="250">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="251">
          <span class="hits">20</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="252">
          <span class="hits">20</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="254">
          
          
          <code class="ruby">        errors.add(:objectives, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="258">
          
          
          <code class="ruby">    # Registered office address</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="259">
          <span class="hits">20</span>
          
          <code class="ruby">    if organisation.registered_office_address != registered_office_address</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="260">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal = if ability.can?(:create, Resolution)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="261">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.change_text_resolutions.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">          :name =&gt; 'registered_office_address',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby">          :value =&gt; registered_office_address,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="264">
          
          
          <code class="ruby">          :draft =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby">      elsif ability.can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="267">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.resolution_proposals.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby">          :resolution_class =&gt; &quot;ChangeTextResolution&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby">          :resolution_parameters =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby">            :name =&gt; 'registered_office_address',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby">            :value =&gt; registered_office_address</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="275">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="276">
          <span class="hits">20</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="277">
          <span class="hits">20</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="278">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="279">
          
          
          <code class="ruby">        errors.add(:registered_office_address, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="282">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="283">
          
          
          <code class="ruby">    # Member types</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="285">
          <span class="hits">20</span>
          
          <code class="ruby">    if user_members == '1'</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="286">
          <span class="hits">20</span>
          
          <code class="ruby">      title = &quot;Change the Rules to allow User Members&quot;</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="287">
          <span class="hits">20</span>
          
          <code class="ruby">      new_user_members_value = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="289">
          
          
          <code class="ruby">      title = &quot;Change the Rules to disallow User Members&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="290">
          
          
          <code class="ruby">      new_user_members_value = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="291">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="292">
          <span class="hits">20</span>
          
          <code class="ruby">    if (organisation.user_members &amp;&amp; !new_user_members_value) || (!organisation.user_members &amp;&amp; new_user_members_value) # Bit verbose, to cope with null values</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="293">
          
          
          <code class="ruby">      proposal = if ability.can?(:create, Resolution)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="294">
          
          
          <code class="ruby">        organisation.change_boolean_resolutions.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby">          :title =&gt; title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby">          :name =&gt; 'user_members',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">          :value =&gt; new_user_members_value,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby">          :draft =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby">      elsif ability.can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="301">
          
          
          <code class="ruby">        organisation.resolution_proposals.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">          :title =&gt; title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby">          :resolution_class =&gt; 'ChangeBooleanResolution',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby">          :resolution_parameters =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="305">
          
          
          <code class="ruby">            :name =&gt; 'user_members',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="306">
          
          
          <code class="ruby">            :value =&gt; new_user_members_value,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="307">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="310">
          
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="311">
          
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="312">
          
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="313">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="314">
          
          
          <code class="ruby">        errors.add(:user_members, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="316">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="318">
          <span class="hits">20</span>
          
          <code class="ruby">    if employee_members == '1'</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="319">
          <span class="hits">20</span>
          
          <code class="ruby">      title = &quot;Change the Rules to allow Employee Members&quot;</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="320">
          <span class="hits">20</span>
          
          <code class="ruby">      new_employee_members_value = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="321">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="322">
          
          
          <code class="ruby">      title = &quot;Change the Rules to disallow Employee Members&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="323">
          
          
          <code class="ruby">      new_employee_members_value = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="324">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="325">
          <span class="hits">20</span>
          
          <code class="ruby">    if (organisation.employee_members &amp;&amp; !new_employee_members_value) || (!organisation.employee_members &amp;&amp; new_employee_members_value) # Bit verbose, to cope with null values</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="326">
          
          
          <code class="ruby">      proposal = if ability.can?(:create, Resolution)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="327">
          
          
          <code class="ruby">        organisation.change_boolean_resolutions.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="328">
          
          
          <code class="ruby">          :title =&gt; title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby">          :name =&gt; 'employee_members',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="330">
          
          
          <code class="ruby">          :value =&gt; new_employee_members_value,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="331">
          
          
          <code class="ruby">          :draft =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="332">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="333">
          
          
          <code class="ruby">      elsif ability.can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="334">
          
          
          <code class="ruby">        organisation.resolution_proposals.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="335">
          
          
          <code class="ruby">          :title =&gt; title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="336">
          
          
          <code class="ruby">          :resolution_class =&gt; 'ChangeBooleanResolution',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="337">
          
          
          <code class="ruby">          :resolution_parameters =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="338">
          
          
          <code class="ruby">            :name =&gt; 'employee_members',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="339">
          
          
          <code class="ruby">            :value =&gt; new_employee_members_value,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="340">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="341">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="342">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="343">
          
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="344">
          
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="345">
          
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="346">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="347">
          
          
          <code class="ruby">        errors.add(:employee_members, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="348">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="349">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="350">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="351">
          <span class="hits">20</span>
          
          <code class="ruby">    if supporter_members == '1'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="352">
          
          
          <code class="ruby">      title = &quot;Change the Rules to allow Supporter Members&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="353">
          
          
          <code class="ruby">      new_supporter_members_value = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="354">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="355">
          <span class="hits">20</span>
          
          <code class="ruby">      title = &quot;Change the Rules to disallow Supporter Members&quot;</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="356">
          <span class="hits">20</span>
          
          <code class="ruby">      new_supporter_members_value = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="357">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="358">
          <span class="hits">20</span>
          
          <code class="ruby">    if (organisation.supporter_members &amp;&amp; !new_supporter_members_value) || (!organisation.supporter_members &amp;&amp; new_supporter_members_value) # Bit verbose, to cope with null values</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="359">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal = if ability.can?(:create, Resolution)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="360">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.change_boolean_resolutions.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby">          :title =&gt; title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby">          :name =&gt; 'supporter_members',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby">          :value =&gt; new_supporter_members_value,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="364">
          
          
          <code class="ruby">          :draft =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="365">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="366">
          
          
          <code class="ruby">      elsif ability.can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="367">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.resolution_proposals.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="368">
          
          
          <code class="ruby">          :title =&gt; title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="369">
          
          
          <code class="ruby">          :resolution_class =&gt; 'ChangeBooleanResolution',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="370">
          
          
          <code class="ruby">          :resolution_parameters =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="371">
          
          
          <code class="ruby">            :name =&gt; 'supporter_members',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="372">
          
          
          <code class="ruby">            :value =&gt; new_supporter_members_value,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="373">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="374">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="375">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="376">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="377">
          <span class="hits">20</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="378">
          <span class="hits">20</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="379">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="380">
          
          
          <code class="ruby">        errors.add(:supporter_members, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="381">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="382">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="383">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="384">
          <span class="hits">20</span>
          
          <code class="ruby">    if producer_members == '1'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="385">
          
          
          <code class="ruby">      title = &quot;Change the Rules to allow Producer Members&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="386">
          
          
          <code class="ruby">      new_producer_members_value = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="387">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="388">
          <span class="hits">20</span>
          
          <code class="ruby">      title = &quot;Change the Rules to disallow Producer Members&quot;</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="389">
          <span class="hits">20</span>
          
          <code class="ruby">      new_producer_members_value = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="390">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="391">
          <span class="hits">20</span>
          
          <code class="ruby">    if (organisation.producer_members &amp;&amp; !new_producer_members_value) || (!organisation.producer_members &amp;&amp; new_producer_members_value) # Bit verbose, to cope with null values</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="392">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal = if ability.can?(:create, Resolution)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="393">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.change_boolean_resolutions.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="394">
          
          
          <code class="ruby">          :title =&gt; title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="395">
          
          
          <code class="ruby">          :name =&gt; 'producer_members',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="396">
          
          
          <code class="ruby">          :value =&gt; new_producer_members_value,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="397">
          
          
          <code class="ruby">          :draft =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="398">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="399">
          
          
          <code class="ruby">      elsif ability.can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="400">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.resolution_proposals.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="401">
          
          
          <code class="ruby">          :title =&gt; title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="402">
          
          
          <code class="ruby">          :resolution_class =&gt; 'ChangeBooleanResolution',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="403">
          
          
          <code class="ruby">          :resolution_parameters =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="404">
          
          
          <code class="ruby">            :name =&gt; 'producer_members',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="405">
          
          
          <code class="ruby">            :value =&gt; new_producer_members_value,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="406">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="407">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="408">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="409">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="410">
          <span class="hits">20</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="411">
          <span class="hits">20</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="412">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="413">
          
          
          <code class="ruby">        errors.add(:producer_members, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="414">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="415">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="416">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="417">
          <span class="hits">20</span>
          
          <code class="ruby">    if consumer_members == '1'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="418">
          
          
          <code class="ruby">      title = &quot;Change the Rules to allow Consumer Members&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="419">
          
          
          <code class="ruby">      new_consumer_members_value = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="420">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="421">
          <span class="hits">20</span>
          
          <code class="ruby">      title = &quot;Change the Rules to disallow Consumer Members&quot;</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="422">
          <span class="hits">20</span>
          
          <code class="ruby">      new_consumer_members_value = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="423">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="424">
          <span class="hits">20</span>
          
          <code class="ruby">    if (organisation.consumer_members &amp;&amp; !new_consumer_members_value) || (!organisation.consumer_members &amp;&amp; new_consumer_members_value) # Bit verbose, to cope with null values</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="425">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal = if ability.can?(:create, Resolution)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="426">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.change_boolean_resolutions.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="427">
          
          
          <code class="ruby">          :title =&gt; title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="428">
          
          
          <code class="ruby">          :name =&gt; 'consumer_members',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="429">
          
          
          <code class="ruby">          :value =&gt; new_consumer_members_value,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="430">
          
          
          <code class="ruby">          :draft =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="431">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="432">
          
          
          <code class="ruby">      elsif ability.can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="433">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.resolution_proposals.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="434">
          
          
          <code class="ruby">          :title =&gt; title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="435">
          
          
          <code class="ruby">          :resolution_class =&gt; 'ChangeBooleanResolution',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="436">
          
          
          <code class="ruby">          :resolution_parameters =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="437">
          
          
          <code class="ruby">            :name =&gt; 'consumer_members',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="438">
          
          
          <code class="ruby">            :value =&gt; new_consumer_members_value,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="439">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="440">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="441">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="442">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="443">
          <span class="hits">20</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="444">
          <span class="hits">20</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="445">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="446">
          
          
          <code class="ruby">        errors.add(:consumer_members, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="447">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="448">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="449">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="450">
          
          
          <code class="ruby">    # Shareholding</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="451">
          <span class="hits">20</span>
          
          <code class="ruby">    if single_shareholding == '1'</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="452">
          <span class="hits">20</span>
          
          <code class="ruby">      title = &quot;Change the Rules to permit each Member to hold only one share&quot;</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="453">
          <span class="hits">20</span>
          
          <code class="ruby">      new_single_shareholding_value = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="454">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="455">
          
          
          <code class="ruby">      title = &quot;Change the Rules to permit each Member to hold more than one share&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="456">
          
          
          <code class="ruby">      new_single_shareholding_value = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="457">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="458">
          <span class="hits">20</span>
          
          <code class="ruby">    if (organisation.single_shareholding &amp;&amp; !new_single_shareholding_value) || (!organisation.single_shareholding &amp;&amp; new_single_shareholding_value) # Bit verbose, to cope with null values</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="459">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal = if ability.can?(:create, Resolution)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="460">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.change_boolean_resolutions.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="461">
          
          
          <code class="ruby">          :title =&gt; title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="462">
          
          
          <code class="ruby">          :name =&gt; 'single_shareholding',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="463">
          
          
          <code class="ruby">          :value =&gt; new_single_shareholding_value,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="464">
          
          
          <code class="ruby">          :draft =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="465">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="466">
          
          
          <code class="ruby">      elsif ability.can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="467">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.resolution_proposals.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="468">
          
          
          <code class="ruby">          :title =&gt; title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="469">
          
          
          <code class="ruby">          :resolution_class =&gt; &quot;ChangeBooleanResolution&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="470">
          
          
          <code class="ruby">          :resolution_parameters =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="471">
          
          
          <code class="ruby">            :name =&gt; 'single_shareholding',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="472">
          
          
          <code class="ruby">            :value =&gt; new_single_shareholding_value,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="473">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="474">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="475">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="476">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="477">
          <span class="hits">20</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="478">
          <span class="hits">20</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="479">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="480">
          
          
          <code class="ruby">        errors.add(:single_shareholding, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="481">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="482">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="483">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="484">
          
          
          <code class="ruby">    # Board composition</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="485">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="486">
          <span class="hits">20</span>
          
          <code class="ruby">    if organisation.max_user_directors != max_user_directors.to_i</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="487">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal = if ability.can?(:create, Resolution)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="488">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.change_integer_resolutions.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="489">
          
          
          <code class="ruby">          :name =&gt; 'max_user_directors',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="490">
          
          
          <code class="ruby">          :value =&gt; max_user_directors.to_i,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="491">
          
          
          <code class="ruby">          :title =&gt; &quot;Allow a maximum of #{max_user_directors} User Members on the Board&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="492">
          
          
          <code class="ruby">          :draft =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="493">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="494">
          
          
          <code class="ruby">      elsif ability.can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="495">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.resolution_proposals.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="496">
          
          
          <code class="ruby">          :title =&gt; &quot;Allow a maximum of #{max_user_directors} User Members on the Board&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="497">
          
          
          <code class="ruby">          :resolution_class =&gt; 'ChangeIntegerResolution',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="498">
          
          
          <code class="ruby">          :resolution_parameters =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="499">
          
          
          <code class="ruby">            :name =&gt; 'max_user_directors',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="500">
          
          
          <code class="ruby">            :value =&gt; max_user_directors.to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="501">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="502">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="503">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="504">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="505">
          <span class="hits">20</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="506">
          <span class="hits">20</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="507">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="508">
          
          
          <code class="ruby">        errors.add(:max_user_directors, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="509">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="510">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="511">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="512">
          <span class="hits">20</span>
          
          <code class="ruby">    if organisation.max_employee_directors != max_employee_directors.to_i</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="513">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal = if ability.can?(:create, Resolution)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="514">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.change_integer_resolutions.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="515">
          
          
          <code class="ruby">          :name =&gt; 'max_employee_directors',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="516">
          
          
          <code class="ruby">          :value =&gt; max_employee_directors.to_i,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="517">
          
          
          <code class="ruby">          :title =&gt; &quot;Allow a maximum of #{max_employee_directors} Employee Members on the Board&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="518">
          
          
          <code class="ruby">          :draft =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="519">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="520">
          
          
          <code class="ruby">      elsif ability.can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="521">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.resolution_proposals.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="522">
          
          
          <code class="ruby">          :title =&gt; &quot;Allow a maximum of #{max_employee_directors} Employee Members on the Board&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="523">
          
          
          <code class="ruby">          :resolution_class =&gt; 'ChangeIntegerResolution',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="524">
          
          
          <code class="ruby">          :resolution_parameters =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="525">
          
          
          <code class="ruby">            :name =&gt; 'max_employee_directors',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="526">
          
          
          <code class="ruby">            :value =&gt; max_employee_directors.to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="527">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="528">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="529">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="530">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="531">
          <span class="hits">20</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="532">
          <span class="hits">20</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="533">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="534">
          
          
          <code class="ruby">        errors.add(:max_employee_directors, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="535">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="536">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="537">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="538">
          <span class="hits">20</span>
          
          <code class="ruby">    if organisation.max_supporter_directors != max_supporter_directors.to_i</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="539">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal = if ability.can?(:create, Resolution)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="540">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.change_integer_resolutions.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="541">
          
          
          <code class="ruby">          :name =&gt; 'max_supporter_directors',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="542">
          
          
          <code class="ruby">          :value =&gt; max_supporter_directors.to_i,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="543">
          
          
          <code class="ruby">          :title =&gt; &quot;Allow a maximum of #{max_supporter_directors} Supporter Members on the Board&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="544">
          
          
          <code class="ruby">          :draft =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="545">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="546">
          
          
          <code class="ruby">      elsif ability.can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="547">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.resolution_proposals.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="548">
          
          
          <code class="ruby">          :title =&gt; &quot;Allow a maximum of #{max_supporter_directors} Supporter Members on the Board&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="549">
          
          
          <code class="ruby">          :resolution_class =&gt; 'ChangeIntegerResolution',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="550">
          
          
          <code class="ruby">          :resolution_parameters =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="551">
          
          
          <code class="ruby">            :name =&gt; 'max_supporter_directors',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="552">
          
          
          <code class="ruby">            :value =&gt; max_supporter_directors.to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="553">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="554">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="555">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="556">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="557">
          <span class="hits">20</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="558">
          <span class="hits">20</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="559">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="560">
          
          
          <code class="ruby">        errors.add(:max_supporter_directors, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="561">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="562">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="563">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="564">
          <span class="hits">20</span>
          
          <code class="ruby">    if organisation.max_producer_directors != max_producer_directors.to_i</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="565">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal = if ability.can?(:create, Resolution)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="566">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.change_integer_resolutions.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="567">
          
          
          <code class="ruby">          :name =&gt; 'max_producer_directors',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="568">
          
          
          <code class="ruby">          :value =&gt; max_producer_directors.to_i,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="569">
          
          
          <code class="ruby">          :title =&gt; &quot;Allow a maximum of #{max_producer_directors} Producer Members on the Board&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="570">
          
          
          <code class="ruby">          :draft =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="571">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="572">
          
          
          <code class="ruby">      elsif ability.can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="573">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.resolution_proposals.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="574">
          
          
          <code class="ruby">          :title =&gt; &quot;Allow a maximum of #{max_producer_directors} Producer Members on the Board&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="575">
          
          
          <code class="ruby">          :resolution_class =&gt; 'ChangeIntegerResolution',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="576">
          
          
          <code class="ruby">          :resolution_parameters =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="577">
          
          
          <code class="ruby">            :name =&gt; 'max_producer_directors',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="578">
          
          
          <code class="ruby">            :value =&gt; max_producer_directors.to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="579">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="580">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="581">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="582">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="583">
          <span class="hits">20</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="584">
          <span class="hits">20</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="585">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="586">
          
          
          <code class="ruby">        errors.add(:max_producer_directors, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="587">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="588">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="589">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="590">
          <span class="hits">20</span>
          
          <code class="ruby">    if organisation.max_consumer_directors != max_consumer_directors.to_i</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="591">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal = if ability.can?(:create, Resolution)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="592">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.change_integer_resolutions.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="593">
          
          
          <code class="ruby">          :name =&gt; 'max_consumer_directors',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="594">
          
          
          <code class="ruby">          :value =&gt; max_consumer_directors.to_i,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="595">
          
          
          <code class="ruby">          :title =&gt; &quot;Allow a maximum of #{max_consumer_directors} Consumer Members on the Board&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="596">
          
          
          <code class="ruby">          :draft =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="597">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="598">
          
          
          <code class="ruby">      elsif ability.can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="599">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.resolution_proposals.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="600">
          
          
          <code class="ruby">          :title =&gt; &quot;Allow a maximum of #{max_consumer_directors} Consumer Members on the Board&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="601">
          
          
          <code class="ruby">          :resolution_class =&gt; 'ChangeIntegerResolution',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="602">
          
          
          <code class="ruby">          :resolution_parameters =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="603">
          
          
          <code class="ruby">            :name =&gt; 'max_consumer_directors',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="604">
          
          
          <code class="ruby">            :value =&gt; max_consumer_directors.to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="605">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="606">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="607">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="608">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="609">
          <span class="hits">20</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="610">
          <span class="hits">20</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="611">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="612">
          
          
          <code class="ruby">        errors.add(:max_consumer_directors, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="613">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="614">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="615">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="616">
          
          
          <code class="ruby">    # Ownership</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="617">
          <span class="hits">20</span>
          
          <code class="ruby">    if common_ownership == '1'</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="618">
          <span class="hits">20</span>
          
          <code class="ruby">      title = &quot;Change the organisation to be a Common Ownership enterprise&quot;</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="619">
          <span class="hits">20</span>
          
          <code class="ruby">      new_common_ownership_value = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="620">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="621">
          
          
          <code class="ruby">      title = &quot;Change the organisation to be a Co-ownership enterprise&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="622">
          
          
          <code class="ruby">      new_common_ownership_value = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="623">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="624">
          <span class="hits">20</span>
          
          <code class="ruby">    if (organisation.common_ownership &amp;&amp; !new_common_ownership_value) || (!organisation.common_ownership &amp;&amp; new_common_ownership_value) # Bit verbose, to cope with null values</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="625">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal = if ability.can?(:create, Resolution)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="626">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.change_boolean_resolutions.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="627">
          
          
          <code class="ruby">          :title =&gt; title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="628">
          
          
          <code class="ruby">          :name =&gt; 'common_ownership',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="629">
          
          
          <code class="ruby">          :value =&gt; new_common_ownership_value,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="630">
          
          
          <code class="ruby">          :draft =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="631">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="632">
          
          
          <code class="ruby">      elsif ability.can?(:create, ResolutionProposal)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="633">
          <span class="hits">10</span>
          
          <code class="ruby">        organisation.resolution_proposals.build(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="634">
          
          
          <code class="ruby">          :title =&gt; title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="635">
          
          
          <code class="ruby">          :resolution_class =&gt; 'ChangeBooleanResolution',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="636">
          
          
          <code class="ruby">          :resolution_parameters =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="637">
          
          
          <code class="ruby">            :name =&gt; 'common_ownership',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="638">
          
          
          <code class="ruby">            :value =&gt; new_common_ownership_value,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="639">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="640">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="641">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="642">
          <span class="hits">20</span>
          
          <code class="ruby">      proposal.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="643">
          <span class="hits">20</span>
          
          <code class="ruby">      if proposal.valid?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="644">
          <span class="hits">20</span>
          
          <code class="ruby">        proposals.push(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="645">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="646">
          
          
          <code class="ruby">        errors.add(:common_ownership, proposal.errors.full_messages.to_sentence)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="647">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="648">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="649">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="650">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="07257a60d20d4b8f387e139bae0e6b573479a862">
  <div class="header">
    <h3>app/models/constitution_wrapper.rb</h3>
    <h4><span class="yellow">86.59 %</span> covered</h4>
    <div>
      <b>82</b> relevant lines. 
      <span class="green"><b>71</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/model_wrapper'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/cast_to_boolean'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">class ConstitutionWrapper &lt; OneClickOrgs::ModelWrapper</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  include OneClickOrgs::CastToBoolean</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :constitution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :organisation_name, :objectives, :assets,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    :general_voting_system, :membership_voting_system, :constitution_voting_system,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    :voting_period,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    :registered_office_address, # Coop clauses</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    :user_members, :employee_members, :supporter_members, :producer_members, :consumer_members,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    :single_shareholding,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    :max_user_directors, :max_employee_directors, :max_supporter_directors, :max_producer_directors, :max_consumer_directors,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    :common_ownership</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_initialize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    # TODO ? only use constitution's original values as defaults; allow</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    # new values to be passed in via the attributes</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="21">
          <span class="hits">12</span>
          
          <code class="ruby">    case organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    when Association</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="23">
          <span class="hits">10</span>
          
          <code class="ruby">      [:organisation_name, :objectives, :voting_period].each do |clause_name|</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="24">
          <span class="hits">30</span>
          
          <code class="ruby">        send(&quot;#{clause_name}=&quot;, constitution.send(clause_name))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="26">
          <span class="hits">10</span>
          
          <code class="ruby">      [:general, :membership, :constitution].each do |voting_system_type|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">        send(</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="28">
          <span class="hits">30</span>
          
          <code class="ruby">          &quot;#{voting_system_type}_voting_system=&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">          constitution.voting_system(voting_system_type).simple_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="32">
          <span class="hits">10</span>
          
          <code class="ruby">      self.assets = !!constitution.assets ? '1' : '0'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    when Coop</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">      [</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">        :organisation_name, :objectives, :registered_office_address,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">        :max_user_directors, :max_employee_directors, :max_supporter_directors, :max_producer_directors, :max_consumer_directors,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">      ].each do |clause_name|</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="38">
          <span class="hits">16</span>
          
          <code class="ruby">        send(&quot;#{clause_name}=&quot;, constitution.send(clause_name))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">      [</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">        :user_members, :employee_members, :supporter_members, :producer_members, :consumer_members,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">        :single_shareholding, :common_ownership</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">      ].each do |clause_name|</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="44">
          <span class="hits">14</span>
          
          <code class="ruby">        send(&quot;#{clause_name}=&quot;, !!constitution.send(clause_name) ? '1' : '0')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="49">
          <span class="hits">2</span>
          
          <code class="ruby">  def update_attributes(options={})</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="50">
          <span class="hits">2</span>
          
          <code class="ruby">    case organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">    when Association</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">      organisation.clauses.set_text!('organisation_name', options[:organisation_name]) if organisation_name != options[:organisation_name]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">      organisation.clauses.set_text!('organisation_objectives', options[:objectives]) if objectives != options[:objectives]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">      if options[:assets] == '1'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">        new_assets_value = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">        new_assets_value = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">      if (cast_to_boolean(assets) &amp;&amp; !new_assets_value) || (!cast_to_boolean(assets) &amp;&amp; new_assets_value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">        organisation.clauses.set_boolean!('assets', new_assets_value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">      if general_voting_system != VotingSystems.get(options[:general_voting_system])</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">        constitution.change_voting_system('general', options[:general_voting_system])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">      if constitution_voting_system != VotingSystems.get(options[:constitution_voting_system])</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">        constitution.change_voting_system('constitution', options[:constitution_voting_system])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">      if membership_voting_system != VotingSystems.get(options[:membership_voting_system])</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">        constitution.change_voting_system('membership', options[:membership_voting_system])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">      if voting_period != options[:voting_period].to_i</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">        constitution.change_voting_period(options[:voting_period].to_i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">    when Coop</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">      organisation.clauses.set_text!('organisation_name', options[:organisation_name]) if organisation_name != options[:organisation_name]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">      organisation.clauses.set_text!('organisation_objectives', options[:objectives]) if objectives != options[:objectives]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">      organisation.clauses.set_text!('registered_office_address', options[:registered_office_address]) if registered_office_address != options[:registered_office_address]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="83">
          <span class="hits">1</span>
          
          <code class="ruby">      if options[:user_members] == '1'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">        new_user_members_value = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">        new_user_members_value = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="88">
          <span class="hits">1</span>
          
          <code class="ruby">      if (cast_to_boolean(user_members) &amp;&amp; !new_user_members_value) || (!cast_to_boolean(user_members) &amp;&amp; new_user_members_value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">        organisation.clauses.set_boolean!('user_members', new_user_members_value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="92">
          <span class="hits">1</span>
          
          <code class="ruby">      if options[:employee_members] == '1'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>
          
          <code class="ruby">        new_employee_members_value = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">        new_employee_members_value = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">      if (cast_to_boolean(employee_members) &amp;&amp; !new_employee_members_value) || (!cast_to_boolean(employee_members) &amp;&amp; new_employee_members_value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="98">
          
          
          <code class="ruby">        organisation.clauses.set_boolean!('employee_members', new_employee_members_value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">      if options[:supporter_members] == '1'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="102">
          
          
          <code class="ruby">        new_supporter_members_value = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="104">
          <span class="hits">1</span>
          
          <code class="ruby">        new_supporter_members_value = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">      if (cast_to_boolean(supporter_members) &amp;&amp; !new_supporter_members_value) || (!cast_to_boolean(supporter_members) &amp;&amp; new_supporter_members_value)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">        organisation.clauses.set_boolean!('supporter_members', new_supporter_members_value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="110">
          <span class="hits">1</span>
          
          <code class="ruby">      if options[:producer_members] == '1'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="111">
          
          
          <code class="ruby">        new_producer_members_value = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="113">
          <span class="hits">1</span>
          
          <code class="ruby">        new_producer_members_value = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="115">
          <span class="hits">1</span>
          
          <code class="ruby">      if (cast_to_boolean(producer_members) &amp;&amp; !new_producer_members_value) || (!cast_to_boolean(producer_members) &amp;&amp; new_producer_members_value)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>
          
          <code class="ruby">        organisation.clauses.set_boolean!('producer_members', new_producer_members_value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="119">
          <span class="hits">1</span>
          
          <code class="ruby">      if options[:consumer_members] == '1'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="120">
          
          
          <code class="ruby">        new_consumer_members_value = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="122">
          <span class="hits">1</span>
          
          <code class="ruby">        new_consumer_members_value = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>
          
          <code class="ruby">      if (cast_to_boolean(consumer_members) &amp;&amp; !new_consumer_members_value) || (!cast_to_boolean(consumer_members) &amp;&amp; new_consumer_members_value)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="125">
          <span class="hits">1</span>
          
          <code class="ruby">        organisation.clauses.set_boolean!('consumer_members', new_consumer_members_value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="128">
          <span class="hits">1</span>
          
          <code class="ruby">      if options[:single_shareholding] == '1'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="129">
          <span class="hits">1</span>
          
          <code class="ruby">        new_single_shareholding_value = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="131">
          
          
          <code class="ruby">        new_single_shareholding_value = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">      # raise &quot;single_shareholding: #{single_shareholding.inspect}; new_single_shareholding_value: #{new_single_shareholding_value.inspect}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="134">
          <span class="hits">1</span>
          
          <code class="ruby">      if (cast_to_boolean(single_shareholding) &amp;&amp; !new_single_shareholding_value) || (!cast_to_boolean(single_shareholding) &amp;&amp; new_single_shareholding_value)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="135">
          <span class="hits">1</span>
          
          <code class="ruby">        organisation.clauses.set_boolean!('single_shareholding', new_single_shareholding_value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="138">
          <span class="hits">1</span>
          
          <code class="ruby">      organisation.clauses.set_integer!('max_user_directors', options[:max_user_directors].to_i) if max_user_directors != options[:max_user_directors].to_i</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="139">
          <span class="hits">1</span>
          
          <code class="ruby">      organisation.clauses.set_integer!('max_employee_directors', options[:max_employee_directors].to_i) if max_employee_directors != options[:max_employee_directors].to_i</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="140">
          <span class="hits">1</span>
          
          <code class="ruby">      organisation.clauses.set_integer!('max_supporter_directors', options[:max_supporter_directors].to_i) if max_supporter_directors != options[:max_supporter_directors].to_i</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="141">
          <span class="hits">1</span>
          
          <code class="ruby">      organisation.clauses.set_integer!('max_consumer_directors', options[:max_consumer_directors].to_i) if max_consumer_directors != options[:max_consumer_directors].to_i</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="142">
          <span class="hits">1</span>
          
          <code class="ruby">      organisation.clauses.set_integer!('max_producer_directors', options[:max_producer_directors].to_i) if max_producer_directors != options[:max_producer_directors].to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="144">
          <span class="hits">1</span>
          
          <code class="ruby">      if options[:common_ownership] == '1'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="145">
          <span class="hits">1</span>
          
          <code class="ruby">        new_common_ownership_value = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="147">
          
          
          <code class="ruby">        new_common_ownership_value = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="149">
          <span class="hits">1</span>
          
          <code class="ruby">      if (cast_to_boolean(common_ownership) &amp;&amp; !new_common_ownership_value) || (!cast_to_boolean(common_ownership) &amp;&amp; new_common_ownership_value)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="150">
          <span class="hits">1</span>
          
          <code class="ruby">        organisation.clauses.set_boolean!('common_ownership', new_common_ownership_value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">    # TODO return false on errors</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="155">
          <span class="hits">2</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="158">
          <span class="hits">2</span>
          
          <code class="ruby">  def organisation</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="159">
          <span class="hits">29</span>
          
          <code class="ruby">    constitution.organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="162">
          <span class="hits">2</span>
          
          <code class="ruby">  def persisted?</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="163">
          <span class="hits">10</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="6bf004b0ee1e040ebe5a5e2d2d2dc87b4dd2f346">
  <div class="header">
    <h3>app/models/coop.rb</h3>
    <h4><span class="green">92.31 %</span> covered</h4>
    <div>
      <b>247</b> relevant lines. 
      <span class="green"><b>228</b> lines covered</span> and
      <span class="red"><b>19</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/cast_to_boolean'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">class Coop &lt; Organisation</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  include OneClickOrgs::CastToBoolean</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :reg_form_timing_factors, :reg_form_close_links, :reg_form_membership_required,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    :reg_form_financial_year_end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  state_machine :initial =&gt; :pending do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">    event :propose do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">      transition :pending =&gt; :proposed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">    event :found do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">      transition :proposed =&gt; :active</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">    event :reject_founding do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">      transition :proposed =&gt; :pending</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">    after_transition :proposed =&gt; :active, :do =&gt; :destroy_pending_state_member_classes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">  scope :active, with_state(:active)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">  scope :proposed, with_state(:proposed)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">  scope :pending, with_state(:pending)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :meetings, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :board_meetings, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :general_meetings, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :annual_general_meetings, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :resolutions, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :board_resolutions, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="37">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :change_meeting_notice_period_resolutions, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :change_quorum_resolutions, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="39">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :change_text_resolutions, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :change_boolean_resolutions, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :change_integer_resolutions, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="43">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :resolution_proposals, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="45">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :offices, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="46">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :officerships, :through =&gt; :offices</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="47">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :officers, :through =&gt; :officerships</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="49">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :directorships, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="51">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :elections, :foreign_key =&gt; 'organisation_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="53">
          <span class="hits">2</span>
          
          <code class="ruby">  has_one :share_account, :as =&gt; :owner</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="54">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :withdrawals, :through =&gt; :share_account</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="56">
          <span class="hits">2</span>
          
          <code class="ruby">  def founder_members</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="57">
          <span class="hits">3</span>
          
          <code class="ruby">    members.founder_members(self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="60">
          <span class="hits">2</span>
          
          <code class="ruby">  after_create :create_default_offices</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="61">
          <span class="hits">2</span>
          
          <code class="ruby">  after_create :set_default_user_and_director_clauses</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="62">
          <span class="hits">2</span>
          
          <code class="ruby">  after_create :create_share_account_if_necessary</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  # ATTRIBUTES / CLAUSES</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="66">
          <span class="hits">2</span>
          
          <code class="ruby">  def meeting_notice_period=(new_meeting_notice_period)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="67">
          <span class="hits">7</span>
          
          <code class="ruby">    clauses.set_integer!(:meeting_notice_period, new_meeting_notice_period)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="70">
          <span class="hits">2</span>
          
          <code class="ruby">  def meeting_notice_period</code>
        </li>
      
        <li class="covered" data-hits="37" data-linenumber="71">
          <span class="hits">37</span>
          
          <code class="ruby">    clauses.get_integer(:meeting_notice_period)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="74">
          <span class="hits">2</span>
          
          <code class="ruby">  def quorum_number=(new_quorum_number)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="75">
          <span class="hits">3</span>
          
          <code class="ruby">    clauses.set_integer!(:quorum_number, new_quorum_number)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="78">
          <span class="hits">2</span>
          
          <code class="ruby">  def quorum_number</code>
        </li>
      
        <li class="covered" data-hits="33" data-linenumber="79">
          <span class="hits">33</span>
          
          <code class="ruby">    clauses.get_integer(:quorum_number)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="82">
          <span class="hits">2</span>
          
          <code class="ruby">  def quorum_percentage=(new_quorum_percentage)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="83">
          <span class="hits">3</span>
          
          <code class="ruby">    clauses.set_integer!(:quorum_percentage, new_quorum_percentage)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="86">
          <span class="hits">2</span>
          
          <code class="ruby">  def quorum_percentage</code>
        </li>
      
        <li class="covered" data-hits="33" data-linenumber="87">
          <span class="hits">33</span>
          
          <code class="ruby">    clauses.get_integer(:quorum_percentage)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="90">
          <span class="hits">2</span>
          
          <code class="ruby">  def objectives</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="91">
          <span class="hits">36</span>
          
          <code class="ruby">    @objectives ||= clauses.get_text('organisation_objectives')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="94">
          <span class="hits">2</span>
          
          <code class="ruby">  def objectives=(objectives)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="95">
          <span class="hits">3</span>
          
          <code class="ruby">    clauses.build(:name =&gt; 'organisation_objectives', :text_value =&gt; objectives)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="96">
          <span class="hits">3</span>
          
          <code class="ruby">    @objectives = objectives</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="99">
          <span class="hits">2</span>
          
          <code class="ruby">  def registered_office_address</code>
        </li>
      
        <li class="covered" data-hits="57" data-linenumber="100">
          <span class="hits">57</span>
          
          <code class="ruby">    @registered_office_address ||= clauses.get_text('registered_office_address')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="103">
          <span class="hits">2</span>
          
          <code class="ruby">  def registered_office_address=(registered_office_address)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">    clauses.build(:name =&gt; 'registered_office_address', :text_value =&gt; registered_office_address)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">    @registered_office_address = registered_office_address</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="108">
          <span class="hits">2</span>
          
          <code class="ruby">  def max_user_directors</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="109">
          <span class="hits">30</span>
          
          <code class="ruby">    @max_user_directors ||= clauses.get_integer('max_user_directors')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="112">
          <span class="hits">2</span>
          
          <code class="ruby">  def max_user_directors=(new_max_user_directors)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="113">
          <span class="hits">171</span>
          
          <code class="ruby">    clauses.build(:name =&gt; :max_user_directors, :integer_value =&gt; new_max_user_directors)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="114">
          <span class="hits">171</span>
          
          <code class="ruby">    @max_user_directors = new_max_user_directors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="117">
          <span class="hits">2</span>
          
          <code class="ruby">  def max_employee_directors</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="118">
          <span class="hits">30</span>
          
          <code class="ruby">    @max_employee_directors ||= clauses.get_integer('max_employee_directors')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="121">
          <span class="hits">2</span>
          
          <code class="ruby">  def max_employee_directors=(new_max_employee_directors)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="122">
          <span class="hits">171</span>
          
          <code class="ruby">    clauses.build(:name =&gt; :max_employee_directors, :integer_value =&gt; new_max_employee_directors)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="123">
          <span class="hits">171</span>
          
          <code class="ruby">    @max_employee_directors = new_max_employee_directors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="126">
          <span class="hits">2</span>
          
          <code class="ruby">  def max_supporter_directors</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="127">
          <span class="hits">30</span>
          
          <code class="ruby">    @max_supporter_directors ||= clauses.get_integer('max_supporter_directors')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="130">
          <span class="hits">2</span>
          
          <code class="ruby">  def max_supporter_directors=(new_max_supporter_directors)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="131">
          <span class="hits">171</span>
          
          <code class="ruby">    clauses.build(:name =&gt; :max_supporter_directors, :integer_value =&gt; new_max_supporter_directors)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="132">
          <span class="hits">171</span>
          
          <code class="ruby">    @max_supporter_directors = new_max_supporter_directors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="135">
          <span class="hits">2</span>
          
          <code class="ruby">  def max_producer_directors</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="136">
          <span class="hits">30</span>
          
          <code class="ruby">    @max_producer_directors ||= clauses.get_integer('max_producer_directors')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="139">
          <span class="hits">2</span>
          
          <code class="ruby">  def max_producer_directors=(new_max_producer_directors)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="140">
          <span class="hits">171</span>
          
          <code class="ruby">    clauses.build(:name =&gt; :max_producer_directors, :integer_value =&gt; new_max_producer_directors)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="141">
          <span class="hits">171</span>
          
          <code class="ruby">    @max_producer_directors = new_max_producer_directors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="144">
          <span class="hits">2</span>
          
          <code class="ruby">  def max_consumer_directors</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="145">
          <span class="hits">30</span>
          
          <code class="ruby">    @max_consumer_directors ||= clauses.get_integer('max_consumer_directors')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="148">
          <span class="hits">2</span>
          
          <code class="ruby">  def max_consumer_directors=(new_max_consumer_directors)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="149">
          <span class="hits">171</span>
          
          <code class="ruby">    clauses.build(:name =&gt; :max_consumer_directors, :integer_value =&gt; new_max_consumer_directors)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="150">
          <span class="hits">171</span>
          
          <code class="ruby">    @max_consumer_directors = new_max_consumer_directors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="153">
          <span class="hits">2</span>
          
          <code class="ruby">  def user_members</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="154">
          <span class="hits">50</span>
          
          <code class="ruby">    @user_members ||= clauses.get_boolean('user_members')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="157">
          <span class="hits">2</span>
          
          <code class="ruby">  def user_members=(new_user_members)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="158">
          <span class="hits">171</span>
          
          <code class="ruby">    clauses.build(:name =&gt; :user_members, :boolean_value =&gt; new_user_members)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="159">
          <span class="hits">171</span>
          
          <code class="ruby">    @user_members = new_user_members</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="162">
          <span class="hits">2</span>
          
          <code class="ruby">  def employee_members</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="163">
          <span class="hits">50</span>
          
          <code class="ruby">    @employee_members ||= clauses.get_boolean('employee_members')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="166">
          <span class="hits">2</span>
          
          <code class="ruby">  def employee_members=(new_employee_members)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="167">
          <span class="hits">171</span>
          
          <code class="ruby">    clauses.build(:name =&gt; :employee_members, :boolean_value =&gt; new_employee_members)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="168">
          <span class="hits">171</span>
          
          <code class="ruby">    @employee_members = new_employee_members</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="171">
          <span class="hits">2</span>
          
          <code class="ruby">  def supporter_members</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="172">
          <span class="hits">30</span>
          
          <code class="ruby">    @supporter_members ||= clauses.get_boolean('supporter_members')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="175">
          <span class="hits">2</span>
          
          <code class="ruby">  def supporter_members=(new_supporter_members)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="176">
          <span class="hits">171</span>
          
          <code class="ruby">    clauses.build(:name =&gt; :supporter_members, :boolean_value =&gt; new_supporter_members)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="177">
          <span class="hits">171</span>
          
          <code class="ruby">    @supporter_members = new_supporter_members</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="180">
          <span class="hits">2</span>
          
          <code class="ruby">  def producer_members</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="181">
          <span class="hits">30</span>
          
          <code class="ruby">    @producer_members ||= clauses.get_boolean('producer_members')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="184">
          <span class="hits">2</span>
          
          <code class="ruby">  def producer_members=(new_producer_members)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="185">
          <span class="hits">171</span>
          
          <code class="ruby">    clauses.build(:name =&gt; :producer_members, :boolean_value =&gt; new_producer_members)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="186">
          <span class="hits">171</span>
          
          <code class="ruby">    @producer_members = new_producer_members</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="189">
          <span class="hits">2</span>
          
          <code class="ruby">  def consumer_members</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="190">
          <span class="hits">30</span>
          
          <code class="ruby">    @consumer_members ||= clauses.get_boolean('consumer_members')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="193">
          <span class="hits">2</span>
          
          <code class="ruby">  def consumer_members=(new_consumer_members)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="194">
          <span class="hits">171</span>
          
          <code class="ruby">    clauses.build(:name =&gt; :consumer_members, :boolean_value =&gt; new_consumer_members)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="195">
          <span class="hits">171</span>
          
          <code class="ruby">    @consumer_members = new_consumer_members</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="198">
          <span class="hits">2</span>
          
          <code class="ruby">  def single_shareholding</code>
        </li>
      
        <li class="covered" data-hits="56" data-linenumber="199">
          <span class="hits">56</span>
          
          <code class="ruby">    @single_shareholding ||= clauses.get_boolean('single_shareholding')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="202">
          <span class="hits">2</span>
          
          <code class="ruby">  def single_shareholding=(new_single_shareholding)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="203">
          <span class="hits">1</span>
          
          <code class="ruby">    clauses.build(:name =&gt; :single_shareholding, :boolean_value =&gt; !!new_single_shareholding)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="204">
          <span class="hits">1</span>
          
          <code class="ruby">    @single_shareholding = !!new_single_shareholding</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="207">
          <span class="hits">2</span>
          
          <code class="ruby">  def common_ownership</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="208">
          <span class="hits">50</span>
          
          <code class="ruby">    @common_ownership ||= clauses.get_boolean('common_ownership')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="211">
          <span class="hits">2</span>
          
          <code class="ruby">  def share_value=(new_share_value)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="212">
          <span class="hits">3</span>
          
          <code class="ruby">    clauses.build(:name =&gt; :share_value, :integer_value =&gt; new_share_value.to_i)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="213">
          <span class="hits">3</span>
          
          <code class="ruby">    @share_value = new_share_value.to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">  # Share value in pennies. Defaults to 100.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="217">
          <span class="hits">2</span>
          
          <code class="ruby">  def share_value</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="218">
          <span class="hits">12</span>
          
          <code class="ruby">    @share_value ||= (clauses.get_integer('share_value') || 100)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="221">
          <span class="hits">2</span>
          
          <code class="ruby">  def share_value_in_pounds=(new_share_value_in_pounds)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="222">
          <span class="hits">2</span>
          
          <code class="ruby">    new_share_value_in_pounds = new_share_value_in_pounds.to_f</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="223">
          <span class="hits">2</span>
          
          <code class="ruby">    new_share_value = (new_share_value_in_pounds * 100.0).to_i</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="224">
          <span class="hits">2</span>
          
          <code class="ruby">    self.share_value = new_share_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="227">
          <span class="hits">2</span>
          
          <code class="ruby">  def share_value_in_pounds</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="228">
          <span class="hits">9</span>
          
          <code class="ruby">    share_value.to_f / 100.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="231">
          <span class="hits">2</span>
          
          <code class="ruby">  def minimum_shareholding=(new_minimum_shareholding)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="232">
          <span class="hits">2</span>
          
          <code class="ruby">    new_minimum_shareholding = new_minimum_shareholding.to_i</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="233">
          <span class="hits">2</span>
          
          <code class="ruby">    clauses.build(:name =&gt; :minimum_shareholding, :integer_value =&gt; new_minimum_shareholding)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="234">
          <span class="hits">2</span>
          
          <code class="ruby">    @minimum_shareholding = new_minimum_shareholding</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="237">
          <span class="hits">2</span>
          
          <code class="ruby">  def minimum_shareholding</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="238">
          <span class="hits">10</span>
          
          <code class="ruby">    @minimum_shareholding ||= (clauses.get_integer('minimum_shareholding') || 1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="241">
          <span class="hits">2</span>
          
          <code class="ruby">  def interest_rate</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="242">
          <span class="hits">11</span>
          
          <code class="ruby">    @interest_rate ||= clauses.get_decimal('interest_rate')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="245">
          <span class="hits">2</span>
          
          <code class="ruby">  def interest_rate=(new_interest_rate)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="246">
          <span class="hits">2</span>
          
          <code class="ruby">    new_interest_rate = new_interest_rate.to_f</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="247">
          <span class="hits">2</span>
          
          <code class="ruby">    clauses.build(:name =&gt; :interest_rate, :decimal_value =&gt; new_interest_rate)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="248">
          <span class="hits">2</span>
          
          <code class="ruby">    @interest_rate = new_interest_rate</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="251">
          <span class="hits">2</span>
          
          <code class="ruby">  def membership_application_text</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="252">
          <span class="hits">2</span>
          
          <code class="ruby">    @membership_application_text ||= clauses.get_text(:membership_application_text)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="255">
          <span class="hits">2</span>
          
          <code class="ruby">  def membership_application_text=(new_membership_application_text)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="256">
          <span class="hits">2</span>
          
          <code class="ruby">    clauses.build(:name =&gt; :membership_application_text, :text_value =&gt; new_membership_application_text)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="257">
          <span class="hits">2</span>
          
          <code class="ruby">    @membership_application_text = new_membership_application_text</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="258">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">  # SETUP</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="262">
          <span class="hits">2</span>
          
          <code class="ruby">  def create_default_member_classes</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="263">
          <span class="hits">171</span>
          
          <code class="ruby">    members = member_classes.find_or_create_by_name('Member')</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="264">
          <span class="hits">171</span>
          
          <code class="ruby">    members.set_permission!(:resolution_proposal, true)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="265">
          <span class="hits">171</span>
          
          <code class="ruby">    members.set_permission!(:vote, true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="267">
          <span class="hits">171</span>
          
          <code class="ruby">    founder_members = member_classes.find_or_create_by_name('Founder Member')</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="268">
          <span class="hits">171</span>
          
          <code class="ruby">    founder_members.set_permission!(:constitution, true)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="269">
          <span class="hits">171</span>
          
          <code class="ruby">    founder_members.set_permission!(:organisation, true)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="270">
          <span class="hits">171</span>
          
          <code class="ruby">    founder_members.set_permission!(:founder_member, true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="272">
          <span class="hits">171</span>
          
          <code class="ruby">    directors = member_classes.find_or_create_by_name('Director')</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="273">
          <span class="hits">171</span>
          
          <code class="ruby">    directors.set_permission!(:resolution, true)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="274">
          <span class="hits">171</span>
          
          <code class="ruby">    directors.set_permission!(:board_resolution, true)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="275">
          <span class="hits">171</span>
          
          <code class="ruby">    directors.set_permission!(:vote, true)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="276">
          <span class="hits">171</span>
          
          <code class="ruby">    directors.set_permission!(:meeting, true)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="277">
          <span class="hits">171</span>
          
          <code class="ruby">    directors.set_permission!(:board_meeting, true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="278">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="279">
          <span class="hits">171</span>
          
          <code class="ruby">    secretaries = member_classes.find_or_create_by_name('Secretary')</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="280">
          <span class="hits">171</span>
          
          <code class="ruby">    secretaries.set_permission!(:resolution, true)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="281">
          <span class="hits">171</span>
          
          <code class="ruby">    secretaries.set_permission!(:board_resolution, true)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="282">
          <span class="hits">171</span>
          
          <code class="ruby">    secretaries.set_permission!(:meeting, true)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="283">
          <span class="hits">171</span>
          
          <code class="ruby">    secretaries.set_permission!(:vote, true)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="284">
          <span class="hits">171</span>
          
          <code class="ruby">    secretaries.set_permission!(:board_meeting, true)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="285">
          <span class="hits">171</span>
          
          <code class="ruby">    secretaries.set_permission!(:member, true)</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="286">
          <span class="hits">171</span>
          
          <code class="ruby">    secretaries.set_permission!(:organisation, true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="289">
          <span class="hits">2</span>
          
          <code class="ruby">  def create_default_offices</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="290">
          <span class="hits">171</span>
          
          <code class="ruby">    offices.find_or_create_by_title('Secretary')</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="291">
          <span class="hits">171</span>
          
          <code class="ruby">    offices.find_or_create_by_title('Chairperson')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="293">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="294">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_voting_period</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="295">
          <span class="hits">171</span>
          
          <code class="ruby">    constitution.set_voting_period(14.days)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="298">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_user_and_director_clauses</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby">    # TODO Verify these are sensible defaults for the Rules</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="300">
          <span class="hits">171</span>
          
          <code class="ruby">    self.user_members = true</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="301">
          <span class="hits">171</span>
          
          <code class="ruby">    self.employee_members = true</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="302">
          <span class="hits">171</span>
          
          <code class="ruby">    self.supporter_members = true</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="303">
          <span class="hits">171</span>
          
          <code class="ruby">    self.producer_members = true</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="304">
          <span class="hits">171</span>
          
          <code class="ruby">    self.consumer_members = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="305">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="306">
          <span class="hits">171</span>
          
          <code class="ruby">    self.max_user_directors = 3</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="307">
          <span class="hits">171</span>
          
          <code class="ruby">    self.max_employee_directors = 3</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="308">
          <span class="hits">171</span>
          
          <code class="ruby">    self.max_supporter_directors = 3</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="309">
          <span class="hits">171</span>
          
          <code class="ruby">    self.max_producer_directors = 3</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="310">
          <span class="hits">171</span>
          
          <code class="ruby">    self.max_consumer_directors = 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="311">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="312">
          <span class="hits">171</span>
          
          <code class="ruby">    self.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="313">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="315">
          <span class="hits">2</span>
          
          <code class="ruby">  def destroy_pending_state_member_classes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="316">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="318">
          <span class="hits">2</span>
          
          <code class="ruby">  def create_share_account_if_necessary</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="319">
          <span class="hits">171</span>
          
          <code class="ruby">    unless share_account</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="320">
          <span class="hits">171</span>
          
          <code class="ruby">      create_share_account!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="321">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="323">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="324">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_eligible_to_vote?(member, proposal)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="325">
          <span class="hits">12</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="326">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="328">
          <span class="hits">2</span>
          
          <code class="ruby">  def secretary</code>
        </li>
      
        <li class="covered" data-hits="410" data-linenumber="329">
          <span class="hits">410</span>
          
          <code class="ruby">    secretary_member_class = member_classes.find_by_name('Secretary')</code>
        </li>
      
        <li class="covered" data-hits="410" data-linenumber="330">
          <span class="hits">410</span>
          
          <code class="ruby">    secretary_member_class ? secretary_member_class.members.last : nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="331">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="332">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="333">
          <span class="hits">2</span>
          
          <code class="ruby">  def directors</code>
        </li>
      
        <li class="covered" data-hits="78" data-linenumber="334">
          <span class="hits">78</span>
          
          <code class="ruby">    members.where([</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="335">
          
          
          <code class="ruby">      'member_class_id = ? OR member_class_id=?',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="336">
          
          
          <code class="ruby">      member_classes.find_by_name!('Director').id, member_classes.find_by_name!('Secretary').id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="337">
          
          
          <code class="ruby">    ])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="338">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="339">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="340">
          <span class="hits">2</span>
          
          <code class="ruby">  def build_directorship(attributes={})</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="341">
          <span class="hits">2</span>
          
          <code class="ruby">    Directorship.new({:organisation =&gt; self}.merge(attributes))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="342">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="343">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="344">
          <span class="hits">2</span>
          
          <code class="ruby">  def directors_retiring</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="345">
          
          
          <code class="ruby">    # TODO expand this to full rules of retirement</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="346">
          <span class="hits">17</span>
          
          <code class="ruby">    directors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="347">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="348">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="349">
          <span class="hits">2</span>
          
          <code class="ruby">  def build_general_meeting_or_annual_general_meeting(attributes={})</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="350">
          <span class="hits">8</span>
          
          <code class="ruby">    attributes = attributes.dup.with_indifferent_access</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="351">
          <span class="hits">8</span>
          
          <code class="ruby">    agm = cast_to_boolean(attributes.delete(:annual_general_meeting))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="352">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="353">
          <span class="hits">8</span>
          
          <code class="ruby">    if agm</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="354">
          <span class="hits">4</span>
          
          <code class="ruby">      begin</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="355">
          <span class="hits">4</span>
          
          <code class="ruby">        annual_general_meetings.build(attributes)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="356">
          
          
          <code class="ruby">      rescue ActiveRecord::MultiparameterAssignmentErrors =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="357">
          
          
          <code class="ruby">        raise e.errors.map{|e| [e.exception, e.attribute]}.inspect</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="358">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="359">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="360">
          <span class="hits">4</span>
          
          <code class="ruby">      general_meetings.build(attributes)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="364">
          <span class="hits">2</span>
          
          <code class="ruby">  def welcome_email_action</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="365">
          <span class="hits">3</span>
          
          <code class="ruby">    if pending?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="366">
          <span class="hits">2</span>
          
          <code class="ruby">      :welcome_coop_founding_member</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="367">
          <span class="hits">1</span>
          
          <code class="ruby">    elsif active?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="368">
          <span class="hits">1</span>
          
          <code class="ruby">      :welcome_coop_new_member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="369">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="370">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="371">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="372">
          <span class="hits">2</span>
          
          <code class="ruby">  def build_founder_member(attributes={})</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="373">
          <span class="hits">4</span>
          
          <code class="ruby">    FounderMember.new(attributes).tap{|m|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="374">
          <span class="hits">4</span>
          
          <code class="ruby">      m.organisation = self</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="375">
          <span class="hits">4</span>
          
          <code class="ruby">      m.member_class = member_classes.find_by_name(&quot;Founder Member&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="376">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="377">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="378">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="379">
          
          
          <code class="ruby">  # True if the minimum required fields in the Rules have been filled in.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="380">
          <span class="hits">2</span>
          
          <code class="ruby">  def rules_filled?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="381">
          
          
          <code class="ruby">    name.present? &amp;&amp;</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="382">
          <span class="hits">24</span>
          
          <code class="ruby">      registered_office_address.present? &amp;&amp;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="383">
          
          
          <code class="ruby">      objectives.present?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="384">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="385">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="386">
          
          
          <code class="ruby">  # Registration form</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="387">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="388">
          <span class="hits">2</span>
          
          <code class="ruby">  def reg_form_timing_factors</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="389">
          
          
          <code class="ruby">    @reg_form_timing_factors ||= clauses.get_text('reg_form_timing_factors')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="390">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="391">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="392">
          <span class="hits">2</span>
          
          <code class="ruby">  def reg_form_timing_factors=(new_reg_form_timing_factors)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="393">
          
          
          <code class="ruby">    new_reg_form_timing_factors = ' ' if new_reg_form_timing_factors.blank?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="394">
          
          
          <code class="ruby">    clauses.build(:name =&gt; 'reg_form_timing_factors', :text_value =&gt; new_reg_form_timing_factors)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="395">
          
          
          <code class="ruby">    @reg_form_timing_factors = new_reg_form_timing_factors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="396">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="397">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="398">
          <span class="hits">2</span>
          
          <code class="ruby">  def reg_form_close_links</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="399">
          
          
          <code class="ruby">    @reg_form_close_links ||= clauses.get_text('reg_form_close_links')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="400">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="401">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="402">
          <span class="hits">2</span>
          
          <code class="ruby">  def reg_form_close_links=(new_reg_form_close_links)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="403">
          
          
          <code class="ruby">    new_reg_form_close_links = ' ' if new_reg_form_close_links.blank?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="404">
          
          
          <code class="ruby">    clauses.build(:name =&gt; 'reg_form_close_links', :text_value =&gt; new_reg_form_close_links)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="405">
          
          
          <code class="ruby">    @reg_form_close_links = new_reg_form_close_links</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="406">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="407">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="408">
          <span class="hits">2</span>
          
          <code class="ruby">  def reg_form_financial_year_end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="409">
          
          
          <code class="ruby">    @reg_form_financial_year_end ||= clauses.get_text('reg_form_financial_year_end')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="410">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="411">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="412">
          <span class="hits">2</span>
          
          <code class="ruby">  def reg_form_financial_year_end=(new_reg_form_financial_year_end)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="413">
          
          
          <code class="ruby">    new_reg_form_financial_year_end = ' ' if new_reg_form_financial_year_end.blank?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="414">
          
          
          <code class="ruby">    clauses.build(:name =&gt; 'reg_form_financial_year_end', :text_value =&gt; new_reg_form_financial_year_end)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="415">
          
          
          <code class="ruby">    @reg_form_finacial_year_end = new_reg_form_financial_year_end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="416">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="417">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="418">
          <span class="hits">2</span>
          
          <code class="ruby">  def reg_form_membership_required</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="419">
          <span class="hits">24</span>
          
          <code class="ruby">    @reg_form_membership_required ||= clauses.get_boolean('reg_form_membership_required')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="420">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="421">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="422">
          <span class="hits">2</span>
          
          <code class="ruby">  def reg_form_membership_required=(new_reg_form_membership_required)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="423">
          
          
          <code class="ruby">    return if new_reg_form_membership_required.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="424">
          
          
          <code class="ruby">    clauses.build(:name =&gt; 'reg_form_membership_required', :boolean_value =&gt; new_reg_form_membership_required)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="425">
          
          
          <code class="ruby">    @reg_form_membership_required = new_reg_form_membership_required</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="426">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="427">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="428">
          <span class="hits">2</span>
          
          <code class="ruby">  def registration_form_filled?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="429">
          
          
          <code class="ruby">    [</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="430">
          <span class="hits">24</span>
          
          <code class="ruby">      :membership_required</code>
        </li>
      
        <li class="covered" data-hits="72" data-linenumber="431">
          <span class="hits">72</span>
          
          <code class="ruby">    ].map{|name| &quot;reg_form_#{name}&quot;}.map{|name| !send(name).nil?}.inject(true){|memo, present| memo &amp;&amp; present}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="432">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="433">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="19ca86f6cab3d632f581887ada28c3e80fc9023d">
  <div class="header">
    <h3>app/models/decision.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>7</b> relevant lines. 
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class Decision &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible # none</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :proposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def organisation</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="7">
          <span class="hits">28</span>
          
          <code class="ruby">    proposal.organisation if proposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  def to_event</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="11">
          <span class="hits">7</span>
          
          <code class="ruby">    { :timestamp =&gt; self.proposal.close_date, :object =&gt; self, :kind =&gt; :decision }    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="1657823b01412dd49c6ad6b44143e883d4859ccf">
  <div class="header">
    <h3>app/models/director.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># A convenience class to allow creation of a Member model object, but using</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># 'Director.new' instead of 'Member.new'.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># Adds some director-specific validation</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">class Director &lt; Member</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  @abstract_class = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :certification, :elected_on, :stood_down_on</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :certification</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_acceptance_of :certification, :on =&gt; :create, :allow_nil =&gt; false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">  def send_new_director_notifications</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">    self.organisation.members.each do |member|</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="16">
          <span class="hits">8</span>
          
          <code class="ruby">      MembersMailer.notify_new_director(member, self).deliver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">  def send_stand_down_notification_emails</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">    self.organisation.members.each do |member|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="22">
          <span class="hits">6</span>
          
          <code class="ruby">      MembersMailer.notify_director_stand_down(member, self).deliver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="39950dd4b27d40525cf45fa330f2eb23edc0906d">
  <div class="header">
    <h3>app/models/directorship.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>23</b> relevant lines. 
      <span class="green"><b>23</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/cast_to_boolean'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">class Directorship &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  include OneClickOrgs::CastToBoolean</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :director, :director_id, :ended_on, :elected_on, :certification</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_reader :certification</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :organisation</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :director, :class_name =&gt; 'Member'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">  def director_name</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">    director.try(:name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  def certification=(new_certification)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="18">
          <span class="hits">3</span>
          
          <code class="ruby">    @certification = cast_to_boolean(new_certification)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">  after_save :set_member_class</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_member_class</code>
        </li>
      
        <li class="covered" data-hits="285" data-linenumber="23">
          <span class="hits">285</span>
          
          <code class="ruby">    return unless director &amp;&amp; (elected_on || ended_on)</code>
        </li>
      
        <li class="covered" data-hits="283" data-linenumber="24">
          <span class="hits">283</span>
          
          <code class="ruby">    if ended_on</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="25">
          <span class="hits">4</span>
          
          <code class="ruby">      member_member_class = organisation.member_classes.find_by_name('Member')</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="26">
          <span class="hits">4</span>
          
          <code class="ruby">      director.member_class = member_member_class if member_member_class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    elsif elected_on</code>
        </li>
      
        <li class="covered" data-hits="279" data-linenumber="28">
          <span class="hits">279</span>
          
          <code class="ruby">      current_member_class = director.member_class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="279" data-linenumber="30">
          <span class="hits">279</span>
          
          <code class="ruby">      director_member_class = organisation.member_classes.find_by_name('Director')</code>
        </li>
      
        <li class="covered" data-hits="279" data-linenumber="31">
          <span class="hits">279</span>
          
          <code class="ruby">      secretary_member_class = organisation.member_classes.find_by_name('Secretary')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="279" data-linenumber="33">
          <span class="hits">279</span>
          
          <code class="ruby">      return if current_member_class == director_member_class || current_member_class == secretary_member_class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="35">
          <span class="hits">5</span>
          
          <code class="ruby">      director.member_class = director_member_class if director_member_class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="37">
          <span class="hits">9</span>
          
          <code class="ruby">    director.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="736ec96780367d27cf1c64b29d2c21b9eb2912d9">
  <div class="header">
    <h3>app/models/eject_member_proposal.rb</h3>
    <h4><span class="green">93.33 %</span> covered</h4>
    <div>
      <b>15</b> relevant lines. 
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class EjectMemberProposal &lt; MembershipProposal</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :member_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  before_create :set_default_title</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_title</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="6">
          <span class="hits">4</span>
          
          <code class="ruby">    self.title ||= &quot;Eject #{organisation.members.find(member_id).name} from #{organisation.name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  def enact!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    # TODO why is this check here and not in the base class? and do we need a check here at all?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">    raise &quot;Can not enact a proposal which has not passed&quot; unless passed?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    # TODO: Needs backwards compatibility; previously stored the member's ID in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    # the 'id' key, not 'member_id'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">    member = organisation.members.find(parameters['member_id'])</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">    if organisation.pending?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">      # Special case: org in pending state</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">      member.destroy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">      member.eject!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_id</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="25">
          <span class="hits">7</span>
          
          <code class="ruby">    parameters['member_id']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_id=(member_id)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="29">
          <span class="hits">8</span>
          
          <code class="ruby">    parameters['member_id'] = member_id.to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5da37002fc08bc6c36d8de3eccdc6cf3c45a6603">
  <div class="header">
    <h3>app/models/election.rb</h3>
    <h4><span class="green">93.33 %</span> covered</h4>
    <div>
      <b>45</b> relevant lines. 
      <span class="green"><b>42</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class Election &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  state_machine :initial =&gt; :draft do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">    event :close do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">      transition :open =&gt; :closed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">    event :start do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">      transition :draft =&gt; :open</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">    after_transition :on =&gt; :close, :do =&gt; :after_close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :organisation</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :nominations</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :nominees, :through =&gt; :nominations</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :ballots</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_presence_of :seats</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_close</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="24">
          <span class="hits">7</span>
          
          <code class="ruby">    run!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">  def elected_nominees</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="28">
          <span class="hits">4</span>
          
          <code class="ruby">    return [] unless closed?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="29">
          <span class="hits">4</span>
          
          <code class="ruby">    nominations.elected.map(&amp;:nominee)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">  def defeated_nominees</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="33">
          <span class="hits">4</span>
          
          <code class="ruby">    return [] unless closed?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="34">
          <span class="hits">4</span>
          
          <code class="ruby">    nominations.defeated.map(&amp;:nominee)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="37">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.close_elections</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">    # Elections with a voting closing date of today should not be closed until the end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    # of today.</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="40">
          <span class="hits">3</span>
          
          <code class="ruby">    where([&quot;voting_closing_date &lt; ? AND state = 'open'&quot;, Date.today]).each(&amp;:close!)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="43">
          <span class="hits">2</span>
          
          <code class="ruby">  def run!</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="44">
          <span class="hits">7</span>
          
          <code class="ruby">    me = Meekster::Election.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="46">
          <span class="hits">7</span>
          
          <code class="ruby">    nomination_ids = nominations.map(&amp;:id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="48">
          <span class="hits">16</span>
          
          <code class="ruby">    mc = nomination_ids.map{|id| Meekster::Candidate.new(id.to_s)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="50">
          <span class="hits">7</span>
          
          <code class="ruby">    mb = ballots.map do |b|</code>
        </li>
      
        <li class="covered" data-hits="48" data-linenumber="51">
          <span class="hits">48</span>
          
          <code class="ruby">      ranking = b.ranking.map{|nomination_id| nomination_ids.index(nomination_id)}</code>
        </li>
      
        <li class="covered" data-hits="48" data-linenumber="52">
          <span class="hits">48</span>
          
          <code class="ruby">      ranking = ranking.map{|index| mc[index]}</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="53">
          <span class="hits">18</span>
          
          <code class="ruby">      Meekster::Ballot.new(ranking)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="56">
          <span class="hits">7</span>
          
          <code class="ruby">    me.candidates = mc</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="57">
          <span class="hits">7</span>
          
          <code class="ruby">    me.ballots = mb</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="58">
          <span class="hits">7</span>
          
          <code class="ruby">    me.seats = seats</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="60">
          <span class="hits">7</span>
          
          <code class="ruby">    me.run!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="62">
          <span class="hits">16</span>
          
          <code class="ruby">    elected = me.candidates.select{|c| c.state == :elected}</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="63">
          <span class="hits">16</span>
          
          <code class="ruby">    defeated = me.candidates.select{|c| c.state == :defeated}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="65">
          <span class="hits">7</span>
          
          <code class="ruby">    elected.each do |c|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="66">
          <span class="hits">6</span>
          
          <code class="ruby">      nominations.find(c.name).elect!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="69">
          <span class="hits">7</span>
          
          <code class="ruby">    defeated.each do |c|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="70">
          <span class="hits">3</span>
          
          <code class="ruby">      nominations.find(c.name).defeat!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  # TODO Remove this; it's for testing purposes only.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="75">
          <span class="hits">2</span>
          
          <code class="ruby">  def auto_cast_ballots</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">    eligible_members = organisation.members - ballots.map(&amp;:member)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">    eligible_members.each do |member|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">      ballots.create(:ranking =&gt; [nominations.first.id], :member =&gt; member)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f6c3081d06f3201cb4e3980267d82377f26fbc04">
  <div class="header">
    <h3>app/models/extraordinary_resolution.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ExtraordinaryResolution &lt; Resolution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ae21770099ec572ab3be1c92b313a841beee80db">
  <div class="header">
    <h3>app/models/found_association_proposal.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>36</b> relevant lines. 
      <span class="green"><b>36</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># Remove any founding members that did not vote in favour,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># and move association to 'active' state.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">class FoundAssociationProposal &lt; Proposal</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  validate :association_must_be_ready</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  def association_must_be_ready</code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="6">
          <span class="hits">39</span>
          
          <code class="ruby">    if new_record? &amp;&amp; !organisation.can_hold_founding_vote?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">      errors.add(:base, &quot;Organisation not ready to hold founding vote&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">  before_create :set_default_title</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_title</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="13">
          <span class="hits">18</span>
          
          <code class="ruby">    self.title ||= &quot;Proposal to found #{organisation.name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">  before_create :set_default_description</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_description</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="18">
          <span class="hits">18</span>
          
          <code class="ruby">    self.description ||= &quot;Found #{organisation.name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">  def notification_email_action</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="22">
          <span class="hits">18</span>
          
          <code class="ruby">    :notify_foundation_proposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">  def members_to_notify</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="26">
          <span class="hits">18</span>
          
          <code class="ruby">    organisation.members</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_reject(params)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="30">
          <span class="hits">4</span>
          
          <code class="ruby">    organisation.reject_founding! # Switching back to 'pending' org state.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    # The existence of a failed 'Found Association' proposal is the only record we keep of this.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">  def enact!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    # initial members are all founding members that didn't vote &quot;no&quot; (including </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    # members who abstained.)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="37">
          <span class="hits">9</span>
          
          <code class="ruby">    confirmed_member_ids = []</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="38">
          <span class="hits">9</span>
          
          <code class="ruby">    votes.each do |v|</code>
        </li>
      
        <li class="covered" data-hits="37" data-linenumber="39">
          <span class="hits">37</span>
          
          <code class="ruby">      confirmed_member_ids &lt;&lt; v.member_id unless v.for? == false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="42">
          <span class="hits">9</span>
          
          <code class="ruby">    organisation.members.each do |member|</code>
        </li>
      
        <li class="covered" data-hits="41" data-linenumber="43">
          <span class="hits">41</span>
          
          <code class="ruby">      member.member_class = organisation.member_classes.find_by_name('Member')</code>
        </li>
      
        <li class="covered" data-hits="41" data-linenumber="44">
          <span class="hits">41</span>
          
          <code class="ruby">      member.save!</code>
        </li>
      
        <li class="covered" data-hits="41" data-linenumber="45">
          <span class="hits">41</span>
          
          <code class="ruby">      unless confirmed_member_ids.include?(member.id)</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="46">
          <span class="hits">13</span>
          
          <code class="ruby">        member.eject! # Rather than destroying, so we can still send a goodbye message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="50">
          <span class="hits">9</span>
          
          <code class="ruby">    organisation.found!</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="51">
          <span class="hits">9</span>
          
          <code class="ruby">    organisation.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="54">
          <span class="hits">2</span>
          
          <code class="ruby">  def voting_system</code>
        </li>
      
        <li class="covered" data-hits="69" data-linenumber="55">
          <span class="hits">69</span>
          
          <code class="ruby">    VotingSystems.get('Founding')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="58">
          <span class="hits">2</span>
          
          <code class="ruby">  def voting_period</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="59">
          <span class="hits">70</span>
          
          <code class="ruby">    60 * 60 * 24 * 3 # Founding vote period is fixed at three days.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="62">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_count</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="63">
          <span class="hits">7</span>
          
          <code class="ruby">    organisation.members.count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="66">
          <span class="hits">2</span>
          
          <code class="ruby">  def automatic_proposer_support_vote?</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="67">
          <span class="hits">18</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f828802acb4f19baf30cbf9484aa253305240413">
  <div class="header">
    <h3>app/models/founder_member.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>2</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># A convenience class to allow creation of a Member model object, but using</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># 'FounderMember.new' instead of 'Member.new'.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># It does not do anything beyond this (for example, it does not set the member class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"># automatically.)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">class FounderMember &lt; Member</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  @abstract_class = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="53605500ea3993210b8306a63444f11d2f9d15b4">
  <div class="header">
    <h3>app/models/founding_member.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>2</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># A convenience class to allow creation of a Member model object, but using</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># 'FoundingMember.new' instead of 'Member.new'.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># It does not do anything beyond this (for example, it does not set the member class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"># automatically.)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">class FoundingMember &lt; Member</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  @abstract_class = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="de7300a69307856a1f5e4e411f41163dedc726a3">
  <div class="header">
    <h3>app/models/general_meeting.rb</h3>
    <h4><span class="green">95.83 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines. 
      <span class="green"><b>23</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class GeneralMeeting &lt; Meeting</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :start_time, :venue, :agenda, :certification, :existing_resolutions_attributes,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    :annual_general_meeting, :electronic_nominations, :nominations_closing_date,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    :electronic_voting, :voting_closing_date</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :resolutions, :foreign_key =&gt; 'meeting_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :certification, :annual_general_meeting</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :electronic_nominations, :nominations_closing_date,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    :electronic_voting, :voting_closing_date</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def existing_resolutions_attributes=(attributes)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    # The attributes received from the form will look something like this:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    # {&quot;0&quot;=&gt;{&quot;attached&quot;=&gt;&quot;1&quot;, &quot;id&quot;=&gt;&quot;7&quot;}, &quot;1&quot;=&gt;{&quot;attached&quot;=&gt;&quot;0&quot;, &quot;id&quot;=&gt;&quot;9&quot;}}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    # We want to find only the resolutions that have been attached, and</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    # grab their IDs.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="19">
          <span class="hits">3</span>
          
          <code class="ruby">    return unless attributes.is_a?(Hash)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="21">
          <span class="hits">8</span>
          
          <code class="ruby">    ids_to_attach = attributes.values.select{|a| a['attached'] == '1'}.map{|a| a['id'].to_i}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    # TODO Resolution search should be scoped by organisation,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    # but organisation is not set yet when building this general meeting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    # in the form @organisation.general_meetings.build(attributes)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="26">
          <span class="hits">4</span>
          
          <code class="ruby">    resolutions_to_attach = ids_to_attach.map{|id| Resolution.find_by_id(id)}</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">    resolutions_to_attach.delete_if(&amp;:nil?)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">    resolutions &lt;&lt; resolutions_to_attach</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">    attributes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">  def creation_notification_email_action</code>
        </li>
      
        <li class="covered" data-hits="33" data-linenumber="34">
          <span class="hits">33</span>
          
          <code class="ruby">    :notify_general_meeting_creation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="37">
          <span class="hits">2</span>
          
          <code class="ruby">  def members_to_notify</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="38">
          <span class="hits">34</span>
          
          <code class="ruby">    organisation.members</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">  def to_event</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">    {:timestamp =&gt; created_at, :object =&gt; self, :kind =&gt; :general_meeting}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  # To fake multi-parameter date assignment for 'nominations_closing_date' attribute</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="47">
          <span class="hits">2</span>
          
          <code class="ruby">  def column_for_attribute(attribute)</code>
        </li>
      
        <li class="covered" data-hits="557" data-linenumber="48">
          <span class="hits">557</span>
          
          <code class="ruby">    case attribute.to_sym</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    when :nominations_closing_date, :voting_closing_date</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="50">
          <span class="hits">24</span>
          
          <code class="ruby">      Column.new.tap{|c| c.klass = Date}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="545" data-linenumber="52">
          <span class="hits">545</span>
          
          <code class="ruby">      super</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="56">
          <span class="hits">2</span>
          
          <code class="ruby">  class Column</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="57">
          <span class="hits">2</span>
          
          <code class="ruby">    attr_accessor :klass</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="22d9891380a79222ec8eeae919fd839b3b309528">
  <div class="header">
    <h3>app/models/invitation.rb</h3>
    <h4><span class="green">96.88 %</span> covered</h4>
    <div>
      <b>32</b> relevant lines. 
      <span class="green"><b>31</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/model_wrapper'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># Wraps a Member instance, allowing finding via invitation_code, and</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># access to the member's password attributes.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"># Includes some logic about what should happen during the process of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"># processing a member's invitation.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">class Invitation &lt; OneClickOrgs::ModelWrapper</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_initialize</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="10">
          <span class="hits">27</span>
          
          <code class="ruby">    raise ArgumentError, &quot;Member must be supplied&quot; unless member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="12">
          <span class="hits">27</span>
          
          <code class="ruby">    if member.organisation.terms_and_conditions_required?</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="13">
          <span class="hits">15</span>
          
          <code class="ruby">      self.terms_and_conditions = '0'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  def show_founding_warnings?</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="18">
          <span class="hits">9</span>
          
          <code class="ruby">    member &amp;&amp; member.founding_member?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">  def clear_invitation_code!</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="22">
          <span class="hits">9</span>
          
          <code class="ruby">    member.clear_invitation_code!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">  def save</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="26">
          <span class="hits">9</span>
          
          <code class="ruby">    if member.save</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="27">
          <span class="hits">9</span>
          
          <code class="ruby">      clear_invitation_code!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">      # TODO Move this to somewhere more sensible</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="30">
          <span class="hits">9</span>
          
          <code class="ruby">      if member.organisation.is_a?(Coop)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">        member.induct!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">        st = ShareTransaction.create(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">          :to_account =&gt; @member.find_or_create_share_account,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">          :from_account =&gt; @member.organisation.share_account,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">          :amount =&gt; 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">        st.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="41">
          <span class="hits">9</span>
          
          <code class="ruby">      true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">      false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="47">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_reader :member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="49">
          <span class="hits">2</span>
          
          <code class="ruby">  def member=(member)</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="50">
          <span class="hits">27</span>
          
          <code class="ruby">    @member = member</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="51">
          <span class="hits">27</span>
          
          <code class="ruby">    id = member.invitation_code</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="54">
          <span class="hits">2</span>
          
          <code class="ruby">  delegate :name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    :first_name, :first_name=,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    :last_name, :last_name=,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">    :email, :email=,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">    :password, :password=,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">    :password_confirmation, :password_confirmation=,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">    :terms_and_conditions, :terms_and_conditions=,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">    :to =&gt; :member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="63">
          <span class="hits">2</span>
          
          <code class="ruby">  def id</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="64">
          <span class="hits">18</span>
          
          <code class="ruby">    member.try(:invitation_code)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="67">
          <span class="hits">2</span>
          
          <code class="ruby">  def persisted?</code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="68">
          <span class="hits">46</span>
          
          <code class="ruby">    member &amp;&amp; member.persisted?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="71">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.find_by_id(id)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="72">
          <span class="hits">19</span>
          
          <code class="ruby">    member = Member.find_by_invitation_code(id)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="73">
          <span class="hits">19</span>
          
          <code class="ruby">    if member</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="74">
          <span class="hits">18</span>
          
          <code class="ruby">      new(:member =&gt; member)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">      nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f6b58bef81caf67b905dfa8fa8b46acf88cb80bb">
  <div class="header">
    <h3>app/models/meeting.rb</h3>
    <h4><span class="green">95.83 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines. 
      <span class="green"><b>23</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class Meeting &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :happened_on, :participant_ids, :minutes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_presence_of :organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :meeting_participations</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :participants, :through =&gt; :meeting_participations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :creator, :class_name =&gt; 'Member', :foreign_key =&gt; 'creator_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :comments, :as =&gt; :commentable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  # 'Upcoming' scope includes meetings happening today.</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="16">
          <span class="hits">28</span>
          
          <code class="ruby">  scope :upcoming, lambda{where(['happened_on &gt;= ?', Time.now.utc.to_date])}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="18">
          <span class="hits">28</span>
          
          <code class="ruby">  scope :past, lambda{where(['happened_on &lt; ?', Time.now.utc.to_date])}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">  def to_event</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="21">
          <span class="hits">3</span>
          
          <code class="ruby">    {:timestamp =&gt; created_at, :object =&gt; self, :kind =&gt; :meeting}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  # This processes the parameters from a form of checkboxes,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  # where the names are the member IDs, and the values are</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  # '1' when the checkbox is selected.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">  def participant_ids=(participant_ids)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="28">
          <span class="hits">5</span>
          
          <code class="ruby">    unless organisation</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">      raise RuntimeError, &quot;Organisation must be set before setting participant IDs&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="32">
          <span class="hits">5</span>
          
          <code class="ruby">    participant_ids.keys.each do |participant_id|</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="33">
          <span class="hits">10</span>
          
          <code class="ruby">      participant = organisation.members.find_by_id(participant_id)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="34">
          <span class="hits">10</span>
          
          <code class="ruby">      participants &lt;&lt; participant if participant</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">  def past?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="39">
          <span class="hits">3</span>
          
          <code class="ruby">    happened_on &amp;&amp; happened_on &lt; Time.now.utc.to_date</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>
          
          <code class="ruby">  def creation_notification_email_action</code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="43">
          <span class="hits">39</span>
          
          <code class="ruby">    :notify_creation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="46">
          <span class="hits">2</span>
          
          <code class="ruby">  def members_to_notify</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="47">
          <span class="hits">42</span>
          
          <code class="ruby">    organisation.members</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="52028891955eb6fdba2586159e6c991d5bda6b84">
  <div class="header">
    <h3>app/models/meeting_participation.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class MeetingParticipation &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :participant_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :meeting</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :participant, :class_name =&gt; 'Member'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f729890a43f038a0bbf7968e73e9b89f46bb81d3">
  <div class="header">
    <h3>app/models/member.rb</h3>
    <h4><span class="green">96.19 %</span> covered</h4>
    <div>
      <b>105</b> relevant lines. 
      <span class="green"><b>101</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/user_authentication'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/invitation_code'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/notification_consumer'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">require 'mail/elements/address'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">require 'lib/vote_error'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">class Member &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :email, :first_name, :last_name, :role, :terms_and_conditions,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    :password, :password_confirmation, :send_welcome,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    :address, :certify_share_application, :certify_age</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :email, :first_name, :last_name, :role, :terms_and_conditions,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    :password, :password_confirmation, :send_welcome, :member_class_id, :as =&gt; :proposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">  state_machine :initial =&gt; :pending do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">    event :induct do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">      transition :pending =&gt; :active</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">    event :eject do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">      transition [:pending, :active] =&gt; :inactive</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">    event :reactivate do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">      transition :inactive =&gt; :active, :if =&gt; :inducted?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">      transition :inactive =&gt; :pending</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">    event :resign do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">      transition [:pending, :active] =&gt; :inactive</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">    store_audit_trail</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="36">
          <span class="hits">2</span>
          
          <code class="ruby">  include OneClickOrgs::UserAuthentication</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="37">
          <span class="hits">2</span>
          
          <code class="ruby">  include OneClickOrgs::InvitationCode</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">  include OneClickOrgs::NotificationConsumer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :send_welcome</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :organisation</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="43">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :member_class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="45">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :votes</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="46">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :proposals, :foreign_key =&gt; 'proposer_member_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="48">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :ballots</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="50">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :tasks</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="52">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :resignations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="54">
          <span class="hits">2</span>
          
          <code class="ruby">  has_one :office, :through =&gt; :officership</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="55">
          <span class="hits">2</span>
          
          <code class="ruby">  has_one :officership, :order =&gt; 'created_at DESC', :foreign_key =&gt; 'officer_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="57">
          <span class="hits">2</span>
          
          <code class="ruby">  has_one :directorship, :order =&gt; 'elected_on DESC', :foreign_key =&gt; 'director_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="59">
          <span class="hits">2</span>
          
          <code class="ruby">  has_one :share_account, :as =&gt; :owner</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="61">
          <span class="hits">2</span>
          
          <code class="ruby">  scope :active, with_state(:active)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="62">
          <span class="hits">2</span>
          
          <code class="ruby">  scope :inactive, with_state(:inactive)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="63">
          <span class="hits">2</span>
          
          <code class="ruby">  scope :pending, with_state(:pending)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="59" data-linenumber="65">
          <span class="hits">59</span>
          
          <code class="ruby">  scope :founders, lambda {|org| { :conditions =&gt; { :member_class_id =&gt; org.member_classes.where(:name =&gt; 'Founder').first } } }</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="66">
          <span class="hits">2</span>
          
          <code class="ruby">  scope :founding_members, lambda {|org| { :conditions =&gt; { :member_class_id =&gt; org.member_classes.where(:name =&gt; 'Founding Member').first } } }</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="67">
          <span class="hits">15</span>
          
          <code class="ruby">  scope :founder_members, lambda {|org| { :conditions =&gt; { :member_class_id =&gt; org.member_classes.where(:name =&gt; 'Founder Member').first } } }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="69">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_presence_of :first_name, :last_name, :email</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="71">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_format_of :email, :with =&gt; /\A.*@.*\..*\Z/</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="72">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_each :email do |record, attribute, value|</code>
        </li>
      
        <li class="covered" data-hits="1076" data-linenumber="73">
          <span class="hits">1076</span>
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="covered" data-hits="1076" data-linenumber="74">
          <span class="hits">1076</span>
          
          <code class="ruby">      address = Mail::Address.new(value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">    rescue Mail::Field::ParseError</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">      record.errors.add(attribute, 'is invalid.')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="80">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_uniqueness_of :email, :scope =&gt; :organisation_id, :unless =&gt; :allow_duplicate_email?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="82">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :allow_duplicate_email</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="83">
          <span class="hits">2</span>
          
          <code class="ruby">  def allow_duplicate_email?</code>
        </li>
      
        <li class="covered" data-hits="1076" data-linenumber="84">
          <span class="hits">1076</span>
          
          <code class="ruby">    !!allow_duplicate_email</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="87">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :terms_and_conditions</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="88">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_acceptance_of :terms_and_conditions</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="90">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :certify_share_application</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="91">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :certify_age</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="93">
          <span class="hits">2</span>
          
          <code class="ruby">  def proposals_count</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="94">
          <span class="hits">28</span>
          
          <code class="ruby">    proposals.count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="97">
          <span class="hits">2</span>
          
          <code class="ruby">  def succeeded_proposals_count</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="98">
          <span class="hits">28</span>
          
          <code class="ruby">    proposals.where(:state =&gt; 'accepted').count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="101">
          <span class="hits">2</span>
          
          <code class="ruby">  def failed_proposals_count</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="102">
          <span class="hits">28</span>
          
          <code class="ruby">    proposals.where(:state =&gt; 'rejected').count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="105">
          <span class="hits">2</span>
          
          <code class="ruby">  def votes_count</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="106">
          <span class="hits">28</span>
          
          <code class="ruby">    votes.count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="109">
          <span class="hits">2</span>
          
          <code class="ruby">  def eligible_to_vote?(proposal)</code>
        </li>
      
        <li class="covered" data-hits="161" data-linenumber="110">
          <span class="hits">161</span>
          
          <code class="ruby">    organisation.member_eligible_to_vote?(self, proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="113">
          <span class="hits">2</span>
          
          <code class="ruby">  def cast_vote(action, proposal)</code>
        </li>
      
        <li class="covered" data-hits="138" data-linenumber="114">
          <span class="hits">138</span>
          
          <code class="ruby">    raise ArgumentError, &quot;need action and proposal&quot; unless action and proposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="138" data-linenumber="116">
          <span class="hits">138</span>
          
          <code class="ruby">    existing_vote = Vote.where(:member_id =&gt; self.id, :proposal_id =&gt; proposal.id).first</code>
        </li>
      
        <li class="covered" data-hits="138" data-linenumber="117">
          <span class="hits">138</span>
          
          <code class="ruby">    raise VoteError, &quot;Vote already exists for this proposal&quot; if existing_vote</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="137" data-linenumber="119">
          <span class="hits">137</span>
          
          <code class="ruby">    unless eligible_to_vote?(proposal)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="120">
          <span class="hits">1</span>
          
          <code class="ruby">      raise VoteError, &quot;Cannot vote on proposals created before member is inducted and the organisation has been proposed.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="136" data-linenumber="123">
          <span class="hits">136</span>
          
          <code class="ruby">    case action</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">    when :for</code>
        </li>
      
        <li class="covered" data-hits="108" data-linenumber="125">
          <span class="hits">108</span>
          
          <code class="ruby">      Vote.create(:member =&gt; self, :proposal =&gt; proposal, :for =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">    when :against</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="127">
          <span class="hits">28</span>
          
          <code class="ruby">      Vote.create(:member =&gt; self, :proposal =&gt; proposal, :for =&gt; false)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="131">
          <span class="hits">2</span>
          
          <code class="ruby">  def inducted?</code>
        </li>
      
        <li class="covered" data-hits="539" data-linenumber="132">
          <span class="hits">539</span>
          
          <code class="ruby">    !inducted_at.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="135">
          <span class="hits">2</span>
          
          <code class="ruby">  def to_event</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">    # TODO Push this knowledge somewhere more appropriate</code>
        </li>
      
        <li class="covered" data-hits="302" data-linenumber="137">
          <span class="hits">302</span>
          
          <code class="ruby">    if inducted?</code>
        </li>
      
        <li class="covered" data-hits="296" data-linenumber="138">
          <span class="hits">296</span>
          
          <code class="ruby">      {:timestamp =&gt; self.inducted_at, :object =&gt; self, :kind =&gt; :new_member}</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="139">
          <span class="hits">6</span>
          
          <code class="ruby">    elsif organisation.is_a?(Coop)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="140">
          <span class="hits">1</span>
          
          <code class="ruby">      {:timestamp =&gt; self.created_at, :object =&gt; self, :kind =&gt; :new_member}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="144">
          <span class="hits">2</span>
          
          <code class="ruby">  def has_permission(type)</code>
        </li>
      
        <li class="covered" data-hits="3036" data-linenumber="145">
          <span class="hits">3036</span>
          
          <code class="ruby">    return false if member_class.nil? # XXX should always have a member class?</code>
        </li>
      
        <li class="covered" data-hits="3036" data-linenumber="146">
          <span class="hits">3036</span>
          
          <code class="ruby">    member_class.has_permission(type)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="149">
          <span class="hits">2</span>
          
          <code class="ruby">  def name</code>
        </li>
      
        <li class="covered" data-hits="2445" data-linenumber="150">
          <span class="hits">2445</span>
          
          <code class="ruby">    full_name = [first_name, last_name].compact.join(' ')</code>
        </li>
      
        <li class="covered" data-hits="2445" data-linenumber="151">
          <span class="hits">2445</span>
          
          <code class="ruby">    full_name.blank? ? nil : full_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">  # A member is a founding member if they were created before the association's</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">  # founding proposal, or if they are in an association that has not had a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">  # founding proposal yet.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="157">
          <span class="hits">2</span>
          
          <code class="ruby">  def founding_member?</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="158">
          <span class="hits">9</span>
          
          <code class="ruby">    return false unless organisation.is_a?(Association)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="160">
          
          
          <code class="ruby">    fap = organisation.found_association_proposals.last</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">    if fap</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="162">
          
          
          <code class="ruby">      self.created_at &lt; fap.creation_date</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="164">
          
          
          <code class="ruby">      true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">  # GRAVATAR</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="170">
          <span class="hits">2</span>
          
          <code class="ruby">  def gravatar_url(size)</code>
        </li>
      
        <li class="covered" data-hits="122" data-linenumber="171">
          <span class="hits">122</span>
          
          <code class="ruby">    hash = Digest::MD5.hexdigest(email.downcase)</code>
        </li>
      
        <li class="covered" data-hits="122" data-linenumber="172">
          <span class="hits">122</span>
          
          <code class="ruby">    &quot;http://www.gravatar.com/avatar/#{hash}?s=#{size}&amp;d=mm&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">  # FOUNDING VOTE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="177">
          <span class="hits">2</span>
          
          <code class="ruby">  def founding_vote</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">    # The first vote of a founder will always be the founding vote</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="179">
          <span class="hits">5</span>
          
          <code class="ruby">    self.votes.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">  # SHARES</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="184">
          <span class="hits">2</span>
          
          <code class="ruby">  def shares_count</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="185">
          <span class="hits">10</span>
          
          <code class="ruby">    find_or_build_share_account.balance</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="188">
          <span class="hits">2</span>
          
          <code class="ruby">  def find_or_build_share_account</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="189">
          <span class="hits">11</span>
          
          <code class="ruby">    share_account || build_share_account</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="192">
          <span class="hits">2</span>
          
          <code class="ruby">  def find_or_create_share_account</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="193">
          <span class="hits">3</span>
          
          <code class="ruby">    share_account || create_share_account!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">  #FINDERS</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="198">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.find_by_name(name)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="199">
          <span class="hits">2</span>
          
          <code class="ruby">    find_by_first_name_and_last_name(*name.split(' '))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3da331b8d972c4fbd560f29ce1aaa87cb0646806">
  <div class="header">
    <h3>app/models/member_class.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>17</b> relevant lines. 
      <span class="green"><b>17</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class MemberClass &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :name, :description</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :organisation</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :members</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_presence_of :name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  def has_permission(type)</code>
        </li>
      
        <li class="covered" data-hits="3039" data-linenumber="10">
          <span class="hits">3039</span>
          
          <code class="ruby">    organisation.clauses.get_boolean(get_permission_name(type)) || false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  alias_method :has_permission?, :has_permission</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_permission!(type, value)</code>
        </li>
      
        <li class="covered" data-hits="6970" data-linenumber="15">
          <span class="hits">6970</span>
          
          <code class="ruby">    organisation.clauses.set_boolean!(get_permission_name(type), value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">  def destroy</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="19">
          <span class="hits">13</span>
          
          <code class="ruby">    super</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    # Delete clauses that codify this member class's abilities</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    # (if we modelled member classes as relation we could simply cascade...)</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="22">
          <span class="hits">13</span>
          
          <code class="ruby">    clauses = organisation.clauses.where('name LIKE :name', { :name =&gt; get_permission_name('%') })</code>
        </li>
      
        <li class="covered" data-hits="87" data-linenumber="23">
          <span class="hits">87</span>
          
          <code class="ruby">    clauses.each { |c| c.destroy }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">  def get_permission_name(type)</code>
        </li>
      
        <li class="covered" data-hits="10022" data-linenumber="29">
          <span class="hits">10022</span>
          
          <code class="ruby">    &quot;permission_#{self.name.underscore}_#{type.to_s.underscore}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="13c91d565c7291cae00dbcf9f5ebd447ebe7750a">
  <div class="header">
    <h3>app/models/member_state_transition.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class MemberStateTransition &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :member</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :member_id, :created_at, :event, :from, :to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="79cdc499ee99f6851d36a599d8978a36729c38c8">
  <div class="header">
    <h3>app/models/membership_proposal.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class MembershipProposal &lt; Proposal  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def voting_system</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="3">
          <span class="hits">6</span>
          
          <code class="ruby">    organisation.constitution.voting_system(:membership)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def decision_notification_message</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="7">
          <span class="hits">18</span>
          
          <code class="ruby">    &quot;If you have previously printed/saved a PDF copy of the member list, this prior copy is now out of date. Please consider reprinting/saving a copy of the latest member list for your records.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="6fe90238a079347ab9f084b7f93c2fecd82f7118">
  <div class="header">
    <h3>app/models/nomination.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class Nomination &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :nominee</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  state_machine :initial =&gt; :nominated do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">    event :elect do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">      transition :nominated =&gt; :elected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">    event :defeat do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">      transition :nominated =&gt; :defeated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">  scope :elected, with_state(:elected)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">  scope :defeated, with_state(:defeated)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :nominee, :class_name =&gt; 'Member'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">  delegate :name, :to =&gt; :nominee</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ba8b1d3e36673b534917e40e99f3a27f81285bcf">
  <div class="header">
    <h3>app/models/office.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>7</b> relevant lines. 
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class Office &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :organisation_id, :title</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :organisation, :class_name =&gt; 'Coop', :inverse_of =&gt; :offices</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  has_one :officership,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    :order =&gt; &quot;created_at DESC&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    :conditions =&gt; proc{[</code>
        </li>
      
        <li class="covered" data-hits="177" data-linenumber="9">
          <span class="hits">177</span>
          
          <code class="ruby">      &quot;(ended_on IS NULL OR ended_on &gt; :now) AND officerships.elected_on &lt;= :now&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">      {:now =&gt; Time.now.utc}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    ]},</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    :inverse_of =&gt; :office</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">  has_one :officer, :through =&gt; :officership</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_presence_of :title</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5805faacdc8e224192305f03141beecf0d35bcde">
  <div class="header">
    <h3>app/models/officership.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines. 
      <span class="green"><b>24</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/cast_to_boolean'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># An Officership represents the period during which a particular</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># person occupies a particular office.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"># </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"># Each Office can only have one current Officership, but will have</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"># a history of many Officerships as different people occupy the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"># Office.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"># </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"># Similarly, a Member can only have one current Officership (i.e.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"># they can only occupy one Office at a time). But they may build</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"># up a history of many Officerships if they occupy several Offices</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"># in sequence.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">class Officership &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">  include OneClickOrgs::CastToBoolean</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :office_id, :office_attributes, :officer_id, :officer, :certification, :elected_on, :ended_on</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_reader :certification</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :office</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :officer, :class_name =&gt; 'Member'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">  accepts_nested_attributes_for :office, :reject_if =&gt; :all_blank</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">  def officer_name</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    officer.try(:name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">  def office_title</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    office.try(:title)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  # after_initialize :build_office_if_necessary</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  # def build_office_if_necessary</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  #   if new_record? &amp;&amp; !office</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  #     build_office</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  #   end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  # end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">  def certification=(new_certification)</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="42">
          <span class="hits">13</span>
          
          <code class="ruby">    @certification = cast_to_boolean(new_certification)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  # This needs to run after validation, not before save, since</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  # the organisation gets saved by ActiveRecord between the validation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  # and save steps.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="48">
          <span class="hits">2</span>
          
          <code class="ruby">  after_validation :set_organisation_of_new_office_if_necessary</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="49">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_organisation_of_new_office_if_necessary</code>
        </li>
      
        <li class="covered" data-hits="120" data-linenumber="50">
          <span class="hits">120</span>
          
          <code class="ruby">    if office &amp;&amp; office.new_record? &amp;&amp; office.organisation.blank?</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="51">
          <span class="hits">5</span>
          
          <code class="ruby">      office.organisation = officer.organisation unless officer.blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="55">
          <span class="hits">2</span>
          
          <code class="ruby">  after_validation :set_member_class_of_officer_if_necessary</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="56">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_member_class_of_officer_if_necessary</code>
        </li>
      
        <li class="covered" data-hits="120" data-linenumber="57">
          <span class="hits">120</span>
          
          <code class="ruby">    if office &amp;&amp; office.title == &quot;Secretary&quot;</code>
        </li>
      
        <li class="covered" data-hits="57" data-linenumber="58">
          <span class="hits">57</span>
          
          <code class="ruby">      if officer</code>
        </li>
      
        <li class="covered" data-hits="57" data-linenumber="59">
          <span class="hits">57</span>
          
          <code class="ruby">        secretary_member_class = officer.organisation.member_classes.find_by_name(&quot;Secretary&quot;)</code>
        </li>
      
        <li class="covered" data-hits="57" data-linenumber="60">
          <span class="hits">57</span>
          
          <code class="ruby">        officer.update_attribute(:member_class, secretary_member_class) if secretary_member_class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="54a33049d7a70da3fcac115abab06b2c157d9624">
  <div class="header">
    <h3>app/models/organisation.rb</h3>
    <h4><span class="green">90.38 %</span> covered</h4>
    <div>
      <b>52</b> relevant lines. 
      <span class="green"><b>47</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class Organisation &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :subdomain, :name, :objectives, :assets</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :clauses</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :members</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :resignations, :through =&gt; :members</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :proposals</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :change_boolean_proposals</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :change_text_proposals</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :decisions, :through =&gt; :proposals</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :member_classes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_presence_of :name</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_uniqueness_of :subdomain</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_format_of :subdomain, :with =&gt; /\A[a-zA-z0-9\-]*\Z/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">  after_create :create_default_member_classes</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">  after_create :set_default_voting_systems</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">  after_create :set_default_voting_period</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  # Given a full hostname, e.g. &quot;myorganisation.oneclickorgs.com&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  # and assuming the installation's base domain is &quot;oneclickorgs.com&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  # returns the organisation corresponding to the subdomain</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  # &quot;myorganisation&quot;.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.find_by_host(host)</code>
        </li>
      
        <li class="covered" data-hits="817" data-linenumber="31">
          <span class="hits">817</span>
          
          <code class="ruby">    subdomain = host.sub(Regexp.new(&quot;\.#{Setting[:base_domain]}$&quot;), '')</code>
        </li>
      
        <li class="covered" data-hits="817" data-linenumber="32">
          <span class="hits">817</span>
          
          <code class="ruby">    where(:subdomain =&gt; subdomain).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">  def constitution</code>
        </li>
      
        <li class="covered" data-hits="1840" data-linenumber="36">
          <span class="hits">1840</span>
          
          <code class="ruby">    @constitution ||= Constitution.new(self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="39">
          <span class="hits">2</span>
          
          <code class="ruby">  def name</code>
        </li>
      
        <li class="covered" data-hits="3001" data-linenumber="40">
          <span class="hits">3001</span>
          
          <code class="ruby">    @name ||= clauses.get_text('organisation_name')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="43">
          <span class="hits">2</span>
          
          <code class="ruby">  def name=(name)</code>
        </li>
      
        <li class="covered" data-hits="759" data-linenumber="44">
          <span class="hits">759</span>
          
          <code class="ruby">    clauses.build(:name =&gt; 'organisation_name', :text_value =&gt; name)</code>
        </li>
      
        <li class="covered" data-hits="759" data-linenumber="45">
          <span class="hits">759</span>
          
          <code class="ruby">    @name = name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="48">
          <span class="hits">2</span>
          
          <code class="ruby">  def voting_period</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">    clauses.get_integer('voting_period')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  # Returns the base URL for this instance of OCO.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  # Pass the :only_host =&gt; true option to just get the host name.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="54">
          <span class="hits">2</span>
          
          <code class="ruby">  def domain(options={})</code>
        </li>
      
        <li class="covered" data-hits="703" data-linenumber="55">
          <span class="hits">703</span>
          
          <code class="ruby">    raw_domain = host</code>
        </li>
      
        <li class="covered" data-hits="703" data-linenumber="56">
          <span class="hits">703</span>
          
          <code class="ruby">    if options[:only_host]</code>
        </li>
      
        <li class="covered" data-hits="652" data-linenumber="57">
          <span class="hits">652</span>
          
          <code class="ruby">      raw_domain</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="51" data-linenumber="59">
          <span class="hits">51</span>
          
          <code class="ruby">      &quot;http://#{raw_domain}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="63">
          <span class="hits">2</span>
          
          <code class="ruby">  def host</code>
        </li>
      
        <li class="covered" data-hits="708" data-linenumber="64">
          <span class="hits">708</span>
          
          <code class="ruby">    if Setting[:single_organisation_mode] == 'true'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">      Setting[:base_domain]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="707" data-linenumber="67">
          <span class="hits">707</span>
          
          <code class="ruby">      [subdomain, Setting[:base_domain]].join('.')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="71">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_eligible_to_vote?(member, proposal)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">    raise NotImplementedError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="75">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_count_for_proposal(proposal)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">    raise NotImplementedError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="79">
          <span class="hits">2</span>
          
          <code class="ruby">  def welcome_email_action</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">    raise NotImplementedError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="83">
          <span class="hits">2</span>
          
          <code class="ruby">  def default_member_class</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">    member_classes.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="87">
          <span class="hits">2</span>
          
          <code class="ruby">  def create_default_member_classes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="90">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_voting_systems</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="93">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_voting_period</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="96">
          <span class="hits">2</span>
          
          <code class="ruby">  def build_constitution_proposal_bundle(attributes={})</code>
        </li>
      
        <li class="covered" data-hits="54" data-linenumber="97">
          <span class="hits">54</span>
          
          <code class="ruby">    ConstitutionProposalBundle.new({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">      :organisation =&gt; self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">    }.merge(attributes))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="102">
          <span class="hits">2</span>
          
          <code class="ruby">  def terms_and_conditions_required?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="103">
          <span class="hits">4</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ea8364bd407b410945ccbe07b1d9c25e81c4cc4e">
  <div class="header">
    <h3>app/models/proposal.rb</h3>
    <h4><span class="green">96.1 %</span> covered</h4>
    <div>
      <b>77</b> relevant lines. 
      <span class="green"><b>74</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/parameters_serialisation'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">class Proposal &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  include OneClickOrgs::ParametersSerialisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :title, :proposer_member_id, :description, :parameters</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  state_machine :initial =&gt; :open do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">    event :close do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">      transition any =&gt; :accepted, :if =&gt; :passed?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">      transition any =&gt; :rejected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">    event :start do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">      transition :draft =&gt; :open</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">    after_transition any =&gt; :accepted, :do =&gt; [:enact!, :create_a_decision]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">    after_transition any =&gt; :rejected, :do =&gt; [:after_reject]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :organisation</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :proposer, :class_name =&gt; 'Member', :foreign_key =&gt; 'proposer_member_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :votes</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">  has_one :decision</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :comments, :as =&gt; :commentable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_presence_of :proposer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="31">
          <span class="hits">192</span>
          
          <code class="ruby">  scope :currently_open, lambda {where([&quot;state = 'open' AND close_date &gt; ?&quot;, Time.now.utc])}</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="32">
          <span class="hits">5</span>
          
          <code class="ruby">  scope :failed, lambda {where([&quot;close_date &lt; ? AND state = 'rejected'&quot;, Time.now.utc]).order('close_date DESC')}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">  scope :draft, with_state(:draft)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="36">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :force_passed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  # FINDERS</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.find_closeable_early_proposals</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="41">
          <span class="hits">27</span>
          
          <code class="ruby">    currently_open.all.select { |p| p.voting_system.can_be_closed_early?(p) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="44">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.close_early_proposals</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">    find_closeable_early_proposals.each { |p| p.close! }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  # CLASS METHODS</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="50">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.close_due_proposals</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="51">
          <span class="hits">15</span>
          
          <code class="ruby">    where([&quot;close_date &lt; ? AND state = 'open'&quot;, Time.now.utc]).all.each { |p| p.close! }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="54">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.close_early_proposals</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="55">
          <span class="hits">27</span>
          
          <code class="ruby">    find_closeable_early_proposals.each { |p| p.close! }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  # Called every 60 seconds in the worker process (set up at end of file)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="59">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.close_proposals</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="60">
          <span class="hits">13</span>
          
          <code class="ruby">    close_due_proposals</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="61">
          <span class="hits">13</span>
          
          <code class="ruby">    close_early_proposals</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  # VOTING PERIOD</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="66">
          <span class="hits">2</span>
          
          <code class="ruby">  def voting_period_in_days</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="67">
          <span class="hits">2</span>
          
          <code class="ruby">    voting_period / 1.day</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="70">
          <span class="hits">2</span>
          
          <code class="ruby">  def voting_period_in_days=(new_voting_period_in_days)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="71">
          <span class="hits">5</span>
          
          <code class="ruby">    self.voting_period = new_voting_period_in_days.to_i.days</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="74">
          <span class="hits">2</span>
          
          <code class="ruby">  def voting_period</code>
        </li>
      
        <li class="covered" data-hits="226" data-linenumber="75">
          <span class="hits">226</span>
          
          <code class="ruby">    @voting_period || organisation.constitution.voting_period</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="78">
          <span class="hits">2</span>
          
          <code class="ruby">  def voting_period=(new_voting_period)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="79">
          <span class="hits">5</span>
          
          <code class="ruby">    @voting_period = new_voting_period.to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  # GETTERS</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="84">
          <span class="hits">2</span>
          
          <code class="ruby">  def end_date</code>
        </li>
      
        <li class="covered" data-hits="48" data-linenumber="85">
          <span class="hits">48</span>
          
          <code class="ruby">    self.close_date</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="88">
          <span class="hits">2</span>
          
          <code class="ruby">  def accepted_or_rejected</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">    accepted? ? &quot;accepted&quot; : &quot;rejected&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="92">
          <span class="hits">2</span>
          
          <code class="ruby">  def closed?</code>
        </li>
      
        <li class="covered" data-hits="37" data-linenumber="93">
          <span class="hits">37</span>
          
          <code class="ruby">    accepted? || rejected?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="96">
          <span class="hits">2</span>
          
          <code class="ruby">  def voting_system</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="97">
          <span class="hits">7</span>
          
          <code class="ruby">    organisation.constitution.voting_system(:general)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="100">
          <span class="hits">2</span>
          
          <code class="ruby">  def passed?</code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="101">
          <span class="hits">80</span>
          
          <code class="ruby">    @force_passed || voting_system.passed?(self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">  # ASSOCIATION HELPERS</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">  # Returns a Vote by the member specified, or Nil</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="107">
          <span class="hits">2</span>
          
          <code class="ruby">  def vote_by(member)</code>
        </li>
      
        <li class="covered" data-hits="64" data-linenumber="108">
          <span class="hits">64</span>
          
          <code class="ruby">    member.votes.where(:proposal_id =&gt; self.id).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="111">
          <span class="hits">2</span>
          
          <code class="ruby">  def votes_for</code>
        </li>
      
        <li class="covered" data-hits="130" data-linenumber="112">
          <span class="hits">130</span>
          
          <code class="ruby">    Vote.where(:proposal_id =&gt; self.id, :for =&gt; true).count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="115">
          <span class="hits">2</span>
          
          <code class="ruby">  def votes_against</code>
        </li>
      
        <li class="covered" data-hits="61" data-linenumber="116">
          <span class="hits">61</span>
          
          <code class="ruby">    Vote.where(:proposal_id =&gt; self.id, :for =&gt; false).count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">  # returns the number of members who are eligible to vote on this proposal</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="120">
          <span class="hits">2</span>
          
          <code class="ruby">  def member_count</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="121">
          <span class="hits">12</span>
          
          <code class="ruby">    organisation.member_count_for_proposal(self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">  # CALCULATIONS</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="126">
          <span class="hits">2</span>
          
          <code class="ruby">  def abstained</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">    member_count - total_votes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="130">
          <span class="hits">2</span>
          
          <code class="ruby">  def total_votes</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="131">
          <span class="hits">7</span>
          
          <code class="ruby">    votes_for + votes_against</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="134">
          <span class="hits">2</span>
          
          <code class="ruby">  def duration</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="135">
          <span class="hits">4</span>
          
          <code class="ruby">    creation_date &amp;&amp; end_date &amp;&amp; (end_date - creation_date)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">  # BEHAVIOUR REDEFINED BY SUBCLASSES</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="140">
          <span class="hits">2</span>
          
          <code class="ruby">  def enact!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="143">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_reject</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">  # Should the proposal automatically create a support vote by the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">  # proposer when the proposal is started?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="148">
          <span class="hits">2</span>
          
          <code class="ruby">  def automatic_proposer_support_vote?</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="149">
          <span class="hits">68</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="152">
          <span class="hits">2</span>
          
          <code class="ruby">  def decision_notification_message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">  # CALLBACKS</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="157">
          <span class="hits">2</span>
          
          <code class="ruby">  after_create :cast_support_vote_by_proposer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="158">
          <span class="hits">2</span>
          
          <code class="ruby">  def cast_support_vote_by_proposer</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="159">
          <span class="hits">385</span>
          
          <code class="ruby">    proposer.cast_vote(:for, self) if automatic_proposer_support_vote?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">  # TIMELINE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="164">
          <span class="hits">2</span>
          
          <code class="ruby">  def to_event</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="165">
          <span class="hits">27</span>
          
          <code class="ruby">    {:timestamp =&gt; self.creation_date, :object =&gt; self, :kind =&gt; (closed? &amp;&amp; !accepted?) ? :failed_proposal : :proposal }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">  # MISCELLANEOUS</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">  # This works around a bug in state_machine which means we cannot specify #create_decision</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby">  # directly in the after_transition callback. If we do, ActiveRecord attempts to use the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">  # Transition object as attributes to the new Decision object, resulting ultimately in an</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">  # &quot;undefined method `stringify_keys'&quot; error on the Transition object.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="174">
          <span class="hits">2</span>
          
          <code class="ruby">  def create_a_decision</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="175">
          <span class="hits">24</span>
          
          <code class="ruby">    create_decision</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="202af0b578da433d84b91405320ea2bfdde6c1d3">
  <div class="header">
    <h3>app/models/resignation.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class Resignation &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible # none</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def to_event</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="7">
          <span class="hits">4</span>
          
          <code class="ruby">    {:object =&gt; self, :timestamp =&gt; created_at, :kind =&gt; :resignation}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3e2c7fb289ca290125c5b6e11e2415168898d114">
  <div class="header">
    <h3>app/models/resolution.rb</h3>
    <h4><span class="green">97.44 %</span> covered</h4>
    <div>
      <b>39</b> relevant lines. 
      <span class="green"><b>38</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/cast_to_boolean'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">class Resolution &lt; Proposal</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  include OneClickOrgs::CastToBoolean</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :draft, :voting_period_in_days, :extraordinary, :certification</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :certification, :attached</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  # DRAFT STATE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def draft=(new_draft)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    # TODO Refactor this and #draft and #draft? to use #cast_to_boolean</code>
        </li>
      
        <li class="covered" data-hits="147" data-linenumber="14">
          <span class="hits">147</span>
          
          <code class="ruby">    if new_draft == 'true'</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="15">
          <span class="hits">3</span>
          
          <code class="ruby">      new_draft = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    elsif new_draft == 'false'</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="17">
          <span class="hits">3</span>
          
          <code class="ruby">      new_draft = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    elsif new_draft.respond_to?(:to_i)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">      if new_draft.to_i == 1</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">        new_draft = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">      elsif new_draft.to_i == 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">        new_draft = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="147" data-linenumber="26">
          <span class="hits">147</span>
          
          <code class="ruby">    @draft = new_draft</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">  def draft</code>
        </li>
      
        <li class="covered" data-hits="175" data-linenumber="30">
          <span class="hits">175</span>
          
          <code class="ruby">    !!@draft</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">  before_create :set_draft_state</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_draft_state</code>
        </li>
      
        <li class="covered" data-hits="163" data-linenumber="35">
          <span class="hits">163</span>
          
          <code class="ruby">    if draft</code>
        </li>
      
        <li class="covered" data-hits="140" data-linenumber="36">
          <span class="hits">140</span>
          
          <code class="ruby">      self.state = 'draft'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  # IMMEDIATE PASSING</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :pass_immediately</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="44">
          <span class="hits">2</span>
          
          <code class="ruby">  def pass_immediately?</code>
        </li>
      
        <li class="covered" data-hits="163" data-linenumber="45">
          <span class="hits">163</span>
          
          <code class="ruby">    cast_to_boolean(@pass_immediately)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="48">
          <span class="hits">2</span>
          
          <code class="ruby">  after_create :pass_immediately_if_requested</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="49">
          <span class="hits">2</span>
          
          <code class="ruby">  def pass_immediately_if_requested</code>
        </li>
      
        <li class="covered" data-hits="163" data-linenumber="50">
          <span class="hits">163</span>
          
          <code class="ruby">    return unless pass_immediately?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="52">
          <span class="hits">5</span>
          
          <code class="ruby">    self.force_passed = true</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="53">
          <span class="hits">5</span>
          
          <code class="ruby">    close!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  # ATTRIBUTES</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="58">
          <span class="hits">2</span>
          
          <code class="ruby">  def extraordinary=(new_extraordinary)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="59">
          <span class="hits">3</span>
          
          <code class="ruby">    @extraordinary = new_extraordinary</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="62">
          <span class="hits">2</span>
          
          <code class="ruby">  def extraordinary</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="63">
          <span class="hits">2</span>
          
          <code class="ruby">    !!@extraordinary</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="66">
          <span class="hits">2</span>
          
          <code class="ruby">  before_create :set_default_title</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="67">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_default_title</code>
        </li>
      
        <li class="covered" data-hits="72" data-linenumber="68">
          <span class="hits">72</span>
          
          <code class="ruby">    if title.blank?</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="69">
          <span class="hits">5</span>
          
          <code class="ruby">      self.title = description.truncate(200)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">  # Resolutions are often created by request on behalf of the membership</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  # (e.g. by the secretary), so the 'proposer' isn't necessarily in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  # favour of the proposal. So for Resolutions, we don't automatically</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  # make the proposer support the proposal.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="77">
          <span class="hits">2</span>
          
          <code class="ruby">  def automatic_proposer_support_vote?</code>
        </li>
      
        <li class="covered" data-hits="163" data-linenumber="78">
          <span class="hits">163</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="81">
          <span class="hits">2</span>
          
          <code class="ruby">  def to_event</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">    {:timestamp =&gt; self.creation_date, :object =&gt; self, :kind =&gt; draft? ? :draft_resolution : :resolution }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="c99af871f7be0856d7250f75b1d322e8431976da">
  <div class="header">
    <h3>app/models/resolution_proposal.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>43</b> relevant lines. 
      <span class="green"><b>43</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># A ResolutionProposal is a proposed resolution. In other words, it is not</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># a resolution itself, but rather it is a suggested resolution.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># It is created when a Member of a Co-op wants to suggest a Resolution.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># The ResolutionProposal is 'passed' if the Directors/Secretary agree</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"># to open the suggested resolution to a vote. At that point, the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"># 'real' Resolution is created.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">class ResolutionProposal &lt; Proposal</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :resolution_class, :resolution_parameters</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :create_draft_resolution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def enact!</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="13">
          <span class="hits">10</span>
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="14">
          <span class="hits">10</span>
          
          <code class="ruby">      klass = resolution_class.constantize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    rescue NoMethodError, NameError</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="16">
          <span class="hits">8</span>
          
          <code class="ruby">      klass = Resolution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="19">
          <span class="hits">10</span>
          
          <code class="ruby">    @resolution = klass.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="21">
          <span class="hits">10</span>
          
          <code class="ruby">    @resolution.organisation = organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="23">
          <span class="hits">10</span>
          
          <code class="ruby">    @resolution.proposer = proposer</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="24">
          <span class="hits">10</span>
          
          <code class="ruby">    @resolution.title = title</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="25">
          <span class="hits">10</span>
          
          <code class="ruby">    @resolution.description = description</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="27">
          <span class="hits">10</span>
          
          <code class="ruby">    if resolution_parameters.present?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">      resolution_parameters.each do |k, v|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="29">
          <span class="hits">4</span>
          
          <code class="ruby">        @resolution.send(&quot;#{k}=&quot;, v)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="33">
          <span class="hits">10</span>
          
          <code class="ruby">    if create_draft_resolution</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">      @resolution.draft = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="37">
          <span class="hits">10</span>
          
          <code class="ruby">    @resolution.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">  def new_resolution</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">    @resolution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="44">
          <span class="hits">2</span>
          
          <code class="ruby">  before_create :set_title</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="45">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_title</code>
        </li>
      
        <li class="covered" data-hits="136" data-linenumber="46">
          <span class="hits">136</span>
          
          <code class="ruby">    return if title.present?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="48">
          <span class="hits">20</span>
          
          <code class="ruby">    if description.present?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="49">
          <span class="hits">2</span>
          
          <code class="ruby">      self.title = description.truncate(200)</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="50">
          <span class="hits">18</span>
          
          <code class="ruby">    elsif resolution_class.present?</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="51">
          <span class="hits">18</span>
          
          <code class="ruby">      self.title = resolution_class.constantize.new(resolution_parameters).set_default_title</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="55">
          <span class="hits">2</span>
          
          <code class="ruby">  def members_to_notify</code>
        </li>
      
        <li class="covered" data-hits="137" data-linenumber="56">
          <span class="hits">137</span>
          
          <code class="ruby">    [organisation.secretary]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="59">
          <span class="hits">2</span>
          
          <code class="ruby">  def notification_email_action</code>
        </li>
      
        <li class="covered" data-hits="137" data-linenumber="60">
          <span class="hits">137</span>
          
          <code class="ruby">    :notify_resolution_proposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="63">
          <span class="hits">2</span>
          
          <code class="ruby">  def to_event</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">    {:timestamp =&gt; self.creation_date, :object =&gt; self, :kind =&gt; :resolution_proposal }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="67">
          <span class="hits">2</span>
          
          <code class="ruby">  def automatic_proposer_support_vote?</code>
        </li>
      
        <li class="covered" data-hits="137" data-linenumber="68">
          <span class="hits">137</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  # Parameters</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="73">
          <span class="hits">2</span>
          
          <code class="ruby">  def resolution_class</code>
        </li>
      
        <li class="covered" data-hits="47" data-linenumber="74">
          <span class="hits">47</span>
          
          <code class="ruby">    parameters['resolution_class']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="77">
          <span class="hits">2</span>
          
          <code class="ruby">  def resolution_class=(new_resolution_class)</code>
        </li>
      
        <li class="covered" data-hits="120" data-linenumber="78">
          <span class="hits">120</span>
          
          <code class="ruby">    parameters['resolution_class'] = new_resolution_class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="81">
          <span class="hits">2</span>
          
          <code class="ruby">  def resolution_parameters</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="82">
          <span class="hits">31</span>
          
          <code class="ruby">    parameters['resolution_parameters'] || {}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="85">
          <span class="hits">2</span>
          
          <code class="ruby">  def resolution_parameters=(new_resolution_parameters)</code>
        </li>
      
        <li class="covered" data-hits="120" data-linenumber="86">
          <span class="hits">120</span>
          
          <code class="ruby">    parameters['resolution_parameters'] = new_resolution_parameters</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="1542485f9799d0325ae0bef7b9cc49192c31d037">
  <div class="header">
    <h3>app/models/seen_notification.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># A SeenNotification is created when a particular member has seen a particular</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># notification, so that we can avoid showing it to them again.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">class SeenNotification &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :notification</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="27d5fa35ff5f92baeca1064f8fcb72ee54a732ba">
  <div class="header">
    <h3>app/models/setting.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines. 
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># Storage for app-wide settings.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># Set a setting like this:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">#   Setting[:base_domain] = &quot;oneclickorgs.com&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"># </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"># Get a setting like this:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"># </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">#   Setting[:base_domain]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">class Setting &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.[](the_key)</code>
        </li>
      
        <li class="covered" data-hits="6771" data-linenumber="14">
          <span class="hits">6771</span>
          
          <code class="ruby">    setting = where(:key =&gt; the_key.to_s).first</code>
        </li>
      
        <li class="covered" data-hits="6771" data-linenumber="15">
          <span class="hits">6771</span>
          
          <code class="ruby">    setting ? setting.value : nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.[]=(the_key, the_value)</code>
        </li>
      
        <li class="covered" data-hits="649" data-linenumber="19">
          <span class="hits">649</span>
          
          <code class="ruby">    setting = where(:key =&gt; the_key.to_s).first || self.new(:key =&gt; the_key.to_s)</code>
        </li>
      
        <li class="covered" data-hits="649" data-linenumber="20">
          <span class="hits">649</span>
          
          <code class="ruby">    setting.value = the_value</code>
        </li>
      
        <li class="covered" data-hits="649" data-linenumber="21">
          <span class="hits">649</span>
          
          <code class="ruby">    setting.save!</code>
        </li>
      
        <li class="covered" data-hits="649" data-linenumber="22">
          <span class="hits">649</span>
          
          <code class="ruby">    setting.value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="2c419031d801af2e81478852b9fd34a04b02330c">
  <div class="header">
    <h3>app/models/share_account.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines. 
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ShareAccount &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :owner, :polymorphic =&gt; true</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :withdrawals, :class_name =&gt; 'ShareTransaction', :foreign_key =&gt; 'from_account_id'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  has_many :deposits, :class_name =&gt; 'ShareTransaction', :foreign_key =&gt; 'to_account_id'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  def balance</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="7">
          <span class="hits">14</span>
          
          <code class="ruby">    self[:balance] || 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b166447a42f920bcd5048516eacfff74ed4bca79">
  <div class="header">
    <h3>app/models/share_application.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>20</b> relevant lines. 
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/model_wrapper'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># Represents a ShareTransaction that transfers shares from</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># the organisation's account to the user's account.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">class ShareApplication &lt; OneClickOrgs::ModelWrapper</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :share_transaction</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_reader :member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  delegate :amount, :amount=, :to =&gt; :share_transaction</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">  def initialize(new_attributes={})</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="12">
          <span class="hits">7</span>
          
          <code class="ruby">    new_attributes = new_attributes.with_indifferent_access</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="14">
          <span class="hits">7</span>
          
          <code class="ruby">    self.share_transaction = new_attributes.delete(:share_transaction) || ShareTransaction.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="16">
          <span class="hits">7</span>
          
          <code class="ruby">    new_attributes.each do |k, v|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">      send(&quot;#{k}=&quot;, v)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">  def member=(new_member)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    @member = new_member</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">    share_transaction.to_account = @member.find_or_build_share_account</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    share_transaction.from_account = @member.organisation.share_account</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">  def save</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">    result = share_transaction.save</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">    raise share_transaction.errors.full_messages.to_sentence unless result</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">    result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">  def persisted?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="34">
          <span class="hits">4</span>
          
          <code class="ruby">    share_transaction &amp;&amp; share_transaction.persisted?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="71895e87cc5a8bdfdcb05a56dfa1ae7c9ba1fb77">
  <div class="header">
    <h3>app/models/share_transaction.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>16</b> relevant lines. 
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ShareTransaction &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :from_account, :to_account, :amount</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  state_machine :initial =&gt; :pending do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">    event :approve do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">      transition :pending =&gt; :approved</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">    after_transition :pending =&gt; :approved, :do =&gt; :adjust_accounts</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">    store_audit_trail</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :from_account, :class_name =&gt; 'ShareAccount'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :to_account, :class_name =&gt; 'ShareAccount'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">  validates_presence_of :from_account, :to_account, :amount</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">  def adjust_accounts</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    transaction do</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">      # TODO Use SQL to adjust column value directly, rather than a read + write.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">      from_account.update_attribute(:balance, from_account.balance - amount)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">      to_account.update_attribute(:balance, to_account.balance + amount)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">      from_account.save!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">      to_account.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="fe7ef68a6095c76a82ed95c9a2033cee4069ac67">
  <div class="header">
    <h3>app/models/share_transaction_state_transition.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ShareTransactionStateTransition &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :share_transaction</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :share_transaction_id, :created_at, :event, :from, :to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="44975eb994d9e3ae9e16f7060038a418b257720c">
  <div class="header">
    <h3>app/models/task.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>15</b> relevant lines. 
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class Task &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :subject, :action, :starts_on</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :subject, :polymorphic =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  scope :current, lambda {</code>
        </li>
      
        <li class="covered" data-hits="86" data-linenumber="7">
          <span class="hits">86</span>
          
          <code class="ruby">    where([&quot;(starts_on IS NULL OR starts_on &lt;= :today) AND completed_at IS NULL&quot;, {:today =&gt; Date.today}])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  scope :shares_related, where(:subject_type =&gt; ['ShareTransaction'])</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  scope :directors_related, where(:subject_type =&gt; ['Election'])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def to_partial_name</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="13">
          <span class="hits">4</span>
          
          <code class="ruby">    partial_name  = &quot;task_&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="14">
          <span class="hits">4</span>
          
          <code class="ruby">    partial_name += subject.class.name.underscore</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="15">
          <span class="hits">4</span>
          
          <code class="ruby">    if action.present?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="16">
          <span class="hits">3</span>
          
          <code class="ruby">      partial_name += &quot;_#{action.to_s}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="18">
          <span class="hits">4</span>
          
          <code class="ruby">    partial_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">  def complete!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    update_attribute(:completed_at, Time.now.utc)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b57a2900cc046f27aa6eec375477bb802cce4d5c">
  <div class="header">
    <h3>app/models/vote.rb</h3>
    <h4><span class="yellow">90.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines. 
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class Vote &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessible :member, :proposal, :for</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :member</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  belongs_to :proposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  def for_or_against</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="8">
          <span class="hits">22</span>
          
          <code class="ruby">    Vote.for_or_against(self.for?)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.for_or_against(foa)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="12">
          <span class="hits">22</span>
          
          <code class="ruby">    foa ? &quot;Support&quot; : &quot;Oppose&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">  def to_event</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    {:timestamp =&gt; self.created_at, :object =&gt; self, :kind =&gt; :vote }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="79688c9a248e85248f34e010b0d1223991d600de">
  <div class="header">
    <h3>app/models/voting_periods.rb</h3>
    <h4><span class="red">76.19 %</span> covered</h4>
    <div>
      <b>21</b> relevant lines. 
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module VotingPeriods</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  PERIODS = [300, 86400, 259200, 604800, 1209600] # in seconds</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.name_for_value(value)</code>
        </li>
      
        <li class="covered" data-hits="211" data-linenumber="5">
          <span class="hits">211</span>
          
          <code class="ruby">    value = value.to_i</code>
        </li>
      
        <li class="covered" data-hits="211" data-linenumber="6">
          <span class="hits">211</span>
          
          <code class="ruby">    case value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    when 0..3600</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="8">
          <span class="hits">28</span>
          
          <code class="ruby">      minutes = (value / 60.0).round</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="9">
          <span class="hits">28</span>
          
          <code class="ruby">      if minutes == 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">        &quot;1 minute&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="12">
          <span class="hits">28</span>
          
          <code class="ruby">        &quot;#{minutes} minutes&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="183" data-linenumber="14">
          <span class="hits">183</span>
          
          <code class="ruby">    when 3601..(86400-1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">      hours = (value / 3600.0).round</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">      if hours == 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">        &quot;1 hour&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">        &quot;#{hours} hours&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="183" data-linenumber="22">
          <span class="hits">183</span>
          
          <code class="ruby">      days = (value / (3600.0 * 24)).round</code>
        </li>
      
        <li class="covered" data-hits="183" data-linenumber="23">
          <span class="hits">183</span>
          
          <code class="ruby">      if days == 1</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="24">
          <span class="hits">26</span>
          
          <code class="ruby">        &quot;1 day&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="157" data-linenumber="26">
          <span class="hits">157</span>
          
          <code class="ruby">        &quot;#{days} days&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.all(&amp;block)</code>
        </li>
      
        <li class="covered" data-hits="156" data-linenumber="32">
          <span class="hits">156</span>
          
          <code class="ruby">    PERIODS.map{|p| {:name =&gt; name_for_value(p), :value =&gt; p}}.tap do |periods|</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="33">
          <span class="hits">26</span>
          
          <code class="ruby">      periods.each(&amp;block) if block</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    end      </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="605cbc14105a55d352643216f5378db5f7764afc">
  <div class="header">
    <h3>app/models/voting_systems.rb</h3>
    <h4><span class="yellow">87.96 %</span> covered</h4>
    <div>
      <b>108</b> relevant lines. 
      <span class="green"><b>95</b> lines covered</span> and
      <span class="red"><b>13</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module VotingSystems  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.get(klass)</code>
        </li>
      
        <li class="covered" data-hits="1112" data-linenumber="4">
          <span class="hits">1112</span>
          
          <code class="ruby">    raise ArgumentError, &quot;empty argument&quot; if klass.nil?    </code>
        </li>
      
        <li class="covered" data-hits="1111" data-linenumber="5">
          <span class="hits">1111</span>
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="covered" data-hits="1111" data-linenumber="6">
          <span class="hits">1111</span>
          
          <code class="ruby">      const_get(klass.to_s) </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    rescue NameError</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">      nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  # TODO Not all voting systems are applicable to all organisation types. The organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  # should have a way of specifying which voting systems it allows. (For example, an Association</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  # should not have the option to choose AbsoluteThreeQuartersMajority.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">  class VotingSystem</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.simple_name</code>
        </li>
      
        <li class="covered" data-hits="892" data-linenumber="19">
          <span class="hits">892</span>
          
          <code class="ruby">      self.name.split('::').last</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.description(options={})</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">      raise &quot;description must be defined in subclasses of VotingSystem&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.long_description(options={})</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">      raise &quot;long_description must be defined in subclasses of VotingSystem&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.can_be_closed_early?(proposal)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">      false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.passed?(proposal)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">      raise NotImplementedError      </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">  class RelativeMajority &lt; VotingSystem</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.description(options={})</code>
        </li>
      
        <li class="covered" data-hits="79" data-linenumber="42">
          <span class="hits">79</span>
          
          <code class="ruby">      &quot;Simple majority: decisions need more supporting votes than opposing votes&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="45">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.long_description(options={})</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="46">
          <span class="hits">28</span>
          
          <code class="ruby">      are_received = options[:include_received] ? &quot; are received&quot; : &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="47">
          <span class="hits">28</span>
          
          <code class="ruby">      &quot;Supporting Votes from more than half of the Members#{are_received} during the Voting Period; or when more Supporting Votes than Opposing Votes have been received for the Proposal at the end of the Voting Period.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="50">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.can_be_closed_early?(proposal)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="51">
          <span class="hits">9</span>
          
          <code class="ruby">      [proposal.votes_for, proposal.votes_against].max &gt; (proposal.member_count  / 2.0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="54">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.passed?(proposal)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="55">
          <span class="hits">9</span>
          
          <code class="ruby">      proposal.votes_for &gt; proposal.votes_against      </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="59">
          <span class="hits">2</span>
          
          <code class="ruby">  class RelativeThreeQuartersMajority &lt; VotingSystem</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="60">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.description(options={})</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">      &quot;Three-quarters majority of votes: decisions need more than three-quarters of the votes to be in support&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="64">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.long_description(options={})</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">      are_received = options[:include_received] ? &quot; are received&quot; : &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">      &quot;Supporting Votes from more than three-quarters of the Members#{are_received} during the Voting Period; or when more than three-quarters of the votes received for the Proposal at the end of the Voting Period are Supporting Votes.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="69">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.can_be_closed_early?(proposal)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="70">
          <span class="hits">2</span>
          
          <code class="ruby">      (proposal.votes_for &gt; (proposal.member_count * 0.75)) ||</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="71">
          <span class="hits">3</span>
          
          <code class="ruby">      (proposal.votes_against &gt;= (proposal.member_count * 0.25))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="74">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.passed?(proposal)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="75">
          <span class="hits">4</span>
          
          <code class="ruby">      proposal.votes_for &gt; (3 * proposal.votes_against)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="79">
          <span class="hits">2</span>
          
          <code class="ruby">  class Veto &lt; VotingSystem</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="80">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.description(options={})</code>
        </li>
      
        <li class="covered" data-hits="79" data-linenumber="81">
          <span class="hits">79</span>
          
          <code class="ruby">      &quot;Nobody opposes: decisions blocked if there are any opposing votes&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="84">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.long_description(options={})</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="85">
          <span class="hits">27</span>
          
          <code class="ruby">      are_received = options[:include_received] ? &quot; are received&quot; : &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="86">
          <span class="hits">27</span>
          
          <code class="ruby">      &quot;no Opposing Votes#{are_received} during the Voting Period.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="89">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.can_be_closed_early?(proposal)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="90">
          <span class="hits">6</span>
          
          <code class="ruby">      (proposal.votes_against &gt; 0 ) ||</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="91">
          <span class="hits">10</span>
          
          <code class="ruby">      (proposal.votes_for == proposal.member_count)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="94">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.passed?(proposal)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="95">
          <span class="hits">3</span>
          
          <code class="ruby">      proposal.votes_for &gt; 0 &amp;&amp; proposal.votes_against == 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">  # Base class for voting systems where a proposal needs to surpass a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">  # treshold of votes (in relation to member count) to be accepted.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="102">
          <span class="hits">2</span>
          
          <code class="ruby">  class Majority &lt; VotingSystem</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="103">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.fraction_needed=(f)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="104">
          <span class="hits">6</span>
          
          <code class="ruby">      @fraction_needed = f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="107">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.can_be_closed_early?(proposal)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="108">
          <span class="hits">9</span>
          
          <code class="ruby">      (current_fraction_for(proposal) &gt; @fraction_needed) || </code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="109">
          <span class="hits">13</span>
          
          <code class="ruby">      (current_fraction_against(proposal) &gt;= (1.0 - @fraction_needed)) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="112">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.passed?(proposal)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="113">
          <span class="hits">12</span>
          
          <code class="ruby">      current_fraction_for(proposal) &gt; @fraction_needed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="116">
          <span class="hits">2</span>
          
          <code class="ruby">    private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="118">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.current_fraction_for(proposal)</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="119">
          <span class="hits">21</span>
          
          <code class="ruby">      proposal.votes_for / proposal.member_count.to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="122">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.current_fraction_against(proposal)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="123">
          <span class="hits">4</span>
          
          <code class="ruby">      proposal.votes_against / proposal.member_count.to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="128">
          <span class="hits">2</span>
          
          <code class="ruby">  class AbsoluteMajority &lt; Majority</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="129">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.description(options={})</code>
        </li>
      
        <li class="covered" data-hits="79" data-linenumber="130">
          <span class="hits">79</span>
          
          <code class="ruby">      &quot;Absolute majority: decisions need supporting votes from more than 50% of members&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="133">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.long_description(options={})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="134">
          <span class="hits">1</span>
          
          <code class="ruby">      are_received = options[:include_received] ? &quot; are received&quot; : &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="135">
          <span class="hits">1</span>
          
          <code class="ruby">      &quot;Supporting Votes#{are_received} from more than half of Members during the Voting Period.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="138">
          <span class="hits">2</span>
          
          <code class="ruby">    self.fraction_needed = 0.5</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="141">
          <span class="hits">2</span>
          
          <code class="ruby">  class AbsoluteTwoThirdsMajority &lt; Majority</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="142">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.description(options={})</code>
        </li>
      
        <li class="covered" data-hits="78" data-linenumber="143">
          <span class="hits">78</span>
          
          <code class="ruby">      &quot;Two thirds majority: decisions need supporting votes from more than 66% of members&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="146">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.long_description(options={})</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="147">
          <span class="hits">27</span>
          
          <code class="ruby">      are_received = options[:include_received] ? &quot; are received&quot; : &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="148">
          <span class="hits">27</span>
          
          <code class="ruby">      &quot;Supporting Votes#{are_received} from more than two thirds of Members during the Voting Period.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="151">
          <span class="hits">2</span>
          
          <code class="ruby">    self.fraction_needed = 2.0/3.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="154">
          <span class="hits">2</span>
          
          <code class="ruby">  class AbsoluteThreeQuartersMajority &lt; Majority</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="155">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.description(options={})</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="156">
          
          
          <code class="ruby">      &quot;Three quarters majority: decisions need supporting votes from more than 75% of members&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="159">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.long_description(options={})</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="160">
          
          
          <code class="ruby">      are_received = options[:include_received] ? &quot; are received&quot; : &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">      &quot;Supporting Votes#{are_received} from more than three quarters of Members during the Voting Period.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="164">
          <span class="hits">2</span>
          
          <code class="ruby">    self.fraction_needed = 3.0/4.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="167">
          <span class="hits">2</span>
          
          <code class="ruby">  class Unanimous &lt; VotingSystem</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="168">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.description(options={})</code>
        </li>
      
        <li class="covered" data-hits="79" data-linenumber="169">
          <span class="hits">79</span>
          
          <code class="ruby">      &quot;Unanimous: decisions need supporting votes from 100% of members&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="172">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.long_description(options={})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="173">
          <span class="hits">1</span>
          
          <code class="ruby">      are_received = options[:include_received] ? &quot; are received&quot; : &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="174">
          <span class="hits">1</span>
          
          <code class="ruby">      &quot;Supporting Votes#{are_received} from all Members during the Voting Period.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="177">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.can_be_closed_early?(proposal)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="178">
          <span class="hits">3</span>
          
          <code class="ruby">      (proposal.votes_against &gt; 0 ) ||</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="179">
          <span class="hits">5</span>
          
          <code class="ruby">      (proposal.votes_for == proposal.member_count)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="182">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.passed?(proposal)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="183">
          <span class="hits">3</span>
          
          <code class="ruby">      proposal.votes_for == proposal.member_count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="187">
          <span class="hits">2</span>
          
          <code class="ruby">  class Founding &lt; VotingSystem</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="188">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.description(options={})</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="189">
          
          
          <code class="ruby">      &quot;At least three supporting votes&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="192">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.long_description(options={})</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="193">
          
          
          <code class="ruby">      are_received = options[:include_received] ? &quot; are received&quot; : &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="194">
          
          
          <code class="ruby">      &quot;at least three votes#{are_received} during the Voting Period.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="197">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.can_be_closed_early?(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">      #We need to give all the founding members an opportunity to vote,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby">      # so only close this proposal early if every member has cast a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">      # vote.</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="201">
          <span class="hits">10</span>
          
          <code class="ruby">      proposal.total_votes &gt;= proposal.member_count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="204">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.passed?(proposal)</code>
        </li>
      
        <li class="covered" data-hits="63" data-linenumber="205">
          <span class="hits">63</span>
          
          <code class="ruby">      proposal.votes_for &gt;= 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="209">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.all(&amp;block)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">    [</code>
        </li>
      
        <li class="covered" data-hits="79" data-linenumber="211">
          <span class="hits">79</span>
          
          <code class="ruby">      RelativeMajority,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">      AbsoluteMajority,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby">      AbsoluteTwoThirdsMajority,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">      Unanimous,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby">      Veto</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">    ].tap do |systems|</code>
        </li>
      
        <li class="covered" data-hits="79" data-linenumber="217">
          <span class="hits">79</span>
          
          <code class="ruby">      systems.each(&amp;block) if block</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="218">
          
          
          <code class="ruby">    end      </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby"></code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="328334ea1a791a705cbcd14298e8833dcef444c3">
  <div class="header">
    <h3>app/observers/decision_mailer_observer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>12</b> relevant lines. 
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class DecisionMailerObserver &lt; ActiveRecord::Observer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  observe :decision</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_create(decision)</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="5">
          <span class="hits">31</span>
          
          <code class="ruby">    send_notification_email(decision)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  def send_notification_email(decision)</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="11">
          <span class="hits">31</span>
          
          <code class="ruby">    case decision.proposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    when FoundAssociationProposal</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="13">
          <span class="hits">6</span>
          
          <code class="ruby">      decision.organisation.members.each do |m|</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="14">
          <span class="hits">26</span>
          
          <code class="ruby">        DecisionMailer.notify_foundation_decision(m, decision).deliver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="17">
          <span class="hits">25</span>
          
          <code class="ruby">      decision.organisation.members.active.each do |m|</code>
        </li>
      
        <li class="covered" data-hits="56" data-linenumber="18">
          <span class="hits">56</span>
          
          <code class="ruby">        DecisionMailer.notify_new_decision(m, decision).deliver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    Rails.logger.error(&quot;Error sending decision email: #{e.inspect}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a8b598d561d5d61d4f28ebe1aa8131d175970301">
  <div class="header">
    <h3>app/observers/directorship_mailer_observer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines. 
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class DirectorshipMailerObserver &lt; ActiveRecord::Observer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  observe :directorship</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_create(directorship)</code>
        </li>
      
        <li class="covered" data-hits="145" data-linenumber="5">
          <span class="hits">145</span>
          
          <code class="ruby">    welcome_new_director(directorship)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  def welcome_new_director(directorship)</code>
        </li>
      
        <li class="covered" data-hits="145" data-linenumber="11">
          <span class="hits">145</span>
          
          <code class="ruby">    return unless directorship.organisation &amp;&amp; directorship.director</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="13">
          <span class="hits">144</span>
          
          <code class="ruby">    DirectorshipMailer.welcome_new_director(directorship).deliver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a261310663efeb14d0d92533a239f03434bf3934">
  <div class="header">
    <h3>app/observers/election_task_observer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ElectionTaskObserver &lt; ActiveRecord::Observer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  observe :election</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_transition(election, transition)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="5">
          <span class="hits">10</span>
          
          <code class="ruby">    case transition.event</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    when :close</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="7">
          <span class="hits">7</span>
          
          <code class="ruby">      add_close_tasks_for_members(election)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">  def add_close_tasks_for_members(election)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="14">
          <span class="hits">7</span>
          
          <code class="ruby">    members = election.try(:organisation).try(:members)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="15">
          <span class="hits">7</span>
          
          <code class="ruby">    return unless members.present?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">    members.each do |member|</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="17">
          <span class="hits">13</span>
          
          <code class="ruby">      member.tasks.create(:subject =&gt; election, :action =&gt; :view_result)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="9fbf96e2ae8758ff0b87b38c9b28ba1849b0a55f">
  <div class="header">
    <h3>app/observers/general_meeting_task_observer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>17</b> relevant lines. 
      <span class="green"><b>17</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class GeneralMeetingTaskObserver &lt; ActiveRecord::Observer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  observe :general_meeting,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    :annual_general_meeting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_create(general_meeting)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="6">
          <span class="hits">17</span>
          
          <code class="ruby">    add_minute_task_for_secretary(general_meeting)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_save(general_meeting)</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="10">
          <span class="hits">20</span>
          
          <code class="ruby">    if general_meeting.minutes.present?</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="11">
          <span class="hits">12</span>
          
          <code class="ruby">      complete_minute_task_for_secretary(general_meeting)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  def add_minute_task_for_secretary(general_meeting)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="18">
          <span class="hits">17</span>
          
          <code class="ruby">    secretary = general_meeting.organisation.try(:secretary)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="19">
          <span class="hits">17</span>
          
          <code class="ruby">    return unless secretary</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="21">
          <span class="hits">8</span>
          
          <code class="ruby">    secretary.tasks.create(:subject =&gt; general_meeting, :action =&gt; :minute, :starts_on =&gt; general_meeting.happened_on)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">  def complete_minute_task_for_secretary(general_meeting)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="25">
          <span class="hits">12</span>
          
          <code class="ruby">    secretary = general_meeting.organisation.try(:secretary)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="26">
          <span class="hits">12</span>
          
          <code class="ruby">    return unless secretary</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">    secretary.tasks.current.where(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">      :subject_type =&gt; 'Meeting',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">      :subject_id =&gt; general_meeting.id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">      :action =&gt; 'minute'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    ).each do |task|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">      task.complete!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="2afd8c7903abdee2c11e8cce5c822881bae1811b">
  <div class="header">
    <h3>app/observers/meeting_mailer_observer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>9</b> relevant lines. 
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class MeetingMailerObserver &lt; ActiveRecord::Observer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  observe :meeting, :general_meeting, :annual_general_meeting, :board_meeting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_create(meeting)</code>
        </li>
      
        <li class="covered" data-hits="40" data-linenumber="5">
          <span class="hits">40</span>
          
          <code class="ruby">    send_creation_notification_emails(meeting)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  def send_creation_notification_emails(meeting)</code>
        </li>
      
        <li class="covered" data-hits="40" data-linenumber="11">
          <span class="hits">40</span>
          
          <code class="ruby">    if meeting.creation_notification_email_action &amp;&amp; meeting.members_to_notify</code>
        </li>
      
        <li class="covered" data-hits="40" data-linenumber="12">
          <span class="hits">40</span>
          
          <code class="ruby">      meeting.members_to_notify.each do |member|</code>
        </li>
      
        <li class="covered" data-hits="37" data-linenumber="13">
          <span class="hits">37</span>
          
          <code class="ruby">        MeetingMailer.send(meeting.creation_notification_email_action, member, meeting).deliver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="4064f75d4f7abe1a6139f7071cc2293e91a40094">
  <div class="header">
    <h3>app/observers/member_mailer_observer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines. 
      <span class="green"><b>24</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class MemberMailerObserver &lt; ActiveRecord::Observer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  observe :member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_create(member)</code>
        </li>
      
        <li class="covered" data-hits="755" data-linenumber="5">
          <span class="hits">755</span>
          
          <code class="ruby">    case member.organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    when Coop</code>
        </li>
      
        <li class="covered" data-hits="264" data-linenumber="7">
          <span class="hits">264</span>
          
          <code class="ruby">      if member.organisation.active?</code>
        </li>
      
        <li class="covered" data-hits="245" data-linenumber="8">
          <span class="hits">245</span>
          
          <code class="ruby">        send_new_member_notification(member) if member.pending?</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="9">
          <span class="hits">19</span>
          
          <code class="ruby">      elsif member.organisation.pending?</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="10">
          <span class="hits">18</span>
          
          <code class="ruby">        send_welcome_if_requested(member)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="491" data-linenumber="13">
          <span class="hits">491</span>
          
          <code class="ruby">      send_welcome_if_requested(member)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_transition(member, transition)</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="18">
          <span class="hits">26</span>
          
          <code class="ruby">    case transition.event</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    when :induct</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="20">
          <span class="hits">6</span>
          
          <code class="ruby">      case member.organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">      when Coop</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="22">
          <span class="hits">3</span>
          
          <code class="ruby">        if member.organisation.active?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">          send_welcome_if_requested(member)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    when :reactivate</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">      send_welcome_if_requested(member)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    when :resign</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="29">
          <span class="hits">5</span>
          
          <code class="ruby">      member.organisation.members.active.each do |recipient|</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="30">
          <span class="hits">14</span>
          
          <code class="ruby">        MembersMailer.notify_resignation(recipient, member).deliver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">  def send_welcome_if_requested(member)</code>
        </li>
      
        <li class="covered" data-hits="511" data-linenumber="36">
          <span class="hits">511</span>
          
          <code class="ruby">    if member.send_welcome</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="37">
          <span class="hits">16</span>
          
          <code class="ruby">      MembersMailer.send(member.organisation.welcome_email_action, member).deliver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">  def send_new_member_notification(member)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="42">
          <span class="hits">3</span>
          
          <code class="ruby">    secretary = member.organisation.try(:secretary)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="43">
          <span class="hits">3</span>
          
          <code class="ruby">    return unless secretary</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="45">
          <span class="hits">3</span>
          
          <code class="ruby">    MembersMailer.send(:notify_new_member, secretary, member).deliver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="11cdc05308926606c1fad4cdb3ac5b3f45a6021d">
  <div class="header">
    <h3>app/observers/member_observer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class MemberObserver &lt; ActiveRecord::Observer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_transition(member, transition)</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="3">
          <span class="hits">28</span>
          
          <code class="ruby">    case transition.event</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    when :resign</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="5">
          <span class="hits">5</span>
          
          <code class="ruby">      member.resignations.create!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="90e98617508904462d45f275df26e28170dbaad1">
  <div class="header">
    <h3>app/observers/member_task_observer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class MemberTaskObserver &lt; ActiveRecord::Observer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  observe :member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_create(member)</code>
        </li>
      
        <li class="covered" data-hits="755" data-linenumber="5">
          <span class="hits">755</span>
          
          <code class="ruby">    case member.organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    when Coop</code>
        </li>
      
        <li class="covered" data-hits="264" data-linenumber="7">
          <span class="hits">264</span>
          
          <code class="ruby">      if member.pending?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="8">
          <span class="hits">6</span>
          
          <code class="ruby">        add_task_for_secretary(member)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">  def add_task_for_secretary(member)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="16">
          <span class="hits">6</span>
          
          <code class="ruby">    secretary = member.organisation.try(:secretary)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="17">
          <span class="hits">6</span>
          
          <code class="ruby">    return unless secretary</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="19">
          <span class="hits">3</span>
          
          <code class="ruby">    secretary.tasks.create(:subject =&gt; member, :action =&gt; :process_application)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5b120c01670226375c468183160bf718af9a35c9">
  <div class="header">
    <h3>app/observers/member_timestamp_observer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines. 
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class MemberTimestampObserver &lt; ActiveRecord::Observer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  observe :member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def before_save(member)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    # Timestamp terms acceptance</code>
        </li>
      
        <li class="covered" data-hits="1172" data-linenumber="6">
          <span class="hits">1172</span>
          
          <code class="ruby">    if member.terms_and_conditions &amp;&amp; member.terms_and_conditions != 0 &amp;&amp; member.terms_and_conditions != '0'</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="7">
          <span class="hits">30</span>
          
          <code class="ruby">      member.terms_accepted_at ||= Time.now.utc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_transition(member, transition)</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="12">
          <span class="hits">26</span>
          
          <code class="ruby">    case transition.event</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    when :induct</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="14">
          <span class="hits">6</span>
          
          <code class="ruby">      member.update_attribute(:inducted_at, Time.now.utc)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="76fb71a7f709c978926d7e9ac0cfc1cfc29daafc">
  <div class="header">
    <h3>app/observers/officership_mailer_observer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines. 
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class OfficershipMailerObserver &lt; ActiveRecord::Observer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  observe :officership</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_create(officership)</code>
        </li>
      
        <li class="covered" data-hits="63" data-linenumber="5">
          <span class="hits">63</span>
          
          <code class="ruby">    welcome_new_officer(officership)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  def welcome_new_officer(officership)</code>
        </li>
      
        <li class="covered" data-hits="63" data-linenumber="11">
          <span class="hits">63</span>
          
          <code class="ruby">    return unless officership.officer &amp;&amp; officership.office</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="13">
          <span class="hits">10</span>
          
          <code class="ruby">    OfficershipMailer.welcome_new_officer(officership).deliver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="bfab5ae5e26ee67b8e8000378570955c71f46002">
  <div class="header">
    <h3>app/observers/proposal_mailer_observer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ProposalMailerObserver &lt; ActiveRecord::Observer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">  # Rails (in development mode, at least) doesn't pre-load all the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  # model classes. In order to register this observer for all proposals,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  # we must explicitly observe each proposal sub-class.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  # TODO: Yuck. Is there a better way?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  observe :proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    :add_member_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    :change_boolean_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    :change_member_class_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    :change_text_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    :change_voting_period_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    :change_voting_system_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    :constitution_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    :eject_member_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    :found_association_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    :membership_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    :resolution,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    :board_resolution,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    :resolution_proposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_create(proposal)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="22">
          <span class="hits">385</span>
          
          <code class="ruby">    send_notification_email(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  # TODO If rejected, send a notification email</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  # def after_transition(proposal, transition)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  # end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">  def send_notification_email(proposal)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="30">
          <span class="hits">385</span>
          
          <code class="ruby">    notification_email_action = if proposal.respond_to?(:notification_email_action)</code>
        </li>
      
        <li class="covered" data-hits="154" data-linenumber="31">
          <span class="hits">154</span>
          
          <code class="ruby">      proposal.notification_email_action</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="231" data-linenumber="33">
          <span class="hits">231</span>
          
          <code class="ruby">      :notify_creation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="36">
          <span class="hits">385</span>
          
          <code class="ruby">    members_to_notify = if proposal.respond_to?(:members_to_notify)</code>
        </li>
      
        <li class="covered" data-hits="154" data-linenumber="37">
          <span class="hits">154</span>
          
          <code class="ruby">      proposal.members_to_notify</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="231" data-linenumber="39">
          <span class="hits">231</span>
          
          <code class="ruby">      proposal.organisation.members.active</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="42">
          <span class="hits">385</span>
          
          <code class="ruby">    members_to_notify = members_to_notify.delete_if(&amp;:blank?)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="44">
          <span class="hits">385</span>
          
          <code class="ruby">    members_to_notify.each do |m|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">      # only notify members who can vote</code>
        </li>
      
        <li class="covered" data-hits="438" data-linenumber="46">
          <span class="hits">438</span>
          
          <code class="ruby">      ProposalMailer.send(notification_email_action, m, proposal).deliver if m.has_permission(:vote)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a8e23e28f63d6f53d7067a65a80efad73599f12d">
  <div class="header">
    <h3>app/observers/proposal_timestamp_observer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>21</b> relevant lines. 
      <span class="green"><b>21</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ProposalTimestampObserver &lt; ActiveRecord::Observer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">  # Rails (in development mode, at least) doesn't pre-load all the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  # model classes. In order to register this observer for all proposals,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  # we must explicitly observe each proposal sub-class.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  # TODO: Yuck. Is there a better way?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  observe :proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    :add_member_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    :change_boolean_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    :change_member_class_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    :change_text_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    :change_voting_period_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    :change_voting_system_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    :constitution_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    :eject_member_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    :found_association_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    :membership_proposal,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    :resolution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">  def before_create(proposal)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="20">
          <span class="hits">385</span>
          
          <code class="ruby">    set_creation_date(proposal)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="21">
          <span class="hits">385</span>
          
          <code class="ruby">    set_close_date(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">  def before_transition(proposal, transition)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="25">
          <span class="hits">22</span>
          
          <code class="ruby">    case transition.event</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    when :close</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="27">
          <span class="hits">19</span>
          
          <code class="ruby">      set_close_date_to_now(proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_transition(proposal, transition)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="32">
          <span class="hits">22</span>
          
          <code class="ruby">    case transition.event</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    when :start</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="34">
          <span class="hits">3</span>
          
          <code class="ruby">      set_close_date(proposal, true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_creation_date(proposal)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="41">
          <span class="hits">385</span>
          
          <code class="ruby">    proposal.creation_date ||= Time.now.utc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="44">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_close_date(proposal, save=false)</code>
        </li>
      
        <li class="covered" data-hits="388" data-linenumber="45">
          <span class="hits">388</span>
          
          <code class="ruby">    unless proposal.state == 'draft'</code>
        </li>
      
        <li class="covered" data-hits="243" data-linenumber="46">
          <span class="hits">243</span>
          
          <code class="ruby">      proposal.close_date ||= Time.now.utc + proposal.voting_period</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="388" data-linenumber="48">
          <span class="hits">388</span>
          
          <code class="ruby">    proposal.save if save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="51">
          <span class="hits">2</span>
          
          <code class="ruby">  def set_close_date_to_now(proposal)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="52">
          <span class="hits">19</span>
          
          <code class="ruby">    proposal.close_date = Time.now.utc</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="53">
          <span class="hits">19</span>
          
          <code class="ruby">    proposal.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="1db64a0f1e9e9ab8938e92fc873b811504162be5">
  <div class="header">
    <h3>app/observers/resolution_proposal_task_observer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>9</b> relevant lines. 
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ResolutionProposalTaskObserver &lt; ActiveRecord::Observer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  observe :resolution_proposal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_create(resolution_proposal)</code>
        </li>
      
        <li class="covered" data-hits="136" data-linenumber="5">
          <span class="hits">136</span>
          
          <code class="ruby">    add_task_for_secretary(resolution_proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">  def add_task_for_secretary(resolution_proposal)</code>
        </li>
      
        <li class="covered" data-hits="136" data-linenumber="11">
          <span class="hits">136</span>
          
          <code class="ruby">    secretary = resolution_proposal.organisation.try(:secretary)  </code>
        </li>
      
        <li class="covered" data-hits="136" data-linenumber="12">
          <span class="hits">136</span>
          
          <code class="ruby">    return unless secretary</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="14">
          <span class="hits">20</span>
          
          <code class="ruby">    secretary.tasks.create(:subject =&gt; resolution_proposal)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="6f70b4c1cff2ce4caa61f8368f6d30d1ea1332ae">
  <div class="header">
    <h3>app/observers/share_transaction_mailer_observer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines. 
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ShareTransactionMailerObserver &lt; ActiveRecord::Observer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  observe :share_transaction</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_create(share_transaction)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="5">
          <span class="hits">8</span>
          
          <code class="ruby">    if share_transaction.from_account.owner.is_a?(Coop) &amp;&amp; share_transaction.to_account.owner.is_a?(Member)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="6">
          <span class="hits">6</span>
          
          <code class="ruby">      notify_share_application(share_transaction)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def notify_share_application(share_transaction)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="13">
          <span class="hits">6</span>
          
          <code class="ruby">    secretary = share_transaction.from_account.owner.secretary</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="14">
          <span class="hits">6</span>
          
          <code class="ruby">    return unless secretary</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="16">
          <span class="hits">4</span>
          
          <code class="ruby">    ShareTransactionMailer.notify_share_application(secretary, share_transaction).deliver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="2c43fa12e970ea2ab29b5624d4c286361d86370b">
  <div class="header">
    <h3>app/observers/share_transaction_task_observer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>16</b> relevant lines. 
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class ShareTransactionTaskObserver &lt; ActiveRecord::Observer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  observe :share_transaction</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def after_create(share_transaction)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="5">
          <span class="hits">8</span>
          
          <code class="ruby">    if share_transaction.from_account.owner.is_a?(Coop) &amp;&amp; share_transaction.to_account.owner.is_a?(Member)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="6">
          <span class="hits">6</span>
          
          <code class="ruby">      create_tasks_for_share_application(share_transaction)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">  def create_tasks_for_share_application(share_transaction)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="13">
          <span class="hits">6</span>
          
          <code class="ruby">    create_member_task_for_share_application(share_transaction)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="14">
          <span class="hits">6</span>
          
          <code class="ruby">    create_secretary_task_for_share_application(share_transaction)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  def create_member_task_for_share_application(share_transaction)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="18">
          <span class="hits">6</span>
          
          <code class="ruby">    member = share_transaction.to_account.owner</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="19">
          <span class="hits">6</span>
          
          <code class="ruby">    member.tasks.create(:subject =&gt; share_transaction, :action =&gt; :make_payment)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">  def create_secretary_task_for_share_application(share_transaction)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="23">
          <span class="hits">6</span>
          
          <code class="ruby">    secretary = share_transaction.from_account.owner.secretary</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="24">
          <span class="hits">6</span>
          
          <code class="ruby">    return unless secretary</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="26">
          <span class="hits">4</span>
          
          <code class="ruby">    secretary.tasks.create(:subject =&gt; share_transaction, :action =&gt; :mark_payment_received)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3d8dde1e98522ddb5add2d33ea9c7ed74031449f">
  <div class="header">
    <h3>app/presenters/member_presenter.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines. 
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class MemberPresenter</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def initialize(member)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="3">
          <span class="hits">7</span>
          
          <code class="ruby">    self.member = member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  def timeline</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    @timeline ||= [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">      @member,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">      @member.proposals.all,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">      @member.votes.all</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="13">
          <span class="hits">5</span>
          
          <code class="ruby">    ].flatten.map(&amp;:to_event).compact.sort{|a, b| b[:timestamp] &lt;=&gt; a[:timestamp]}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b452f5735b32a8274e87e172b9c174d75baae8d3">
  <div class="header">
    <h3>lib/not_found.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class NotFound &lt; RuntimeError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3a7c0d05c445a2e0babccfe6132042fe001f6c29">
  <div class="header">
    <h3>lib/one_click_orgs.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/setup'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/version'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/google_analytics'</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b97905543397a548143b22b8e678914e668cd3ea">
  <div class="header">
    <h3>lib/one_click_orgs/cast_to_boolean.rb</h3>
    <h4><span class="yellow">85.71 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module OneClickOrgs</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  module CastToBoolean</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    # Attempts to turn strings like 'true', 'false', '1', '0' into</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    # an actual boolean value.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">    def cast_to_boolean(value)</code>
        </li>
      
        <li class="covered" data-hits="200" data-linenumber="9">
          <span class="hits">200</span>
          
          <code class="ruby">      if value == 'true'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">        true</code>
        </li>
      
        <li class="covered" data-hits="200" data-linenumber="11">
          <span class="hits">200</span>
          
          <code class="ruby">      elsif value == 'false'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">        false</code>
        </li>
      
        <li class="covered" data-hits="200" data-linenumber="13">
          <span class="hits">200</span>
          
          <code class="ruby">      elsif value.respond_to?(:to_i)</code>
        </li>
      
        <li class="covered" data-hits="198" data-linenumber="14">
          <span class="hits">198</span>
          
          <code class="ruby">        if value.to_i == 1</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="15">
          <span class="hits">29</span>
          
          <code class="ruby">          true</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="16">
          <span class="hits">169</span>
          
          <code class="ruby">        elsif value.to_i == 0</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="17">
          <span class="hits">169</span>
          
          <code class="ruby">          false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">        !!value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a77afa1d0de53f7f5e51c1433004d440c14a005f">
  <div class="header">
    <h3>lib/one_click_orgs/google_analytics.rb</h3>
    <h4><span class="yellow">83.33 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module OneClickOrgs</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  class GoogleAnalytics</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">    cattr_accessor :id</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">    cattr_accessor :domain</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.active?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">      id &amp;&amp; domain</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="686c2574405a69b86f1582327d81bc498ae2f5f2">
  <div class="header">
    <h3>lib/one_click_orgs/invitation_code.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>20</b> relevant lines. 
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'digest/sha1'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">require 'active_support/concern'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">module OneClickOrgs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # Handles the invitation code for a new user</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  module InvitationCode</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">    extend ActiveSupport::Concern</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">    included do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">      before_create :new_invitation_code</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">      validates_uniqueness_of :invitation_code, :scope =&gt; :organisation_id, :allow_nil =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">      if respond_to?(:state_machines)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">        state_machines[:state].after_transition :on =&gt; :reactivate, :do =&gt; :new_invitation_code!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">    def new_invitation_code</code>
        </li>
      
        <li class="covered" data-hits="756" data-linenumber="21">
          <span class="hits">756</span>
          
          <code class="ruby">      self.invitation_code = self.class.generate_invitation_code</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">    def new_invitation_code!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">      new_invitation_code</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">      save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">    def clear_invitation_code!</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="30">
          <span class="hits">9</span>
          
          <code class="ruby">      self.update_attribute(:invitation_code, nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">    module ClassMethods</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">      def generate_invitation_code</code>
        </li>
      
        <li class="covered" data-hits="756" data-linenumber="35">
          <span class="hits">756</span>
          
          <code class="ruby">        Digest::SHA1.hexdigest(&quot;#{Time.now}#{rand}&quot;)[0..9]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="afaac4829e98fc9be925ff74913fb1af5e77da7e">
  <div class="header">
    <h3>lib/one_click_orgs/mail_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>9</b> relevant lines. 
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'mail/elements/address'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">module OneClickOrgs</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  module MailHelper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    # Construct a well-formed 'name-address' from a display name and an address.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    # name_addr('Bob Smith', 'bob@example.com') # =&gt; &quot;Bob Smith &lt;bob@example.com&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">    def name_addr(display_name, address)</code>
        </li>
      
        <li class="covered" data-hits="659" data-linenumber="9">
          <span class="hits">659</span>
          
          <code class="ruby">      a = Mail::Address.new</code>
        </li>
      
        <li class="covered" data-hits="659" data-linenumber="10">
          <span class="hits">659</span>
          
          <code class="ruby">      a.display_name = display_name</code>
        </li>
      
        <li class="covered" data-hits="659" data-linenumber="11">
          <span class="hits">659</span>
          
          <code class="ruby">      a.address = address</code>
        </li>
      
        <li class="covered" data-hits="659" data-linenumber="12">
          <span class="hits">659</span>
          
          <code class="ruby">      a.format</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">    module_function :name_addr</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b16d109f2838158263bd479841613d391460c540">
  <div class="header">
    <h3>lib/one_click_orgs/model_wrapper.rb</h3>
    <h4><span class="yellow">88.24 %</span> covered</h4>
    <div>
      <b>34</b> relevant lines. 
      <span class="green"><b>30</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'active_record/errors'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">module OneClickOrgs</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  class ModelWrapper</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">    extend ActiveModel::Naming</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">    include ActiveModel::Validations</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">    include ActiveModel::Conversion</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">    extend ActiveModel::Conversion::ClassMethods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">    def initialize(attributes={})</code>
        </li>
      
        <li class="covered" data-hits="93" data-linenumber="11">
          <span class="hits">93</span>
          
          <code class="ruby">      self.attributes = attributes</code>
        </li>
      
        <li class="covered" data-hits="93" data-linenumber="12">
          <span class="hits">93</span>
          
          <code class="ruby">      @errors = ActiveModel::Errors.new(self)</code>
        </li>
      
        <li class="covered" data-hits="93" data-linenumber="13">
          <span class="hits">93</span>
          
          <code class="ruby">      self.after_initialize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    # To implement custom behaviour after an instance is initialized,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    # redefine this method in your subclass.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">    def after_initialize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">    attr_reader :errors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">    def id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">      @id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">    def persisted?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">      raise NotImplementedError, &quot;#persisted? must be implemented by subclass&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">    def attributes=(attributes)</code>
        </li>
      
        <li class="covered" data-hits="102" data-linenumber="32">
          <span class="hits">102</span>
          
          <code class="ruby">      attributes.each_pair do |key, value|</code>
        </li>
      
        <li class="covered" data-hits="527" data-linenumber="33">
          <span class="hits">527</span>
          
          <code class="ruby">        send(&quot;#{key}=&quot;, value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="37">
          <span class="hits">2</span>
          
          <code class="ruby">    def update_attributes(attributes)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="38">
          <span class="hits">9</span>
          
          <code class="ruby">      self.attributes = attributes</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="39">
          <span class="hits">9</span>
          
          <code class="ruby">      save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>
          
          <code class="ruby">    def save</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">      raise NotImplementedError, '#save must be implemented by subclass'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="46">
          <span class="hits">2</span>
          
          <code class="ruby">    def save!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">      save || raise(RecordNotSaved)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="50">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.find_by_id(id)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">      raise NotImplementedError, '.find_by_id must be implemented by subclass'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="54">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.find(id)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="55">
          <span class="hits">9</span>
          
          <code class="ruby">      model_wrapper = find_by_id(id)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="56">
          <span class="hits">9</span>
          
          <code class="ruby">      raise ActiveRecord::RecordNotFound unless model_wrapper</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="57">
          <span class="hits">9</span>
          
          <code class="ruby">      model_wrapper</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="60">
          <span class="hits">2</span>
          
          <code class="ruby">    class RecordNotSaved &lt; ActiveRecord::RecordNotSaved</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3ff41dc6f4ee4aee74c8adf1bb90c0c5f4af2534">
  <div class="header">
    <h3>lib/one_click_orgs/notification_consumer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module OneClickOrgs</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  module NotificationConsumer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">    extend ActiveSupport::Concern</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">    included do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">      has_many :seen_notifications</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    # Check if this notification has been shown to user already.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    # @param [Symbol] notification the kind of notification</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    # @param [optional, Timestamp] ignore_earlier_than If you pass this timestamp, we only consider the period</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    # after the timestamp when checking to see if the member has already seen this notification.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">    def has_seen_notification?(notification, ignore_earlier_than = nil)</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="15">
          <span class="hits">36</span>
          
          <code class="ruby">      if ignore_earlier_than</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="16">
          <span class="hits">9</span>
          
          <code class="ruby">        seen_notifications.exists?([&quot;notification = ? AND updated_at &gt;= ?&quot;, notification, ignore_earlier_than])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="18">
          <span class="hits">27</span>
          
          <code class="ruby">        seen_notifications.exists?(:notification =&gt; notification)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">    def has_seen_notification!(notification)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="23">
          <span class="hits">14</span>
          
          <code class="ruby">      seen_notification = seen_notifications.find_by_notification(notification)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="24">
          <span class="hits">14</span>
          
          <code class="ruby">      if seen_notification</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">        seen_notification.touch</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="27">
          <span class="hits">12</span>
          
          <code class="ruby">        seen_notifications.create(:notification =&gt; notification)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="c4073c6e3880697914dae5b9e8a97babd2cd6a1b">
  <div class="header">
    <h3>lib/one_click_orgs/organisation_resolver.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>13</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'action_view/template/resolver'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">module OneClickOrgs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  # OrganisationResolver is a custom template resolver that provides for</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  # customisation of an entire template based on the kind of organisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # we are dealing with.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  # The resolver looks for customised templates in a subdirectory named after </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  # the name of the class you specify at initialisation time. If a customised</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  # template cannot be found, it falls back to using the default template.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  # For instance, if you create a new OrganisationResolver like this:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  #   OrganisationResolver.new(Rails.root + '/app/views', Company)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  # and prepend the new resolver to your view paths, then an attempt to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  # render the +index+ action of the +people+ controller will try the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  # follwing templates in order until it finds one that exists:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  # * &lt;tt&gt;app/views/people/company/index&lt;/tt&gt;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  # * &lt;tt&gt;app/views/people/index&lt;/tt&gt;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">  class OrganisationResolver &lt; ActionView::FileSystemResolver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    # +path+ is a root template path on the file system</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    # (e.g. &lt;tt&gt;Rails.root + '/app/views'&lt;/tt&gt;).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    # +organisation_class+ is the Class for which you want to search for</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    # customised templates.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">    def initialize(path, organisation_class)</code>
        </li>
      
        <li class="covered" data-hits="1231" data-linenumber="29">
          <span class="hits">1231</span>
          
          <code class="ruby">      super(path)</code>
        </li>
      
        <li class="covered" data-hits="1231" data-linenumber="30">
          <span class="hits">1231</span>
          
          <code class="ruby">      @organisation_class_name = organisation_class.name.underscore</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">    def find_templates(name, prefix, partial, details)</code>
        </li>
      
        <li class="covered" data-hits="5591" data-linenumber="36">
          <span class="hits">5591</span>
          
          <code class="ruby">      prefix_expansions = [&quot;#{prefix}/#{@organisation_class_name}&quot;, prefix]</code>
        </li>
      
        <li class="covered" data-hits="5591" data-linenumber="37">
          <span class="hits">5591</span>
          
          <code class="ruby">      templates = []</code>
        </li>
      
        <li class="covered" data-hits="5591" data-linenumber="38">
          <span class="hits">5591</span>
          
          <code class="ruby">      prefix_expansions.each do |expanded_prefix|</code>
        </li>
      
        <li class="covered" data-hits="11182" data-linenumber="39">
          <span class="hits">11182</span>
          
          <code class="ruby">        templates += super(name, expanded_prefix, partial, details)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="5591" data-linenumber="41">
          <span class="hits">5591</span>
          
          <code class="ruby">      templates</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="926e1bc4e464c1e7dca3d57ba7ee9ec4b8121a51">
  <div class="header">
    <h3>lib/one_click_orgs/parameters_hash.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>7</b> relevant lines. 
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># A light wrapper around Hash that can retain a reference to a parent object.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># The reference is used to update the actual parameters attribute of the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># parent when the parameters hash is naively updated by calling #[]= on</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># it.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">class ParametersHash &lt; Hash</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">  attr_accessor :parent</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  # Returns a new ParametersHash with the contents of the given hash.</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.from_hash(hash)</code>
        </li>
      
        <li class="covered" data-hits="2622" data-linenumber="10">
          <span class="hits">2622</span>
          
          <code class="ruby">    hash ? new.replace(hash) : new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">  def []=(key, value)</code>
        </li>
      
        <li class="covered" data-hits="688" data-linenumber="14">
          <span class="hits">688</span>
          
          <code class="ruby">    parent.parameters = parent.parameters.merge({key =&gt; value})</code>
        </li>
      
        <li class="covered" data-hits="688" data-linenumber="15">
          <span class="hits">688</span>
          
          <code class="ruby">    super</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="43e52f43982f20223d18afddd5ae7084df164428">
  <div class="header">
    <h3>lib/one_click_orgs/parameters_serialisation.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines. 
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'one_click_orgs/parameters_hash'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">module OneClickOrgs</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  module ParametersSerialisation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    # Returns the (deserialized) hash of parameters for this object.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    # You can call #[]= on the returned hash and it will magically update the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    # actual parameters attribute of the object. In other words, this will</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    # just work:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    # proposal.parameters[:first_name] = &quot;Bob&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    # proposal.parameters[:first_name] # =&gt; &quot;Bob&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">    def parameters</code>
        </li>
      
        <li class="covered" data-hits="2622" data-linenumber="13">
          <span class="hits">2622</span>
          
          <code class="ruby">      ParametersHash.from_hash(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">        self[:parameters].blank? ? {} : ActiveSupport::JSON.decode(self[:parameters])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">      ).tap do |hash|</code>
        </li>
      
        <li class="covered" data-hits="2622" data-linenumber="16">
          <span class="hits">2622</span>
          
          <code class="ruby">        hash.parent = self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">    def parameters=(new_parameters)</code>
        </li>
      
        <li class="covered" data-hits="708" data-linenumber="21">
          <span class="hits">708</span>
          
          <code class="ruby">      self[:parameters] = new_parameters.blank? ? {} : new_parameters.to_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="af1a08a941e2571b6064905aeea5a1e9f5863c50">
  <div class="header">
    <h3>lib/one_click_orgs/setup.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module OneClickOrgs</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  class Setup</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">    def self.complete?</code>
        </li>
      
        <li class="covered" data-hits="1011" data-linenumber="4">
          <span class="hits">1011</span>
          
          <code class="ruby">      (Setting[:base_domain].present? &amp;&amp; Setting[:signup_domain].present?) || Setting[:single_organisation_mode] == 'true'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="561888fb907b820a806e03a171074bdb19a11c96">
  <div class="header">
    <h3>lib/one_click_orgs/user_authentication.rb</h3>
    <h4><span class="green">93.55 %</span> covered</h4>
    <div>
      <b>31</b> relevant lines. 
      <span class="green"><b>29</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">require 'digest/sha1'</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">require 'active_support/concern'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">module OneClickOrgs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # Handles authentication for a user object, including password resets</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">  module UserAuthentication</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">    extend ActiveSupport::Concern</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">    included do</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="11">
          <span class="hits">4</span>
          
          <code class="ruby">      before_save :encrypt_password</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="13">
          <span class="hits">4</span>
          
          <code class="ruby">      validates_confirmation_of :password</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">      # TODO: how can we validate :password? (not actually saved, but accepted during input)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">    attr_accessor :password, :password_confirmation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">    def authenticated?(password)</code>
        </li>
      
        <li class="covered" data-hits="195" data-linenumber="21">
          <span class="hits">195</span>
          
          <code class="ruby">      crypted_password == encrypt(password)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">    def encrypt(password)</code>
        </li>
      
        <li class="covered" data-hits="1046" data-linenumber="25">
          <span class="hits">1046</span>
          
          <code class="ruby">      self.class.encrypt(password, salt)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">    def encrypt_password</code>
        </li>
      
        <li class="covered" data-hits="1174" data-linenumber="29">
          <span class="hits">1174</span>
          
          <code class="ruby">      return if password.blank?</code>
        </li>
      
        <li class="covered" data-hits="851" data-linenumber="30">
          <span class="hits">851</span>
          
          <code class="ruby">      self.salt = Digest::SHA1.hexdigest(&quot;--#{Time.now.to_s}--:email--&quot;)</code>
        </li>
      
        <li class="covered" data-hits="851" data-linenumber="31">
          <span class="hits">851</span>
          
          <code class="ruby">      self.crypted_password = encrypt(password)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">    def password_required?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">      crypted_password.blank? || !password.blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">    # PASSWORD RESET CODE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">    def new_password_reset_code!</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">      self.password_reset_code = self.class.generate_password_reset_code</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="44">
          <span class="hits">2</span>
          
          <code class="ruby">    def clear_password_reset_code!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">      self.update_attribute(:password_reset_code, nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="48">
          <span class="hits">2</span>
          
          <code class="ruby">    module ClassMethods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">      # Encrypts some data with the salt</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="50">
          <span class="hits">2</span>
          
          <code class="ruby">      def encrypt(password, salt)</code>
        </li>
      
        <li class="covered" data-hits="1046" data-linenumber="51">
          <span class="hits">1046</span>
          
          <code class="ruby">        Digest::SHA1.hexdigest(&quot;--#{salt}--#{password}--&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="54">
          <span class="hits">2</span>
          
          <code class="ruby">      def authenticate(login, password)</code>
        </li>
      
        <li class="covered" data-hits="196" data-linenumber="55">
          <span class="hits">196</span>
          
          <code class="ruby">        member = where(:email =&gt; login).first</code>
        </li>
      
        <li class="covered" data-hits="196" data-linenumber="56">
          <span class="hits">196</span>
          
          <code class="ruby">        member &amp;&amp; member.authenticated?(password) ? member : nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">      # PASSWORD RESET CODE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="61">
          <span class="hits">2</span>
          
          <code class="ruby">      def generate_password_reset_code</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="62">
          <span class="hits">2</span>
          
          <code class="ruby">        Digest::SHA1.hexdigest(&quot;#{Time.now}#{rand}&quot;)[0..9]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="2d92779846064d5ad2c40a44de49f863a360830f">
  <div class="header">
    <h3>lib/one_click_orgs/version.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines. 
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">module OneClickOrgs</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  VERSION = &quot;2.0.0alpha1&quot; unless defined?(::OneClickOrgs::VERSION)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.version</code>
        </li>
      
        <li class="covered" data-hits="1032" data-linenumber="5">
          <span class="hits">1032</span>
          
          <code class="ruby">    VERSION</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">  def self.prerelease?</code>
        </li>
      
        <li class="covered" data-hits="501" data-linenumber="9">
          <span class="hits">501</span>
          
          <code class="ruby">    !!version.match(/alpha/) || !!version.match(/beta/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="69313dfe05a67036876829536dd5e8c245c46d04">
  <div class="header">
    <h3>lib/periodic_proposal_closer.rb</h3>
    <h4><span class="red">50.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class PeriodicProposalCloser</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2">
          <span class="hits">2</span>
          
          <code class="ruby">  def perform</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3">
          
          
          <code class="ruby">    Proposal.close_proposals</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4">
          
          
          <code class="ruby">    Delayed::Job.enqueue(PeriodicProposalCloser.new, :priority =&gt; 0, :run_at =&gt; 60.seconds.from_now)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f2d7dc0c00c19275defd621499f80fc6d28a4577">
  <div class="header">
    <h3>lib/unauthenticated.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>2</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class Unauthenticated &lt; RuntimeError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">class UnauthenticatedAdministrator &lt; RuntimeError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="00781b5f9f4b2683cd023fdadc14d92f35311ec3">
  <div class="header">
    <h3>lib/vote_error.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="2" data-linenumber="1">
          <span class="hits">2</span>
          
          <code class="ruby">class VoteError &lt; RuntimeError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
      </div>
    </div>
  </body>
</html>
